[2025-06-20 22:08:43,937] INFO authentication register_user:48 - === User Registration ===
[2025-06-20 22:08:43,937] INFO authentication register_user:49 - Request data: {'username': 'new8', 'email': 'new8@gmail.com', 'first_name': 'new', 'last_name': 'new', 'password': 'new8@1234', 'password_confirm': 'new8@1234'}
[2025-06-20 22:08:44,386] INFO authentication register_user:54 - User registered successfully: new8 (ID: 9)
[2025-06-20 22:08:45,642] INFO authentication webauthn_register_begin:114 - === WebAuthn Registration Begin ===
[2025-06-20 22:08:45,642] INFO authentication webauthn_register_begin:115 - Request data: {'username': 'new8', 'display_name': 'new new'}
[2025-06-20 22:08:45,643] INFO authentication webauthn_register_begin:125 - Processing registration for user: new8, display_name: new new
[2025-06-20 22:08:45,649] INFO authentication webauthn_register_begin:131 - User found: new8 (ID: 9)
[2025-06-20 22:08:45,649] INFO authentication webauthn_register_begin:139 - Generating registration options...
[2025-06-20 22:08:45,649] INFO authentication webauthn_register_begin:140 - RP Name: Secure Dashboard
[2025-06-20 22:08:45,649] INFO authentication webauthn_register_begin:141 - RP ID: localhost
[2025-06-20 22:08:45,650] INFO authentication webauthn_register_begin:142 - User ID (bytes): b'new8'
[2025-06-20 22:08:45,650] INFO authentication webauthn_register_begin:155 - Registration options generated successfully
[2025-06-20 22:08:45,650] INFO authentication webauthn_register_begin:156 - Challenge (base64): QV3cRE194ABR9UpfkzJq2orgQc5BYSuIEu8gH7GBGMMm8yb7fgws+J1Ma4m7TZkVokexeZUQk6z+dfXlWe4auQ==
[2025-06-20 22:08:45,651] INFO authentication webauthn_register_begin:157 - Challenge length: 64 bytes
[2025-06-20 22:08:45,651] INFO authentication webauthn_register_begin:167 - Challenge stored with ID: 7d64ad75-5b9e-458d-b0ab-3e90dd127d95
[2025-06-20 22:08:45,651] INFO authentication webauthn_register_begin:168 - Total challenges in memory: 1
[2025-06-20 22:08:45,652] INFO authentication webauthn_register_begin:205 - Registration options converted to dictionary
[2025-06-20 22:08:45,652] INFO authentication webauthn_register_begin:206 - Options dict keys: ['challenge', 'rp', 'user', 'pubKeyCredParams', 'timeout', 'excludeCredentials', 'authenticatorSelection', 'attestation']
[2025-06-20 22:08:45,652] INFO authentication webauthn_register_begin:207 - User ID in options: bmV3OA==
[2025-06-20 22:08:45,652] INFO authentication webauthn_register_begin:208 - Challenge in options: QV3cRE194ABR9UpfkzJq2orgQc5BYSuIEu8gH7GBGMMm8yb7fgws+J1Ma4m7TZkVokexeZUQk6z+dfXlWe4auQ==
[2025-06-20 22:08:45,654] INFO authentication webauthn_register_begin:215 - === WebAuthn Registration Begin Complete ===
[2025-06-20 22:08:45,654] INFO authentication webauthn_register_begin:216 - Response data: {'options': {'challenge': 'QV3cRE194ABR9UpfkzJq2orgQc5BYSuIEu8gH7GBGMMm8yb7fgws+J1Ma4m7TZkVokexeZUQk6z+dfXlWe4auQ==', 'rp': {'name': 'Secure Dashboard', 'id': 'localhost'}, 'user': {'id': 'bmV3OA==', 'name': 'new8', 'displayName': 'new new'}, 'pubKeyCredParams': [{'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_256: -7>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.EDDSA: -8>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_512: -36>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_256: -37>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_384: -38>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_512: -39>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_256: -257>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_384: -258>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_512: -259>}], 'timeout': 60000, 'excludeCredentials': [], 'authenticatorSelection': {'authenticatorAttachment': None, 'requireResidentKey': False, 'residentKey': None, 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>}, 'attestation': <AttestationConveyancePreference.NONE: 'none'>}, 'challenge_id': '7d64ad75-5b9e-458d-b0ab-3e90dd127d95'}
[2025-06-20 22:09:22,393] INFO authentication webauthn_register_complete:237 - === WebAuthn Registration Complete ===
[2025-06-20 22:09:22,395] INFO authentication webauthn_register_complete:238 - Request data: {'username': 'new8', 'challenge_id': '7d64ad75-5b9e-458d-b0ab-3e90dd127d95', 'credential_id': '17mdZeM+cD6fqGBAJy8VRA==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAENe5nWXjPnA+n6hgQCcvFUSlAQIDJiABIVgg+HFIdXsfJ6EMo96hkoKLH1GTBMm6LVW+y1GwZ99kZb8iWCC02InvXljrkQ102J33FNyxEAm99egBX0pSBPexxisCpQ==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoiUVYzY1JFMTk0QUJSOVVwZmt6SnEyb3JnUWM1QllTdUlFdThnSDdHQkdNTW04eWI3Zmd3cy1KMU1hNG03VFprVm9rZXhlWlVRazZ6LWRmWGxXZTRhdVEiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'transports': [], 'backup_eligible': True, 'backup_state': False}
[2025-06-20 22:09:22,396] INFO authentication webauthn_register_complete:245 - Serializer validated successfully
[2025-06-20 22:09:22,396] INFO authentication webauthn_register_complete:246 - Validated data: {'username': 'new8', 'credential_id': '17mdZeM+cD6fqGBAJy8VRA==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAENe5nWXjPnA+n6hgQCcvFUSlAQIDJiABIVgg+HFIdXsfJ6EMo96hkoKLH1GTBMm6LVW+y1GwZ99kZb8iWCC02InvXljrkQ102J33FNyxEAm99egBX0pSBPexxisCpQ==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoiUVYzY1JFMTk0QUJSOVVwZmt6SnEyb3JnUWM1QllTdUlFdThnSDdHQkdNTW04eWI3Zmd3cy1KMU1hNG03VFprVm9rZXhlWlVRazZ6LWRmWGxXZTRhdVEiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'transports': [], 'backup_eligible': True, 'backup_state': False}
[2025-06-20 22:09:22,396] INFO authentication webauthn_register_complete:249 - Challenge ID from request: 7d64ad75-5b9e-458d-b0ab-3e90dd127d95
[2025-06-20 22:09:22,396] INFO authentication webauthn_register_complete:260 - Retrieved stored challenge data:
[2025-06-20 22:09:22,397] INFO authentication webauthn_register_complete:261 -   - Challenge: QV3cRE194ABR9UpfkzJq2orgQc5BYSuIEu8gH7GBGMMm8yb7fgws+J1Ma4m7TZkVokexeZUQk6z+dfXlWe4auQ==
[2025-06-20 22:09:22,397] INFO authentication webauthn_register_complete:262 -   - Username: new8
[2025-06-20 22:09:22,397] INFO authentication webauthn_register_complete:263 -   - Type: registration
[2025-06-20 22:09:22,407] INFO authentication webauthn_register_complete:267 - User found: new8 (ID: 9)
[2025-06-20 22:09:22,408] INFO authentication webauthn_register_complete:273 - Starting verification for user: new8
[2025-06-20 22:09:22,408] INFO authentication webauthn_register_complete:274 - Challenge: QV3cRE194ABR9UpfkzJq2orgQc5BYSuIEu8gH7GBGMMm8yb7fgws+J1Ma4m7TZkVokexeZUQk6z+dfXlWe4auQ==
[2025-06-20 22:09:22,410] INFO authentication webauthn_register_complete:275 - RP ID: localhost
[2025-06-20 22:09:22,411] INFO authentication webauthn_register_complete:276 - Origin: http://localhost:5173
[2025-06-20 22:09:22,415] INFO authentication webauthn_register_complete:279 - Original credential_id: 17mdZeM+cD6fqGBAJy8VRA==
[2025-06-20 22:09:22,416] INFO authentication webauthn_register_complete:280 - Credential_id length: 24
[2025-06-20 22:09:22,422] INFO authentication webauthn_register_complete:289 - Decoded raw_id length: 16 bytes
[2025-06-20 22:09:22,423] INFO authentication webauthn_register_complete:290 - Raw_id (hex): d7b99d65e33e703e9fa86040272f1544
[2025-06-20 22:09:22,427] INFO authentication webauthn_register_complete:295 - Attestation object length: 178 bytes
[2025-06-20 22:09:22,428] INFO authentication webauthn_register_complete:296 - Client data JSON length: 180 bytes
[2025-06-20 22:09:22,429] INFO authentication webauthn_register_complete:297 - Client data JSON content: {"type":"webauthn.create","challenge":"QV3cRE194ABR9UpfkzJq2orgQc5BYSuIEu8gH7GBGMMm8yb7fgws-J1Ma4m7TZkVokexeZUQk6z-dfXlWe4auQ","origin":"http://localhost:5173","crossOrigin":false}
[2025-06-20 22:09:22,430] INFO authentication webauthn_register_complete:303 - AuthenticatorAttestationResponse created successfully
[2025-06-20 22:09:22,430] INFO authentication webauthn_register_complete:311 - RegistrationCredential created successfully
[2025-06-20 22:09:22,431] INFO authentication webauthn_register_complete:312 - Credential ID: 17mdZeM+cD6fqGBAJy8VRA==
[2025-06-20 22:09:22,431] INFO authentication webauthn_register_complete:313 - Credential raw_id length: 16 bytes
[2025-06-20 22:09:22,431] INFO authentication webauthn_register_complete:314 - Credential type: public-key
[2025-06-20 22:09:22,438] INFO authentication webauthn_register_complete:316 - Starting verification with webauthn library...
[2025-06-20 22:09:22,440] ERROR authentication webauthn_register_complete:363 - Registration verification failed: id and raw_id were not equivalent
[2025-06-20 22:09:22,443] ERROR authentication webauthn_register_complete:364 - Exception type: InvalidRegistrationResponse
[2025-06-20 22:09:22,450] ERROR authentication webauthn_register_complete:365 - Traceback: Traceback (most recent call last):
  File "C:\Users\fazi\Desktop\machine task\secure-dashboard\backend\authentication\views.py", line 317, in webauthn_register_complete
    verification = verify_registration_response(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fazi\Desktop\machine task\secure-dashboard\backend\venv\Lib\site-packages\webauthn\registration\verify_registration_response.py", line 111, in verify_registration_response
    raise InvalidRegistrationResponse("id and raw_id were not equivalent")
webauthn.helpers.exceptions.InvalidRegistrationResponse: id and raw_id were not equivalent

[2025-06-20 22:10:37,806] INFO authentication webauthn_register_begin:114 - === WebAuthn Registration Begin ===
[2025-06-20 22:10:37,806] INFO authentication webauthn_register_begin:115 - Request data: {'username': 'new8', 'display_name': 'new new'}
[2025-06-20 22:10:37,806] INFO authentication webauthn_register_begin:125 - Processing registration for user: new8, display_name: new new
[2025-06-20 22:10:37,811] INFO authentication webauthn_register_begin:131 - User found: new8 (ID: 9)
[2025-06-20 22:10:37,811] INFO authentication webauthn_register_begin:139 - Generating registration options...
[2025-06-20 22:10:37,812] INFO authentication webauthn_register_begin:140 - RP Name: Secure Dashboard
[2025-06-20 22:10:37,812] INFO authentication webauthn_register_begin:141 - RP ID: localhost
[2025-06-20 22:10:37,812] INFO authentication webauthn_register_begin:142 - User ID (bytes): b'new8'
[2025-06-20 22:10:37,812] INFO authentication webauthn_register_begin:155 - Registration options generated successfully
[2025-06-20 22:10:37,814] INFO authentication webauthn_register_begin:156 - Challenge (base64): Dhk9zmMzHMSQ6ZC/H3Lu2/4VJ6wg5nUsgkKqlwIZCuiZsKiYpSRszaEUkj/0sO1b7bpMU6fL5UatOhA+gq0RFQ==
[2025-06-20 22:10:37,814] INFO authentication webauthn_register_begin:157 - Challenge length: 64 bytes
[2025-06-20 22:10:37,814] INFO authentication webauthn_register_begin:167 - Challenge stored with ID: e280b6c5-06a2-4c4b-b87d-72e79b1e111b
[2025-06-20 22:10:37,814] INFO authentication webauthn_register_begin:168 - Total challenges in memory: 2
[2025-06-20 22:10:37,814] INFO authentication webauthn_register_begin:205 - Registration options converted to dictionary
[2025-06-20 22:10:37,815] INFO authentication webauthn_register_begin:206 - Options dict keys: ['challenge', 'rp', 'user', 'pubKeyCredParams', 'timeout', 'excludeCredentials', 'authenticatorSelection', 'attestation']
[2025-06-20 22:10:37,815] INFO authentication webauthn_register_begin:207 - User ID in options: bmV3OA==
[2025-06-20 22:10:37,815] INFO authentication webauthn_register_begin:208 - Challenge in options: Dhk9zmMzHMSQ6ZC/H3Lu2/4VJ6wg5nUsgkKqlwIZCuiZsKiYpSRszaEUkj/0sO1b7bpMU6fL5UatOhA+gq0RFQ==
[2025-06-20 22:10:37,816] INFO authentication webauthn_register_begin:215 - === WebAuthn Registration Begin Complete ===
[2025-06-20 22:10:37,816] INFO authentication webauthn_register_begin:216 - Response data: {'options': {'challenge': 'Dhk9zmMzHMSQ6ZC/H3Lu2/4VJ6wg5nUsgkKqlwIZCuiZsKiYpSRszaEUkj/0sO1b7bpMU6fL5UatOhA+gq0RFQ==', 'rp': {'name': 'Secure Dashboard', 'id': 'localhost'}, 'user': {'id': 'bmV3OA==', 'name': 'new8', 'displayName': 'new new'}, 'pubKeyCredParams': [{'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_256: -7>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.EDDSA: -8>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_512: -36>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_256: -37>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_384: -38>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_512: -39>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_256: -257>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_384: -258>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_512: -259>}], 'timeout': 60000, 'excludeCredentials': [], 'authenticatorSelection': {'authenticatorAttachment': None, 'requireResidentKey': False, 'residentKey': None, 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>}, 'attestation': <AttestationConveyancePreference.NONE: 'none'>}, 'challenge_id': 'e280b6c5-06a2-4c4b-b87d-72e79b1e111b'}
[2025-06-20 22:11:54,774] INFO authentication webauthn_register_complete:237 - === WebAuthn Registration Complete ===
[2025-06-20 22:11:54,774] INFO authentication webauthn_register_complete:238 - Request data: {'username': 'new8', 'challenge_id': 'e280b6c5-06a2-4c4b-b87d-72e79b1e111b', 'credential_id': 'wa3Hrq8hLVD+fn4zDiHNjQ==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEMGtx66vIS1Q/n5+Mw4hzY2lAQIDJiABIVggsq6SNHAF2CBQvHaKQe0dF3CwIMX48zLs39eZIJuaovciWCBGszC3kAUs1rShLgysvga22+3xvZyvQFO6iYn8nNSm1w==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoiRGhrOXptTXpITVNRNlpDX0gzTHUyXzRWSjZ3ZzVuVXNna0txbHdJWkN1aVpzS2lZcFNSc3phRVVral8wc08xYjdicE1VNmZMNVVhdE9oQS1ncTBSRlEiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2UsIm90aGVyX2tleXNfY2FuX2JlX2FkZGVkX2hlcmUiOiJkbyBub3QgY29tcGFyZSBjbGllbnREYXRhSlNPTiBhZ2FpbnN0IGEgdGVtcGxhdGUuIFNlZSBodHRwczovL2dvby5nbC95YWJQZXgifQ==', 'transports': [], 'backup_eligible': True, 'backup_state': False}
[2025-06-20 22:11:54,775] INFO authentication webauthn_register_complete:245 - Serializer validated successfully
[2025-06-20 22:11:54,775] INFO authentication webauthn_register_complete:246 - Validated data: {'username': 'new8', 'credential_id': 'wa3Hrq8hLVD+fn4zDiHNjQ==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEMGtx66vIS1Q/n5+Mw4hzY2lAQIDJiABIVggsq6SNHAF2CBQvHaKQe0dF3CwIMX48zLs39eZIJuaovciWCBGszC3kAUs1rShLgysvga22+3xvZyvQFO6iYn8nNSm1w==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoiRGhrOXptTXpITVNRNlpDX0gzTHUyXzRWSjZ3ZzVuVXNna0txbHdJWkN1aVpzS2lZcFNSc3phRVVral8wc08xYjdicE1VNmZMNVVhdE9oQS1ncTBSRlEiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2UsIm90aGVyX2tleXNfY2FuX2JlX2FkZGVkX2hlcmUiOiJkbyBub3QgY29tcGFyZSBjbGllbnREYXRhSlNPTiBhZ2FpbnN0IGEgdGVtcGxhdGUuIFNlZSBodHRwczovL2dvby5nbC95YWJQZXgifQ==', 'transports': [], 'backup_eligible': True, 'backup_state': False}
[2025-06-20 22:11:54,776] INFO authentication webauthn_register_complete:249 - Challenge ID from request: e280b6c5-06a2-4c4b-b87d-72e79b1e111b
[2025-06-20 22:11:54,776] INFO authentication webauthn_register_complete:260 - Retrieved stored challenge data:
[2025-06-20 22:11:54,776] INFO authentication webauthn_register_complete:261 -   - Challenge: Dhk9zmMzHMSQ6ZC/H3Lu2/4VJ6wg5nUsgkKqlwIZCuiZsKiYpSRszaEUkj/0sO1b7bpMU6fL5UatOhA+gq0RFQ==
[2025-06-20 22:11:54,777] INFO authentication webauthn_register_complete:262 -   - Username: new8
[2025-06-20 22:11:54,777] INFO authentication webauthn_register_complete:263 -   - Type: registration
[2025-06-20 22:11:54,779] INFO authentication webauthn_register_complete:267 - User found: new8 (ID: 9)
[2025-06-20 22:11:54,780] INFO authentication webauthn_register_complete:273 - Starting verification for user: new8
[2025-06-20 22:11:54,780] INFO authentication webauthn_register_complete:274 - Challenge: Dhk9zmMzHMSQ6ZC/H3Lu2/4VJ6wg5nUsgkKqlwIZCuiZsKiYpSRszaEUkj/0sO1b7bpMU6fL5UatOhA+gq0RFQ==
[2025-06-20 22:11:54,780] INFO authentication webauthn_register_complete:275 - RP ID: localhost
[2025-06-20 22:11:54,780] INFO authentication webauthn_register_complete:276 - Origin: http://localhost:5173
[2025-06-20 22:11:54,781] INFO authentication webauthn_register_complete:279 - Original credential_id: wa3Hrq8hLVD+fn4zDiHNjQ==
[2025-06-20 22:11:54,781] INFO authentication webauthn_register_complete:280 - Credential_id length: 24
[2025-06-20 22:11:54,781] INFO authentication webauthn_register_complete:289 - Decoded raw_id length: 16 bytes
[2025-06-20 22:11:54,781] INFO authentication webauthn_register_complete:290 - Raw_id (hex): c1adc7aeaf212d50fe7e7e330e21cd8d
[2025-06-20 22:11:54,781] INFO authentication webauthn_register_complete:295 - Attestation object length: 178 bytes
[2025-06-20 22:11:54,782] INFO authentication webauthn_register_complete:296 - Client data JSON length: 289 bytes
[2025-06-20 22:11:54,782] INFO authentication webauthn_register_complete:297 - Client data JSON content: {"type":"webauthn.create","challenge":"Dhk9zmMzHMSQ6ZC_H3Lu2_4VJ6wg5nUsgkKqlwIZCuiZsKiYpSRszaEUkj_0sO1b7bpMU6fL5UatOhA-gq0RFQ","origin":"http://localhost:5173","crossOrigin":false,"other_keys_can_be_added_here":"do not compare clientDataJSON against a template. See https://goo.gl/yabPex"}
[2025-06-20 22:11:54,782] INFO authentication webauthn_register_complete:303 - AuthenticatorAttestationResponse created successfully
[2025-06-20 22:11:54,782] INFO authentication webauthn_register_complete:311 - RegistrationCredential created successfully
[2025-06-20 22:11:54,782] INFO authentication webauthn_register_complete:312 - Credential ID: wa3Hrq8hLVD+fn4zDiHNjQ==
[2025-06-20 22:11:54,782] INFO authentication webauthn_register_complete:313 - Credential raw_id length: 16 bytes
[2025-06-20 22:11:54,783] INFO authentication webauthn_register_complete:314 - Credential type: public-key
[2025-06-20 22:11:54,783] INFO authentication webauthn_register_complete:316 - Starting verification with webauthn library...
[2025-06-20 22:11:54,783] ERROR authentication webauthn_register_complete:363 - Registration verification failed: id and raw_id were not equivalent
[2025-06-20 22:11:54,783] ERROR authentication webauthn_register_complete:364 - Exception type: InvalidRegistrationResponse
[2025-06-20 22:11:54,785] ERROR authentication webauthn_register_complete:365 - Traceback: Traceback (most recent call last):
  File "C:\Users\fazi\Desktop\machine task\secure-dashboard\backend\authentication\views.py", line 317, in webauthn_register_complete
    verification = verify_registration_response(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fazi\Desktop\machine task\secure-dashboard\backend\venv\Lib\site-packages\webauthn\registration\verify_registration_response.py", line 111, in verify_registration_response
    raise InvalidRegistrationResponse("id and raw_id were not equivalent")
webauthn.helpers.exceptions.InvalidRegistrationResponse: id and raw_id were not equivalent

[2025-06-20 22:32:07,196] INFO authentication register_user:48 - === User Registration ===
[2025-06-20 22:32:07,199] INFO authentication register_user:49 - Request data: {'username': 'new8', 'email': 'new8@gmail.com', 'first_name': 'new', 'last_name': 'new', 'password': 'new8@1234', 'password_confirm': 'new8@1234'}
[2025-06-20 22:32:07,384] ERROR authentication register_user:60 - Registration failed: {'username': [ErrorDetail(string='A user with that username already exists.', code='unique')]}
[2025-06-20 22:32:56,111] INFO authentication register_user:48 - === User Registration ===
[2025-06-20 22:32:56,111] INFO authentication register_user:49 - Request data: {'username': 'new9', 'email': 'new9@gmail.com', 'first_name': 'new', 'last_name': 'new', 'password': 'new9@1234', 'password_confirm': 'new9@1234'}
[2025-06-20 22:32:56,497] INFO authentication register_user:54 - User registered successfully: new9 (ID: 10)
[2025-06-20 22:33:05,174] INFO authentication webauthn_register_begin:114 - === WebAuthn Registration Begin ===
[2025-06-20 22:33:05,174] INFO authentication webauthn_register_begin:115 - Request data: {'username': 'new9', 'display_name': 'new new'}
[2025-06-20 22:33:05,175] INFO authentication webauthn_register_begin:125 - Processing registration for user: new9, display_name: new new
[2025-06-20 22:33:05,178] INFO authentication webauthn_register_begin:131 - User found: new9 (ID: 10)
[2025-06-20 22:33:05,178] INFO authentication webauthn_register_begin:139 - Generating registration options...
[2025-06-20 22:33:05,179] INFO authentication webauthn_register_begin:140 - RP Name: Secure Dashboard
[2025-06-20 22:33:05,179] INFO authentication webauthn_register_begin:141 - RP ID: localhost
[2025-06-20 22:33:05,179] INFO authentication webauthn_register_begin:142 - User ID (bytes): b'new9'
[2025-06-20 22:33:05,180] INFO authentication webauthn_register_begin:155 - Registration options generated successfully
[2025-06-20 22:33:05,180] INFO authentication webauthn_register_begin:156 - Challenge (base64): alL2Masf2nVue1UqSwCR0tppLqHYQN6/l9+HNKR4ZeM7HOVFbSj85HhVGkLAiUifbjok5ZFkdPkENgrxfCBQgg==
[2025-06-20 22:33:05,180] INFO authentication webauthn_register_begin:157 - Challenge length: 64 bytes
[2025-06-20 22:33:05,181] INFO authentication webauthn_register_begin:167 - Challenge stored with ID: b0d8667a-3b48-4fc0-b14f-1dc4242959f9
[2025-06-20 22:33:05,181] INFO authentication webauthn_register_begin:168 - Total challenges in memory: 1
[2025-06-20 22:33:05,181] INFO authentication webauthn_register_begin:205 - Registration options converted to dictionary
[2025-06-20 22:33:05,181] INFO authentication webauthn_register_begin:206 - Options dict keys: ['challenge', 'rp', 'user', 'pubKeyCredParams', 'timeout', 'excludeCredentials', 'authenticatorSelection', 'attestation']
[2025-06-20 22:33:05,183] INFO authentication webauthn_register_begin:207 - User ID in options: bmV3OQ==
[2025-06-20 22:33:05,183] INFO authentication webauthn_register_begin:208 - Challenge in options: alL2Masf2nVue1UqSwCR0tppLqHYQN6/l9+HNKR4ZeM7HOVFbSj85HhVGkLAiUifbjok5ZFkdPkENgrxfCBQgg==
[2025-06-20 22:33:05,183] INFO authentication webauthn_register_begin:215 - === WebAuthn Registration Begin Complete ===
[2025-06-20 22:33:05,183] INFO authentication webauthn_register_begin:216 - Response data: {'options': {'challenge': 'alL2Masf2nVue1UqSwCR0tppLqHYQN6/l9+HNKR4ZeM7HOVFbSj85HhVGkLAiUifbjok5ZFkdPkENgrxfCBQgg==', 'rp': {'name': 'Secure Dashboard', 'id': 'localhost'}, 'user': {'id': 'bmV3OQ==', 'name': 'new9', 'displayName': 'new new'}, 'pubKeyCredParams': [{'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_256: -7>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.EDDSA: -8>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_512: -36>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_256: -37>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_384: -38>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_512: -39>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_256: -257>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_384: -258>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_512: -259>}], 'timeout': 60000, 'excludeCredentials': [], 'authenticatorSelection': {'authenticatorAttachment': None, 'requireResidentKey': False, 'residentKey': None, 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>}, 'attestation': <AttestationConveyancePreference.NONE: 'none'>}, 'challenge_id': 'b0d8667a-3b48-4fc0-b14f-1dc4242959f9'}
[2025-06-20 22:33:39,660] INFO authentication webauthn_register_begin:114 - === WebAuthn Registration Begin ===
[2025-06-20 22:33:39,660] INFO authentication webauthn_register_begin:115 - Request data: {'username': 'new9', 'display_name': 'new new'}
[2025-06-20 22:33:39,661] INFO authentication webauthn_register_begin:125 - Processing registration for user: new9, display_name: new new
[2025-06-20 22:33:39,664] INFO authentication webauthn_register_begin:131 - User found: new9 (ID: 10)
[2025-06-20 22:33:39,664] INFO authentication webauthn_register_begin:139 - Generating registration options...
[2025-06-20 22:33:39,664] INFO authentication webauthn_register_begin:140 - RP Name: Secure Dashboard
[2025-06-20 22:33:39,664] INFO authentication webauthn_register_begin:141 - RP ID: localhost
[2025-06-20 22:33:39,664] INFO authentication webauthn_register_begin:142 - User ID (bytes): b'new9'
[2025-06-20 22:33:39,665] INFO authentication webauthn_register_begin:155 - Registration options generated successfully
[2025-06-20 22:33:39,665] INFO authentication webauthn_register_begin:156 - Challenge (base64): 7jKFf31QcEzL6YJB5D5uZpiXoGAMwRloG5fN6tueMu5Ph4IoMerG1Yl/N5hnl/1S2ep3eCXThe4vmhtZuWGrMw==
[2025-06-20 22:33:39,665] INFO authentication webauthn_register_begin:157 - Challenge length: 64 bytes
[2025-06-20 22:33:39,665] INFO authentication webauthn_register_begin:167 - Challenge stored with ID: 7163f540-4d80-4ebd-bc8f-1bdc440e0d6c
[2025-06-20 22:33:39,666] INFO authentication webauthn_register_begin:168 - Total challenges in memory: 2
[2025-06-20 22:33:39,666] INFO authentication webauthn_register_begin:205 - Registration options converted to dictionary
[2025-06-20 22:33:39,666] INFO authentication webauthn_register_begin:206 - Options dict keys: ['challenge', 'rp', 'user', 'pubKeyCredParams', 'timeout', 'excludeCredentials', 'authenticatorSelection', 'attestation']
[2025-06-20 22:33:39,666] INFO authentication webauthn_register_begin:207 - User ID in options: bmV3OQ==
[2025-06-20 22:33:39,666] INFO authentication webauthn_register_begin:208 - Challenge in options: 7jKFf31QcEzL6YJB5D5uZpiXoGAMwRloG5fN6tueMu5Ph4IoMerG1Yl/N5hnl/1S2ep3eCXThe4vmhtZuWGrMw==
[2025-06-20 22:33:39,667] INFO authentication webauthn_register_begin:215 - === WebAuthn Registration Begin Complete ===
[2025-06-20 22:33:39,667] INFO authentication webauthn_register_begin:216 - Response data: {'options': {'challenge': '7jKFf31QcEzL6YJB5D5uZpiXoGAMwRloG5fN6tueMu5Ph4IoMerG1Yl/N5hnl/1S2ep3eCXThe4vmhtZuWGrMw==', 'rp': {'name': 'Secure Dashboard', 'id': 'localhost'}, 'user': {'id': 'bmV3OQ==', 'name': 'new9', 'displayName': 'new new'}, 'pubKeyCredParams': [{'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_256: -7>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.EDDSA: -8>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_512: -36>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_256: -37>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_384: -38>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_512: -39>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_256: -257>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_384: -258>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_512: -259>}], 'timeout': 60000, 'excludeCredentials': [], 'authenticatorSelection': {'authenticatorAttachment': None, 'requireResidentKey': False, 'residentKey': None, 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>}, 'attestation': <AttestationConveyancePreference.NONE: 'none'>}, 'challenge_id': '7163f540-4d80-4ebd-bc8f-1bdc440e0d6c'}
[2025-06-20 22:34:00,269] INFO authentication webauthn_register_complete:237 - === WebAuthn Registration Complete ===
[2025-06-20 22:34:00,270] INFO authentication webauthn_register_complete:238 - Request data: {'username': 'new9', 'challenge_id': '7163f540-4d80-4ebd-bc8f-1bdc440e0d6c', 'credential_id': 'yHwcBuNMPtWDLk5xDNECNg==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEMh8HAbjTD7Vgy5OcQzRAjalAQIDJiABIVgg34x4i3agxrl24Ff1S2ydLhNx2l4SARKlJvMqHHfEFywiWCD8umXEk7E6QCvajTtK1m4eGPBKZRI+gPKJc0LKIoAghw==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoiN2pLRmYzMVFjRXpMNllKQjVENXVacGlYb0dBTXdSbG9HNWZONnR1ZU11NVBoNElvTWVyRzFZbF9ONWhubF8xUzJlcDNlQ1hUaGU0dm1odFp1V0dyTXciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2UsIm90aGVyX2tleXNfY2FuX2JlX2FkZGVkX2hlcmUiOiJkbyBub3QgY29tcGFyZSBjbGllbnREYXRhSlNPTiBhZ2FpbnN0IGEgdGVtcGxhdGUuIFNlZSBodHRwczovL2dvby5nbC95YWJQZXgifQ==', 'transports': [], 'backup_eligible': True, 'backup_state': False}
[2025-06-20 22:34:00,272] INFO authentication webauthn_register_complete:239 - Request data type: <class 'dict'>
[2025-06-20 22:34:00,272] INFO authentication webauthn_register_complete:240 - Request data keys: ['username', 'challenge_id', 'credential_id', 'attestation_object', 'client_data_json', 'transports', 'backup_eligible', 'backup_state']
[2025-06-20 22:34:00,272] INFO authentication webauthn_register_complete:244 - Field 'username': type=<class 'str'>, length=4
[2025-06-20 22:34:00,272] INFO authentication webauthn_register_complete:244 - Field 'challenge_id': type=<class 'str'>, length=36
[2025-06-20 22:34:00,272] INFO authentication webauthn_register_complete:244 - Field 'credential_id': type=<class 'str'>, length=24
[2025-06-20 22:34:00,272] INFO authentication webauthn_register_complete:246 -   Value: yHwcBuNMPtWDLk5xDNECNg==
[2025-06-20 22:34:00,273] INFO authentication webauthn_register_complete:248 -   Contains padding: True
[2025-06-20 22:34:00,273] INFO authentication webauthn_register_complete:249 -   Valid base64 length: True
[2025-06-20 22:34:00,273] INFO authentication webauthn_register_complete:244 - Field 'attestation_object': type=<class 'str'>, length=240
[2025-06-20 22:34:00,273] INFO authentication webauthn_register_complete:246 -   Value: o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEMh8HAbjTD7Vgy5OcQzRAjalAQIDJiABIVgg34x4i3agxrl24Ff1S2ydLhNx2l4SARKlJvMqHHfEFywiWCD8umXEk7E6QCvajTtK1m4eGPBKZRI+gPKJc0LKIoAghw==
[2025-06-20 22:34:00,274] INFO authentication webauthn_register_complete:248 -   Contains padding: True
[2025-06-20 22:34:00,274] INFO authentication webauthn_register_complete:249 -   Valid base64 length: True
[2025-06-20 22:34:00,274] INFO authentication webauthn_register_complete:244 - Field 'client_data_json': type=<class 'str'>, length=388
[2025-06-20 22:34:00,274] INFO authentication webauthn_register_complete:246 -   Value: eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoiN2pLRmYzMVFjRXpMNllKQjVENXVacGlYb0dBTXdSbG9HNWZONnR1ZU11NVBoNElvTWVyRzFZbF9ONWhubF8xUzJlcDNlQ1hUaGU0dm1odFp1V0dyTXciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2UsIm90aGVyX2tleXNfY2FuX2JlX2FkZGVkX2hlcmUiOiJkbyBub3QgY29tcGFyZSBjbGllbnREYXRhSlNPTiBhZ2FpbnN0IGEgdGVtcGxhdGUuIFNlZSBodHRwczovL2dvby5nbC95YWJQZXgifQ==
[2025-06-20 22:34:00,275] INFO authentication webauthn_register_complete:248 -   Contains padding: True
[2025-06-20 22:34:00,275] INFO authentication webauthn_register_complete:249 -   Valid base64 length: True
[2025-06-20 22:34:00,275] INFO authentication webauthn_register_complete:244 - Field 'transports': type=<class 'list'>, length=0
[2025-06-20 22:34:00,275] INFO authentication webauthn_register_complete:244 - Field 'backup_eligible': type=<class 'bool'>, length=4
[2025-06-20 22:34:00,275] INFO authentication webauthn_register_complete:244 - Field 'backup_state': type=<class 'bool'>, length=0
[2025-06-20 22:34:00,278] INFO authentication webauthn_register_complete:256 - Serializer validated successfully
[2025-06-20 22:34:00,279] INFO authentication webauthn_register_complete:257 - Validated data: {'username': 'new9', 'credential_id': 'yHwcBuNMPtWDLk5xDNECNg==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEMh8HAbjTD7Vgy5OcQzRAjalAQIDJiABIVgg34x4i3agxrl24Ff1S2ydLhNx2l4SARKlJvMqHHfEFywiWCD8umXEk7E6QCvajTtK1m4eGPBKZRI+gPKJc0LKIoAghw==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoiN2pLRmYzMVFjRXpMNllKQjVENXVacGlYb0dBTXdSbG9HNWZONnR1ZU11NVBoNElvTWVyRzFZbF9ONWhubF8xUzJlcDNlQ1hUaGU0dm1odFp1V0dyTXciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2UsIm90aGVyX2tleXNfY2FuX2JlX2FkZGVkX2hlcmUiOiJkbyBub3QgY29tcGFyZSBjbGllbnREYXRhSlNPTiBhZ2FpbnN0IGEgdGVtcGxhdGUuIFNlZSBodHRwczovL2dvby5nbC95YWJQZXgifQ==', 'transports': [], 'backup_eligible': True, 'backup_state': False}
[2025-06-20 22:34:00,279] INFO authentication webauthn_register_complete:260 - Challenge ID from request: 7163f540-4d80-4ebd-bc8f-1bdc440e0d6c
[2025-06-20 22:34:00,280] INFO authentication webauthn_register_complete:271 - Retrieved stored challenge data:
[2025-06-20 22:34:00,280] INFO authentication webauthn_register_complete:272 -   - Challenge: 7jKFf31QcEzL6YJB5D5uZpiXoGAMwRloG5fN6tueMu5Ph4IoMerG1Yl/N5hnl/1S2ep3eCXThe4vmhtZuWGrMw==
[2025-06-20 22:34:00,280] INFO authentication webauthn_register_complete:273 -   - Username: new9
[2025-06-20 22:34:00,280] INFO authentication webauthn_register_complete:274 -   - Type: registration
[2025-06-20 22:34:00,283] INFO authentication webauthn_register_complete:278 - User found: new9 (ID: 10)
[2025-06-20 22:34:00,283] INFO authentication webauthn_register_complete:284 - Starting verification for user: new9
[2025-06-20 22:34:00,283] INFO authentication webauthn_register_complete:285 - Challenge: 7jKFf31QcEzL6YJB5D5uZpiXoGAMwRloG5fN6tueMu5Ph4IoMerG1Yl/N5hnl/1S2ep3eCXThe4vmhtZuWGrMw==
[2025-06-20 22:34:00,283] INFO authentication webauthn_register_complete:286 - RP ID: localhost
[2025-06-20 22:34:00,283] INFO authentication webauthn_register_complete:287 - Origin: http://localhost:5173
[2025-06-20 22:34:00,284] INFO authentication webauthn_register_complete:290 - Original credential_id: yHwcBuNMPtWDLk5xDNECNg==
[2025-06-20 22:34:00,284] INFO authentication webauthn_register_complete:291 - Credential_id length: 24
[2025-06-20 22:34:00,284] INFO authentication webauthn_register_complete:292 - Credential_id contains padding: True
[2025-06-20 22:34:00,284] INFO authentication webauthn_register_complete:293 - Credential_id is valid base64: True
[2025-06-20 22:34:00,285] INFO authentication webauthn_register_complete:302 - Decoded raw_id length: 16 bytes
[2025-06-20 22:34:00,285] INFO authentication webauthn_register_complete:303 - Raw_id (hex): c87c1c06e34c3ed5832e4e710cd10236
[2025-06-20 22:34:00,286] INFO authentication webauthn_register_complete:307 - Re-encoded credential_id: yHwcBuNMPtWDLk5xDNECNg
[2025-06-20 22:34:00,286] INFO authentication webauthn_register_complete:308 - Original vs re-encoded match: False
[2025-06-20 22:34:00,286] INFO authentication webauthn_register_complete:312 - Standard base64 encoded: yHwcBuNMPtWDLk5xDNECNg==
[2025-06-20 22:34:00,286] INFO authentication webauthn_register_complete:313 - Original vs standard base64 match: True
[2025-06-20 22:34:00,286] INFO authentication webauthn_register_complete:318 - Attestation object length: 178 bytes
[2025-06-20 22:34:00,287] INFO authentication webauthn_register_complete:319 - Client data JSON length: 289 bytes
[2025-06-20 22:34:00,287] INFO authentication webauthn_register_complete:320 - Client data JSON content: {"type":"webauthn.create","challenge":"7jKFf31QcEzL6YJB5D5uZpiXoGAMwRloG5fN6tueMu5Ph4IoMerG1Yl_N5hnl_1S2ep3eCXThe4vmhtZuWGrMw","origin":"http://localhost:5173","crossOrigin":false,"other_keys_can_be_added_here":"do not compare clientDataJSON against a template. See https://goo.gl/yabPex"}
[2025-06-20 22:34:00,287] INFO authentication webauthn_register_complete:326 - AuthenticatorAttestationResponse created successfully
[2025-06-20 22:34:00,288] INFO authentication webauthn_register_complete:334 - RegistrationCredential created successfully
[2025-06-20 22:34:00,288] INFO authentication webauthn_register_complete:335 - Credential ID type: <class 'bytes'>
[2025-06-20 22:34:00,288] INFO authentication webauthn_register_complete:336 - Credential ID length: 16 bytes
[2025-06-20 22:34:00,288] INFO authentication webauthn_register_complete:337 - Credential ID (hex): c87c1c06e34c3ed5832e4e710cd10236
[2025-06-20 22:34:00,288] INFO authentication webauthn_register_complete:338 - Credential raw_id type: <class 'bytes'>
[2025-06-20 22:34:00,289] INFO authentication webauthn_register_complete:339 - Credential raw_id length: 16 bytes
[2025-06-20 22:34:00,289] INFO authentication webauthn_register_complete:340 - Credential raw_id (hex): c87c1c06e34c3ed5832e4e710cd10236
[2025-06-20 22:34:00,289] INFO authentication webauthn_register_complete:341 - Credential type: public-key
[2025-06-20 22:34:00,289] INFO authentication webauthn_register_complete:344 - ID and raw_id are equivalent: True
[2025-06-20 22:34:00,289] INFO authentication webauthn_register_complete:345 - ID and raw_id have same type: True
[2025-06-20 22:34:00,290] INFO authentication webauthn_register_complete:346 - ID and raw_id have same length: True
[2025-06-20 22:34:00,290] INFO authentication webauthn_register_complete:348 - Starting verification with webauthn library...
[2025-06-20 22:34:00,290] ERROR authentication webauthn_register_complete:395 - Registration verification failed: id and raw_id were not equivalent
[2025-06-20 22:34:00,290] ERROR authentication webauthn_register_complete:396 - Exception type: InvalidRegistrationResponse
[2025-06-20 22:34:00,336] ERROR authentication webauthn_register_complete:397 - Traceback: Traceback (most recent call last):
  File "C:\Users\fazi\Desktop\machine task\secure-dashboard\backend\authentication\views.py", line 349, in webauthn_register_complete
    verification = verify_registration_response(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fazi\Desktop\machine task\secure-dashboard\backend\venv\Lib\site-packages\webauthn\registration\verify_registration_response.py", line 111, in verify_registration_response
    raise InvalidRegistrationResponse("id and raw_id were not equivalent")
webauthn.helpers.exceptions.InvalidRegistrationResponse: id and raw_id were not equivalent

[2025-06-20 22:40:09,988] INFO authentication webauthn_register_begin:114 - === WebAuthn Registration Begin ===
[2025-06-20 22:40:09,988] INFO authentication webauthn_register_begin:115 - Request data: {'username': 'new9', 'display_name': 'new new'}
[2025-06-20 22:40:09,988] INFO authentication webauthn_register_begin:125 - Processing registration for user: new9, display_name: new new
[2025-06-20 22:40:09,992] INFO authentication webauthn_register_begin:131 - User found: new9 (ID: 10)
[2025-06-20 22:40:09,993] INFO authentication webauthn_register_begin:139 - Generating registration options...
[2025-06-20 22:40:09,993] INFO authentication webauthn_register_begin:140 - RP Name: Secure Dashboard
[2025-06-20 22:40:09,993] INFO authentication webauthn_register_begin:141 - RP ID: localhost
[2025-06-20 22:40:09,993] INFO authentication webauthn_register_begin:142 - User ID (bytes): b'new9'
[2025-06-20 22:40:09,993] INFO authentication webauthn_register_begin:155 - Registration options generated successfully
[2025-06-20 22:40:09,993] INFO authentication webauthn_register_begin:156 - Challenge (base64): n0CbdueoWId0wKx7z3qi95AvtVOuCAV1WlQgLC98rURFC23H1MfPMRwRoa8PTFsDCTeBJsJnIDLAoxJ6j7LyFg==
[2025-06-20 22:40:09,994] INFO authentication webauthn_register_begin:157 - Challenge length: 64 bytes
[2025-06-20 22:40:09,994] INFO authentication webauthn_register_begin:167 - Challenge stored with ID: de9cc7b1-2e93-455b-9777-363714981bc7
[2025-06-20 22:40:09,994] INFO authentication webauthn_register_begin:168 - Total challenges in memory: 1
[2025-06-20 22:40:09,994] INFO authentication webauthn_register_begin:205 - Registration options converted to dictionary
[2025-06-20 22:40:09,994] INFO authentication webauthn_register_begin:206 - Options dict keys: ['challenge', 'rp', 'user', 'pubKeyCredParams', 'timeout', 'excludeCredentials', 'authenticatorSelection', 'attestation']
[2025-06-20 22:40:09,995] INFO authentication webauthn_register_begin:207 - User ID in options: bmV3OQ==
[2025-06-20 22:40:09,995] INFO authentication webauthn_register_begin:208 - Challenge in options: n0CbdueoWId0wKx7z3qi95AvtVOuCAV1WlQgLC98rURFC23H1MfPMRwRoa8PTFsDCTeBJsJnIDLAoxJ6j7LyFg==
[2025-06-20 22:40:09,995] INFO authentication webauthn_register_begin:215 - === WebAuthn Registration Begin Complete ===
[2025-06-20 22:40:09,995] INFO authentication webauthn_register_begin:216 - Response data: {'options': {'challenge': 'n0CbdueoWId0wKx7z3qi95AvtVOuCAV1WlQgLC98rURFC23H1MfPMRwRoa8PTFsDCTeBJsJnIDLAoxJ6j7LyFg==', 'rp': {'name': 'Secure Dashboard', 'id': 'localhost'}, 'user': {'id': 'bmV3OQ==', 'name': 'new9', 'displayName': 'new new'}, 'pubKeyCredParams': [{'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_256: -7>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.EDDSA: -8>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_512: -36>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_256: -37>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_384: -38>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_512: -39>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_256: -257>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_384: -258>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_512: -259>}], 'timeout': 60000, 'excludeCredentials': [], 'authenticatorSelection': {'authenticatorAttachment': None, 'requireResidentKey': False, 'residentKey': None, 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>}, 'attestation': <AttestationConveyancePreference.NONE: 'none'>}, 'challenge_id': 'de9cc7b1-2e93-455b-9777-363714981bc7'}
[2025-06-20 22:40:41,599] INFO authentication webauthn_register_complete:237 - === WebAuthn Registration Complete ===
[2025-06-20 22:40:41,599] INFO authentication webauthn_register_complete:238 - Request data: {'username': 'new9', 'challenge_id': 'de9cc7b1-2e93-455b-9777-363714981bc7', 'credential_id': 'aaj4N3mYwSc5/r/SYqbhAQ==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEGmo+Dd5mMEnOf6/0mKm4QGlAQIDJiABIVggK2p8UNvz2Z1Pbm7lKbCzkNzc3sPKP2lyh4YylNEOikoiWCDVI66WRL2rA83O1lHdNgwurOK6pII/84uYGF+vFxjNLg==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoibjBDYmR1ZW9XSWQwd0t4N3ozcWk5NUF2dFZPdUNBVjFXbFFnTEM5OHJVUkZDMjNIMU1mUE1Sd1JvYThQVEZzRENUZUJKc0puSURMQW94SjZqN0x5RmciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'transports': [], 'backup_eligible': True, 'backup_state': False}
[2025-06-20 22:40:41,599] INFO authentication webauthn_register_complete:239 - Request data type: <class 'dict'>
[2025-06-20 22:40:41,600] INFO authentication webauthn_register_complete:240 - Request data keys: ['username', 'challenge_id', 'credential_id', 'attestation_object', 'client_data_json', 'transports', 'backup_eligible', 'backup_state']
[2025-06-20 22:40:41,600] INFO authentication webauthn_register_complete:244 - Field 'username': type=<class 'str'>, length=4
[2025-06-20 22:40:41,600] INFO authentication webauthn_register_complete:244 - Field 'challenge_id': type=<class 'str'>, length=36
[2025-06-20 22:40:41,600] INFO authentication webauthn_register_complete:244 - Field 'credential_id': type=<class 'str'>, length=24
[2025-06-20 22:40:41,600] INFO authentication webauthn_register_complete:246 -   Value: aaj4N3mYwSc5/r/SYqbhAQ==
[2025-06-20 22:40:41,601] INFO authentication webauthn_register_complete:248 -   Contains padding: True
[2025-06-20 22:40:41,601] INFO authentication webauthn_register_complete:249 -   Valid base64 length: True
[2025-06-20 22:40:41,601] INFO authentication webauthn_register_complete:244 - Field 'attestation_object': type=<class 'str'>, length=240
[2025-06-20 22:40:41,601] INFO authentication webauthn_register_complete:246 -   Value: o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEGmo+Dd5mMEnOf6/0mKm4QGlAQIDJiABIVggK2p8UNvz2Z1Pbm7lKbCzkNzc3sPKP2lyh4YylNEOikoiWCDVI66WRL2rA83O1lHdNgwurOK6pII/84uYGF+vFxjNLg==
[2025-06-20 22:40:41,601] INFO authentication webauthn_register_complete:248 -   Contains padding: True
[2025-06-20 22:40:41,601] INFO authentication webauthn_register_complete:249 -   Valid base64 length: True
[2025-06-20 22:40:41,602] INFO authentication webauthn_register_complete:244 - Field 'client_data_json': type=<class 'str'>, length=240
[2025-06-20 22:40:41,602] INFO authentication webauthn_register_complete:246 -   Value: eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoibjBDYmR1ZW9XSWQwd0t4N3ozcWk5NUF2dFZPdUNBVjFXbFFnTEM5OHJVUkZDMjNIMU1mUE1Sd1JvYThQVEZzRENUZUJKc0puSURMQW94SjZqN0x5RmciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9
[2025-06-20 22:40:41,602] INFO authentication webauthn_register_complete:248 -   Contains padding: False
[2025-06-20 22:40:41,602] INFO authentication webauthn_register_complete:249 -   Valid base64 length: True
[2025-06-20 22:40:41,602] INFO authentication webauthn_register_complete:244 - Field 'transports': type=<class 'list'>, length=0
[2025-06-20 22:40:41,602] INFO authentication webauthn_register_complete:244 - Field 'backup_eligible': type=<class 'bool'>, length=4
[2025-06-20 22:40:41,603] INFO authentication webauthn_register_complete:244 - Field 'backup_state': type=<class 'bool'>, length=0
[2025-06-20 22:40:41,603] INFO authentication webauthn_register_complete:256 - Serializer validated successfully
[2025-06-20 22:40:41,603] INFO authentication webauthn_register_complete:257 - Validated data: {'username': 'new9', 'credential_id': 'aaj4N3mYwSc5/r/SYqbhAQ==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEGmo+Dd5mMEnOf6/0mKm4QGlAQIDJiABIVggK2p8UNvz2Z1Pbm7lKbCzkNzc3sPKP2lyh4YylNEOikoiWCDVI66WRL2rA83O1lHdNgwurOK6pII/84uYGF+vFxjNLg==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoibjBDYmR1ZW9XSWQwd0t4N3ozcWk5NUF2dFZPdUNBVjFXbFFnTEM5OHJVUkZDMjNIMU1mUE1Sd1JvYThQVEZzRENUZUJKc0puSURMQW94SjZqN0x5RmciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'transports': [], 'backup_eligible': True, 'backup_state': False}
[2025-06-20 22:40:41,605] INFO authentication webauthn_register_complete:260 - Challenge ID from request: de9cc7b1-2e93-455b-9777-363714981bc7
[2025-06-20 22:40:41,605] INFO authentication webauthn_register_complete:271 - Retrieved stored challenge data:
[2025-06-20 22:40:41,605] INFO authentication webauthn_register_complete:272 -   - Challenge: n0CbdueoWId0wKx7z3qi95AvtVOuCAV1WlQgLC98rURFC23H1MfPMRwRoa8PTFsDCTeBJsJnIDLAoxJ6j7LyFg==
[2025-06-20 22:40:41,605] INFO authentication webauthn_register_complete:273 -   - Username: new9
[2025-06-20 22:40:41,605] INFO authentication webauthn_register_complete:274 -   - Type: registration
[2025-06-20 22:40:41,607] INFO authentication webauthn_register_complete:278 - User found: new9 (ID: 10)
[2025-06-20 22:40:41,608] INFO authentication webauthn_register_complete:284 - Starting verification for user: new9
[2025-06-20 22:40:41,608] INFO authentication webauthn_register_complete:285 - Challenge: n0CbdueoWId0wKx7z3qi95AvtVOuCAV1WlQgLC98rURFC23H1MfPMRwRoa8PTFsDCTeBJsJnIDLAoxJ6j7LyFg==
[2025-06-20 22:40:41,608] INFO authentication webauthn_register_complete:286 - RP ID: localhost
[2025-06-20 22:40:41,608] INFO authentication webauthn_register_complete:287 - Origin: http://localhost:5173
[2025-06-20 22:40:41,608] INFO authentication webauthn_register_complete:290 - Original credential_id: aaj4N3mYwSc5/r/SYqbhAQ==
[2025-06-20 22:40:41,609] INFO authentication webauthn_register_complete:291 - Credential_id length: 24
[2025-06-20 22:40:41,609] INFO authentication webauthn_register_complete:292 - Credential_id contains padding: True
[2025-06-20 22:40:41,609] INFO authentication webauthn_register_complete:293 - Credential_id is valid base64: True
[2025-06-20 22:40:41,609] INFO authentication webauthn_register_complete:302 - Decoded raw_id length: 16 bytes
[2025-06-20 22:40:41,609] INFO authentication webauthn_register_complete:303 - Raw_id (hex): 69a8f8377998c12739febfd262a6e101
[2025-06-20 22:40:41,610] INFO authentication webauthn_register_complete:307 - Re-encoded credential_id: aaj4N3mYwSc5_r_SYqbhAQ
[2025-06-20 22:40:41,610] INFO authentication webauthn_register_complete:308 - Original vs re-encoded match: False
[2025-06-20 22:40:41,610] INFO authentication webauthn_register_complete:312 - Standard base64 encoded: aaj4N3mYwSc5/r/SYqbhAQ==
[2025-06-20 22:40:41,610] INFO authentication webauthn_register_complete:313 - Original vs standard base64 match: True
[2025-06-20 22:40:41,610] INFO authentication webauthn_register_complete:318 - Attestation object length: 178 bytes
[2025-06-20 22:40:41,610] INFO authentication webauthn_register_complete:319 - Client data JSON length: 180 bytes
[2025-06-20 22:40:41,611] INFO authentication webauthn_register_complete:320 - Client data JSON content: {"type":"webauthn.create","challenge":"n0CbdueoWId0wKx7z3qi95AvtVOuCAV1WlQgLC98rURFC23H1MfPMRwRoa8PTFsDCTeBJsJnIDLAoxJ6j7LyFg","origin":"http://localhost:5173","crossOrigin":false}
[2025-06-20 22:40:41,611] INFO authentication webauthn_register_complete:326 - AuthenticatorAttestationResponse created successfully
[2025-06-20 22:40:41,611] INFO authentication webauthn_register_complete:334 - RegistrationCredential created successfully
[2025-06-20 22:40:41,611] INFO authentication webauthn_register_complete:335 - Credential ID type: <class 'str'>
[2025-06-20 22:40:41,612] INFO authentication webauthn_register_complete:336 - Credential ID value: aaj4N3mYwSc5/r/SYqbhAQ==
[2025-06-20 22:40:41,612] INFO authentication webauthn_register_complete:337 - Credential raw_id type: <class 'bytes'>
[2025-06-20 22:40:41,612] INFO authentication webauthn_register_complete:338 - Credential raw_id length: 16 bytes
[2025-06-20 22:40:41,612] INFO authentication webauthn_register_complete:339 - Credential raw_id (hex): 69a8f8377998c12739febfd262a6e101
[2025-06-20 22:40:41,612] INFO authentication webauthn_register_complete:340 - Credential type: public-key
[2025-06-20 22:40:41,612] INFO authentication webauthn_register_complete:345 - Base64url encoding of raw_id: aaj4N3mYwSc5_r_SYqbhAQ
[2025-06-20 22:40:41,612] INFO authentication webauthn_register_complete:346 - ID and base64url(raw_id) match: False
[2025-06-20 22:40:41,614] INFO authentication webauthn_register_complete:347 - ID and raw_id have correct types: True
[2025-06-20 22:40:41,614] INFO authentication webauthn_register_complete:349 - Starting verification with webauthn library...
[2025-06-20 22:40:41,614] ERROR authentication webauthn_register_complete:396 - Registration verification failed: id and raw_id were not equivalent
[2025-06-20 22:40:41,614] ERROR authentication webauthn_register_complete:397 - Exception type: InvalidRegistrationResponse
[2025-06-20 22:40:41,617] ERROR authentication webauthn_register_complete:398 - Traceback: Traceback (most recent call last):
  File "C:\Users\fazi\Desktop\machine task\secure-dashboard\backend\authentication\views.py", line 350, in webauthn_register_complete
    verification = verify_registration_response(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fazi\Desktop\machine task\secure-dashboard\backend\venv\Lib\site-packages\webauthn\registration\verify_registration_response.py", line 111, in verify_registration_response
    raise InvalidRegistrationResponse("id and raw_id were not equivalent")
webauthn.helpers.exceptions.InvalidRegistrationResponse: id and raw_id were not equivalent

[2025-06-20 22:43:31,954] INFO authentication webauthn_register_begin:114 - === WebAuthn Registration Begin ===
[2025-06-20 22:43:31,954] INFO authentication webauthn_register_begin:115 - Request data: {'username': 'new9', 'display_name': 'new new'}
[2025-06-20 22:43:31,955] INFO authentication webauthn_register_begin:125 - Processing registration for user: new9, display_name: new new
[2025-06-20 22:43:31,958] INFO authentication webauthn_register_begin:131 - User found: new9 (ID: 10)
[2025-06-20 22:43:31,958] INFO authentication webauthn_register_begin:139 - Generating registration options...
[2025-06-20 22:43:31,958] INFO authentication webauthn_register_begin:140 - RP Name: Secure Dashboard
[2025-06-20 22:43:31,959] INFO authentication webauthn_register_begin:141 - RP ID: localhost
[2025-06-20 22:43:31,959] INFO authentication webauthn_register_begin:142 - User ID (bytes): b'new9'
[2025-06-20 22:43:31,959] INFO authentication webauthn_register_begin:155 - Registration options generated successfully
[2025-06-20 22:43:31,959] INFO authentication webauthn_register_begin:156 - Challenge (base64): uAfnOeudxhorl5FZ2InqgFnZ1L7d2ahOZ71lrBCz6N7qllhkVpaeQrzxNm9Qw6vcsYStEK3VjPyR7auIrSok4Q==
[2025-06-20 22:43:31,960] INFO authentication webauthn_register_begin:157 - Challenge length: 64 bytes
[2025-06-20 22:43:31,960] INFO authentication webauthn_register_begin:167 - Challenge stored with ID: 7527625a-54d7-4b13-a93e-615105181bc2
[2025-06-20 22:43:31,960] INFO authentication webauthn_register_begin:168 - Total challenges in memory: 1
[2025-06-20 22:43:31,961] INFO authentication webauthn_register_begin:205 - Registration options converted to dictionary
[2025-06-20 22:43:31,961] INFO authentication webauthn_register_begin:206 - Options dict keys: ['challenge', 'rp', 'user', 'pubKeyCredParams', 'timeout', 'excludeCredentials', 'authenticatorSelection', 'attestation']
[2025-06-20 22:43:31,961] INFO authentication webauthn_register_begin:207 - User ID in options: bmV3OQ==
[2025-06-20 22:43:31,961] INFO authentication webauthn_register_begin:208 - Challenge in options: uAfnOeudxhorl5FZ2InqgFnZ1L7d2ahOZ71lrBCz6N7qllhkVpaeQrzxNm9Qw6vcsYStEK3VjPyR7auIrSok4Q==
[2025-06-20 22:43:31,962] INFO authentication webauthn_register_begin:215 - === WebAuthn Registration Begin Complete ===
[2025-06-20 22:43:31,962] INFO authentication webauthn_register_begin:216 - Response data: {'options': {'challenge': 'uAfnOeudxhorl5FZ2InqgFnZ1L7d2ahOZ71lrBCz6N7qllhkVpaeQrzxNm9Qw6vcsYStEK3VjPyR7auIrSok4Q==', 'rp': {'name': 'Secure Dashboard', 'id': 'localhost'}, 'user': {'id': 'bmV3OQ==', 'name': 'new9', 'displayName': 'new new'}, 'pubKeyCredParams': [{'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_256: -7>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.EDDSA: -8>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_512: -36>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_256: -37>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_384: -38>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_512: -39>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_256: -257>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_384: -258>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_512: -259>}], 'timeout': 60000, 'excludeCredentials': [], 'authenticatorSelection': {'authenticatorAttachment': None, 'requireResidentKey': False, 'residentKey': None, 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>}, 'attestation': <AttestationConveyancePreference.NONE: 'none'>}, 'challenge_id': '7527625a-54d7-4b13-a93e-615105181bc2'}
[2025-06-20 22:43:41,132] INFO authentication webauthn_register_begin:114 - === WebAuthn Registration Begin ===
[2025-06-20 22:43:41,132] INFO authentication webauthn_register_begin:115 - Request data: {'username': 'new9', 'display_name': 'new new'}
[2025-06-20 22:43:41,132] INFO authentication webauthn_register_begin:125 - Processing registration for user: new9, display_name: new new
[2025-06-20 22:43:41,135] INFO authentication webauthn_register_begin:131 - User found: new9 (ID: 10)
[2025-06-20 22:43:41,135] INFO authentication webauthn_register_begin:139 - Generating registration options...
[2025-06-20 22:43:41,136] INFO authentication webauthn_register_begin:140 - RP Name: Secure Dashboard
[2025-06-20 22:43:41,136] INFO authentication webauthn_register_begin:141 - RP ID: localhost
[2025-06-20 22:43:41,136] INFO authentication webauthn_register_begin:142 - User ID (bytes): b'new9'
[2025-06-20 22:43:41,136] INFO authentication webauthn_register_begin:155 - Registration options generated successfully
[2025-06-20 22:43:41,137] INFO authentication webauthn_register_begin:156 - Challenge (base64): KGqMGduc8tmhbKoP9bdjxGwiSKDOymLeom+ruGlyQd1ikv8Lebouy+cJLHM7n3GWxZusVdNLBmGfEMZBuDVDUg==
[2025-06-20 22:43:41,137] INFO authentication webauthn_register_begin:157 - Challenge length: 64 bytes
[2025-06-20 22:43:41,137] INFO authentication webauthn_register_begin:167 - Challenge stored with ID: e2bc65eb-fa71-4fb8-9741-74be19705bd4
[2025-06-20 22:43:41,137] INFO authentication webauthn_register_begin:168 - Total challenges in memory: 2
[2025-06-20 22:43:41,137] INFO authentication webauthn_register_begin:205 - Registration options converted to dictionary
[2025-06-20 22:43:41,138] INFO authentication webauthn_register_begin:206 - Options dict keys: ['challenge', 'rp', 'user', 'pubKeyCredParams', 'timeout', 'excludeCredentials', 'authenticatorSelection', 'attestation']
[2025-06-20 22:43:41,138] INFO authentication webauthn_register_begin:207 - User ID in options: bmV3OQ==
[2025-06-20 22:43:41,138] INFO authentication webauthn_register_begin:208 - Challenge in options: KGqMGduc8tmhbKoP9bdjxGwiSKDOymLeom+ruGlyQd1ikv8Lebouy+cJLHM7n3GWxZusVdNLBmGfEMZBuDVDUg==
[2025-06-20 22:43:41,138] INFO authentication webauthn_register_begin:215 - === WebAuthn Registration Begin Complete ===
[2025-06-20 22:43:41,138] INFO authentication webauthn_register_begin:216 - Response data: {'options': {'challenge': 'KGqMGduc8tmhbKoP9bdjxGwiSKDOymLeom+ruGlyQd1ikv8Lebouy+cJLHM7n3GWxZusVdNLBmGfEMZBuDVDUg==', 'rp': {'name': 'Secure Dashboard', 'id': 'localhost'}, 'user': {'id': 'bmV3OQ==', 'name': 'new9', 'displayName': 'new new'}, 'pubKeyCredParams': [{'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_256: -7>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.EDDSA: -8>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_512: -36>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_256: -37>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_384: -38>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_512: -39>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_256: -257>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_384: -258>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_512: -259>}], 'timeout': 60000, 'excludeCredentials': [], 'authenticatorSelection': {'authenticatorAttachment': None, 'requireResidentKey': False, 'residentKey': None, 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>}, 'attestation': <AttestationConveyancePreference.NONE: 'none'>}, 'challenge_id': 'e2bc65eb-fa71-4fb8-9741-74be19705bd4'}
[2025-06-20 22:45:37,868] INFO authentication webauthn_register_begin:114 - === WebAuthn Registration Begin ===
[2025-06-20 22:45:37,869] INFO authentication webauthn_register_begin:115 - Request data: {'username': 'new9', 'display_name': 'new new'}
[2025-06-20 22:45:37,869] INFO authentication webauthn_register_begin:125 - Processing registration for user: new9, display_name: new new
[2025-06-20 22:45:37,871] INFO authentication webauthn_register_begin:131 - User found: new9 (ID: 10)
[2025-06-20 22:45:37,872] INFO authentication webauthn_register_begin:139 - Generating registration options...
[2025-06-20 22:45:37,872] INFO authentication webauthn_register_begin:140 - RP Name: Secure Dashboard
[2025-06-20 22:45:37,872] INFO authentication webauthn_register_begin:141 - RP ID: localhost
[2025-06-20 22:45:37,872] INFO authentication webauthn_register_begin:142 - User ID (bytes): b'new9'
[2025-06-20 22:45:37,873] INFO authentication webauthn_register_begin:155 - Registration options generated successfully
[2025-06-20 22:45:37,873] INFO authentication webauthn_register_begin:156 - Challenge (base64): 7b2ZlgwsMO3FO5I5ZUbJEoLS2lxqJxzLDeDpY0gdJS37aG9T/h4jFhrKK3aBfDjqugqhQIFv3204KbhaKSLfnQ==
[2025-06-20 22:45:37,873] INFO authentication webauthn_register_begin:157 - Challenge length: 64 bytes
[2025-06-20 22:45:37,873] INFO authentication webauthn_register_begin:167 - Challenge stored with ID: 0a44b568-9cbd-4a98-80a1-4e9cc5ffe69d
[2025-06-20 22:45:37,874] INFO authentication webauthn_register_begin:168 - Total challenges in memory: 3
[2025-06-20 22:45:37,874] INFO authentication webauthn_register_begin:205 - Registration options converted to dictionary
[2025-06-20 22:45:37,874] INFO authentication webauthn_register_begin:206 - Options dict keys: ['challenge', 'rp', 'user', 'pubKeyCredParams', 'timeout', 'excludeCredentials', 'authenticatorSelection', 'attestation']
[2025-06-20 22:45:37,874] INFO authentication webauthn_register_begin:207 - User ID in options: bmV3OQ==
[2025-06-20 22:45:37,875] INFO authentication webauthn_register_begin:208 - Challenge in options: 7b2ZlgwsMO3FO5I5ZUbJEoLS2lxqJxzLDeDpY0gdJS37aG9T/h4jFhrKK3aBfDjqugqhQIFv3204KbhaKSLfnQ==
[2025-06-20 22:45:37,875] INFO authentication webauthn_register_begin:215 - === WebAuthn Registration Begin Complete ===
[2025-06-20 22:45:37,876] INFO authentication webauthn_register_begin:216 - Response data: {'options': {'challenge': '7b2ZlgwsMO3FO5I5ZUbJEoLS2lxqJxzLDeDpY0gdJS37aG9T/h4jFhrKK3aBfDjqugqhQIFv3204KbhaKSLfnQ==', 'rp': {'name': 'Secure Dashboard', 'id': 'localhost'}, 'user': {'id': 'bmV3OQ==', 'name': 'new9', 'displayName': 'new new'}, 'pubKeyCredParams': [{'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_256: -7>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.EDDSA: -8>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_512: -36>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_256: -37>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_384: -38>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_512: -39>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_256: -257>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_384: -258>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_512: -259>}], 'timeout': 60000, 'excludeCredentials': [], 'authenticatorSelection': {'authenticatorAttachment': None, 'requireResidentKey': False, 'residentKey': None, 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>}, 'attestation': <AttestationConveyancePreference.NONE: 'none'>}, 'challenge_id': '0a44b568-9cbd-4a98-80a1-4e9cc5ffe69d'}
[2025-06-20 22:45:58,856] INFO authentication webauthn_register_complete:237 - === WebAuthn Registration Complete ===
[2025-06-20 22:45:58,856] INFO authentication webauthn_register_complete:238 - Request data: {'username': 'new9', 'challenge_id': '0a44b568-9cbd-4a98-80a1-4e9cc5ffe69d', 'credential_id': 'S0h/J4e0JUC/vAoorffXNw==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEEtIfyeHtCVAv7wKKK331zelAQIDJiABIVggDSI2ay6Jot3QygD22kTLGHNOBBqEXkoNAc3RJDBz93oiWCDk+cxpv9xii8nuKdgEVPpBlltNOkIh2dfl6sddfeOirA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoiN2IyWmxnd3NNTzNGTzVJNVpVYkpFb0xTMmx4cUp4ekxEZURwWTBnZEpTMzdhRzlUX2g0akZocktLM2FCZkRqcXVncWhRSUZ2MzIwNEtiaGFLU0xmblEiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'transports': [], 'backup_eligible': True, 'backup_state': False}
[2025-06-20 22:45:58,856] INFO authentication webauthn_register_complete:239 - Request data type: <class 'dict'>
[2025-06-20 22:45:58,856] INFO authentication webauthn_register_complete:240 - Request data keys: ['username', 'challenge_id', 'credential_id', 'attestation_object', 'client_data_json', 'transports', 'backup_eligible', 'backup_state']
[2025-06-20 22:45:58,857] INFO authentication webauthn_register_complete:244 - Field 'username': type=<class 'str'>, length=4
[2025-06-20 22:45:58,857] INFO authentication webauthn_register_complete:244 - Field 'challenge_id': type=<class 'str'>, length=36
[2025-06-20 22:45:58,857] INFO authentication webauthn_register_complete:244 - Field 'credential_id': type=<class 'str'>, length=24
[2025-06-20 22:45:58,857] INFO authentication webauthn_register_complete:246 -   Value: S0h/J4e0JUC/vAoorffXNw==
[2025-06-20 22:45:58,857] INFO authentication webauthn_register_complete:248 -   Contains padding: True
[2025-06-20 22:45:58,859] INFO authentication webauthn_register_complete:249 -   Valid base64 length: True
[2025-06-20 22:45:58,859] INFO authentication webauthn_register_complete:244 - Field 'attestation_object': type=<class 'str'>, length=240
[2025-06-20 22:45:58,859] INFO authentication webauthn_register_complete:246 -   Value: o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEEtIfyeHtCVAv7wKKK331zelAQIDJiABIVggDSI2ay6Jot3QygD22kTLGHNOBBqEXkoNAc3RJDBz93oiWCDk+cxpv9xii8nuKdgEVPpBlltNOkIh2dfl6sddfeOirA==
[2025-06-20 22:45:58,859] INFO authentication webauthn_register_complete:248 -   Contains padding: True
[2025-06-20 22:45:58,859] INFO authentication webauthn_register_complete:249 -   Valid base64 length: True
[2025-06-20 22:45:58,859] INFO authentication webauthn_register_complete:244 - Field 'client_data_json': type=<class 'str'>, length=240
[2025-06-20 22:45:58,860] INFO authentication webauthn_register_complete:246 -   Value: eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoiN2IyWmxnd3NNTzNGTzVJNVpVYkpFb0xTMmx4cUp4ekxEZURwWTBnZEpTMzdhRzlUX2g0akZocktLM2FCZkRqcXVncWhRSUZ2MzIwNEtiaGFLU0xmblEiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9
[2025-06-20 22:45:58,860] INFO authentication webauthn_register_complete:248 -   Contains padding: False
[2025-06-20 22:45:58,860] INFO authentication webauthn_register_complete:249 -   Valid base64 length: True
[2025-06-20 22:45:58,860] INFO authentication webauthn_register_complete:244 - Field 'transports': type=<class 'list'>, length=0
[2025-06-20 22:45:58,860] INFO authentication webauthn_register_complete:244 - Field 'backup_eligible': type=<class 'bool'>, length=4
[2025-06-20 22:45:58,861] INFO authentication webauthn_register_complete:244 - Field 'backup_state': type=<class 'bool'>, length=0
[2025-06-20 22:45:58,862] INFO authentication webauthn_register_complete:256 - Serializer validated successfully
[2025-06-20 22:45:58,862] INFO authentication webauthn_register_complete:257 - Validated data: {'username': 'new9', 'credential_id': 'S0h/J4e0JUC/vAoorffXNw==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEEtIfyeHtCVAv7wKKK331zelAQIDJiABIVggDSI2ay6Jot3QygD22kTLGHNOBBqEXkoNAc3RJDBz93oiWCDk+cxpv9xii8nuKdgEVPpBlltNOkIh2dfl6sddfeOirA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoiN2IyWmxnd3NNTzNGTzVJNVpVYkpFb0xTMmx4cUp4ekxEZURwWTBnZEpTMzdhRzlUX2g0akZocktLM2FCZkRqcXVncWhRSUZ2MzIwNEtiaGFLU0xmblEiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'transports': [], 'backup_eligible': True, 'backup_state': False}
[2025-06-20 22:45:58,862] INFO authentication webauthn_register_complete:260 - Challenge ID from request: 0a44b568-9cbd-4a98-80a1-4e9cc5ffe69d
[2025-06-20 22:45:58,862] INFO authentication webauthn_register_complete:271 - Retrieved stored challenge data:
[2025-06-20 22:45:58,862] INFO authentication webauthn_register_complete:272 -   - Challenge: 7b2ZlgwsMO3FO5I5ZUbJEoLS2lxqJxzLDeDpY0gdJS37aG9T/h4jFhrKK3aBfDjqugqhQIFv3204KbhaKSLfnQ==
[2025-06-20 22:45:58,863] INFO authentication webauthn_register_complete:273 -   - Username: new9
[2025-06-20 22:45:58,863] INFO authentication webauthn_register_complete:274 -   - Type: registration
[2025-06-20 22:45:58,865] INFO authentication webauthn_register_complete:278 - User found: new9 (ID: 10)
[2025-06-20 22:45:58,865] INFO authentication webauthn_register_complete:284 - Starting verification for user: new9
[2025-06-20 22:45:58,866] INFO authentication webauthn_register_complete:285 - Challenge: 7b2ZlgwsMO3FO5I5ZUbJEoLS2lxqJxzLDeDpY0gdJS37aG9T/h4jFhrKK3aBfDjqugqhQIFv3204KbhaKSLfnQ==
[2025-06-20 22:45:58,866] INFO authentication webauthn_register_complete:286 - RP ID: localhost
[2025-06-20 22:45:58,866] INFO authentication webauthn_register_complete:287 - Origin: http://localhost:5173
[2025-06-20 22:45:58,866] INFO authentication webauthn_register_complete:290 - Original credential_id: S0h/J4e0JUC/vAoorffXNw==
[2025-06-20 22:45:58,867] INFO authentication webauthn_register_complete:291 - Credential_id length: 24
[2025-06-20 22:45:58,867] INFO authentication webauthn_register_complete:292 - Credential_id contains padding: True
[2025-06-20 22:45:58,867] INFO authentication webauthn_register_complete:293 - Credential_id is valid base64: True
[2025-06-20 22:45:58,867] INFO authentication webauthn_register_complete:302 - Decoded raw_id length: 16 bytes
[2025-06-20 22:45:58,867] INFO authentication webauthn_register_complete:303 - Raw_id (hex): 4b487f2787b42540bfbc0a28adf7d737
[2025-06-20 22:45:58,867] INFO authentication webauthn_register_complete:307 - Re-encoded credential_id: S0h_J4e0JUC_vAoorffXNw
[2025-06-20 22:45:58,867] INFO authentication webauthn_register_complete:308 - Original vs re-encoded match: False
[2025-06-20 22:45:58,868] INFO authentication webauthn_register_complete:312 - Standard base64 encoded: S0h/J4e0JUC/vAoorffXNw==
[2025-06-20 22:45:58,868] INFO authentication webauthn_register_complete:313 - Original vs standard base64 match: True
[2025-06-20 22:45:58,868] INFO authentication webauthn_register_complete:318 - Attestation object length: 178 bytes
[2025-06-20 22:45:58,868] INFO authentication webauthn_register_complete:319 - Client data JSON length: 180 bytes
[2025-06-20 22:45:58,868] INFO authentication webauthn_register_complete:320 - Client data JSON content: {"type":"webauthn.create","challenge":"7b2ZlgwsMO3FO5I5ZUbJEoLS2lxqJxzLDeDpY0gdJS37aG9T_h4jFhrKK3aBfDjqugqhQIFv3204KbhaKSLfnQ","origin":"http://localhost:5173","crossOrigin":false}
[2025-06-20 22:45:58,870] INFO authentication webauthn_register_complete:326 - AuthenticatorAttestationResponse created successfully
[2025-06-20 22:45:58,870] INFO authentication webauthn_register_complete:331 - Converted credential_id to base64url: S0h_J4e0JUC_vAoorffXNw
[2025-06-20 22:45:58,870] INFO authentication webauthn_register_complete:332 - Original vs base64url match: False
[2025-06-20 22:45:58,870] INFO authentication webauthn_register_complete:340 - RegistrationCredential created successfully
[2025-06-20 22:45:58,870] INFO authentication webauthn_register_complete:341 - Credential ID type: <class 'str'>
[2025-06-20 22:45:58,871] INFO authentication webauthn_register_complete:342 - Credential ID value: S0h_J4e0JUC_vAoorffXNw
[2025-06-20 22:45:58,871] INFO authentication webauthn_register_complete:343 - Credential raw_id type: <class 'bytes'>
[2025-06-20 22:45:58,871] INFO authentication webauthn_register_complete:344 - Credential raw_id length: 16 bytes
[2025-06-20 22:45:58,871] INFO authentication webauthn_register_complete:345 - Credential raw_id (hex): 4b487f2787b42540bfbc0a28adf7d737
[2025-06-20 22:45:58,871] INFO authentication webauthn_register_complete:346 - Credential type: public-key
[2025-06-20 22:45:58,871] INFO authentication webauthn_register_complete:350 - Base64url encoding of raw_id: S0h_J4e0JUC_vAoorffXNw
[2025-06-20 22:45:58,872] INFO authentication webauthn_register_complete:351 - ID and base64url(raw_id) match: True
[2025-06-20 22:45:58,872] INFO authentication webauthn_register_complete:352 - ID and raw_id have correct types: True
[2025-06-20 22:45:58,872] INFO authentication webauthn_register_complete:354 - Starting verification with webauthn library...
[2025-06-20 22:45:58,876] INFO authentication webauthn_register_complete:362 - === Verification Successful ===
[2025-06-20 22:45:58,876] INFO authentication webauthn_register_complete:363 - Verification object: VerifiedRegistration(credential_id=b"KH\x7f'\x87\xb4%@\xbf\xbc\n(\xad\xf7\xd77", credential_public_key=b'\xa5\x01\x02\x03& \x01!X \r"6k.\x89\xa2\xdd\xd0\xca\x00\xf6\xdaD\xcb\x18sN\x04\x1a\x84^J\r\x01\xcd\xd1$0s\xf7z"X \xe4\xf9\xcci\xbf\xdcb\x8b\xc9\xee)\xd8\x04T\xfaA\x96[M:B!\xd9\xd7\xe5\xea\xc7]}\xe3\xa2\xac', sign_count=0, aaguid='00000000-0000-0000-0000-000000000000', fmt='none', credential_type='public-key', user_verified=True, attestation_object=b'\xa3cfmtdnonegattStmt\xa0hauthDataX\x94I\x96\r\xe5\x88\x0e\x8cht4\x17\x0fdv`[\x8f\xe4\xae\xb9\xa2\x862\xc7\x99\\\xf3\xba\x83\x1d\x97c]\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10KH\x7f\'\x87\xb4%@\xbf\xbc\n(\xad\xf7\xd77\xa5\x01\x02\x03& \x01!X \r"6k.\x89\xa2\xdd\xd0\xca\x00\xf6\xdaD\xcb\x18sN\x04\x1a\x84^J\r\x01\xcd\xd1$0s\xf7z"X \xe4\xf9\xcci\xbf\xdcb\x8b\xc9\xee)\xd8\x04T\xfaA\x96[M:B!\xd9\xd7\xe5\xea\xc7]}\xe3\xa2\xac', credential_device_type=<CredentialDeviceType.MULTI_DEVICE: 'multi_device'>, credential_backed_up=True)
[2025-06-20 22:45:58,877] INFO authentication webauthn_register_complete:364 - Sign count: 0
[2025-06-20 22:45:58,877] INFO authentication webauthn_register_complete:365 - Credential public key length: 77 bytes
[2025-06-20 22:45:58,877] INFO authentication webauthn_register_complete:366 - Credential public key (base64): pQECAyYgASFYIA0iNmsuiaLd0MoA9tpEyxhzTgQahF5KDQHN0SQwc/d6Ilgg5PnMab/cYovJ7inYBFT6QZZbTTpCIdnX5erHXX3joqw=
[2025-06-20 22:45:58,888] INFO authentication webauthn_register_complete:378 - WebAuthnCredential saved to database:
[2025-06-20 22:45:58,889] INFO authentication webauthn_register_complete:379 -   - ID: 1
[2025-06-20 22:45:58,889] INFO authentication webauthn_register_complete:380 -   - User: new9
[2025-06-20 22:45:58,889] INFO authentication webauthn_register_complete:381 -   - Credential ID: S0h/J4e0JUC/vAoorffXNw==
[2025-06-20 22:45:58,889] INFO authentication webauthn_register_complete:382 -   - Sign count: 0
[2025-06-20 22:45:58,889] INFO authentication webauthn_register_complete:383 -   - Transports: []
[2025-06-20 22:45:58,889] INFO authentication webauthn_register_complete:386 - Challenge 0a44b568-9cbd-4a98-80a1-4e9cc5ffe69d removed from memory
[2025-06-20 22:45:58,890] INFO authentication webauthn_register_complete:387 - Remaining challenges: 2
[2025-06-20 22:45:58,890] ERROR authentication webauthn_register_complete:401 - Registration verification failed: name 'WebAuthnCredentialSerializer' is not defined
[2025-06-20 22:45:58,890] ERROR authentication webauthn_register_complete:402 - Exception type: NameError
[2025-06-20 22:45:58,893] ERROR authentication webauthn_register_complete:403 - Traceback: Traceback (most recent call last):
  File "C:\Users\fazi\Desktop\machine task\secure-dashboard\backend\authentication\views.py", line 391, in webauthn_register_complete
    'credential': WebAuthnCredentialSerializer(credential_obj).data
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'WebAuthnCredentialSerializer' is not defined

[2025-06-20 22:47:19,044] INFO authentication webauthn_register_begin:115 - === WebAuthn Registration Begin ===
[2025-06-20 22:47:19,044] INFO authentication webauthn_register_begin:116 - Request data: {'username': 'new9', 'display_name': 'new new'}
[2025-06-20 22:47:19,045] INFO authentication webauthn_register_begin:126 - Processing registration for user: new9, display_name: new new
[2025-06-20 22:47:19,047] INFO authentication webauthn_register_begin:132 - User found: new9 (ID: 10)
[2025-06-20 22:47:19,047] INFO authentication webauthn_register_begin:140 - Generating registration options...
[2025-06-20 22:47:19,048] INFO authentication webauthn_register_begin:141 - RP Name: Secure Dashboard
[2025-06-20 22:47:19,048] INFO authentication webauthn_register_begin:142 - RP ID: localhost
[2025-06-20 22:47:19,048] INFO authentication webauthn_register_begin:143 - User ID (bytes): b'new9'
[2025-06-20 22:47:19,048] INFO authentication webauthn_register_begin:156 - Registration options generated successfully
[2025-06-20 22:47:19,048] INFO authentication webauthn_register_begin:157 - Challenge (base64): bORj5vAGOeId0QR1dESCnhZcwVjY6AU8gP45wE7Uk98oK4RH5MGKD1t6uTInCdSQeczEysirVKj4DfFPMUoH/g==
[2025-06-20 22:47:19,049] INFO authentication webauthn_register_begin:158 - Challenge length: 64 bytes
[2025-06-20 22:47:19,049] INFO authentication webauthn_register_begin:168 - Challenge stored with ID: 320f362e-082d-4d1e-a2fc-b6476ae417b7
[2025-06-20 22:47:19,049] INFO authentication webauthn_register_begin:169 - Total challenges in memory: 1
[2025-06-20 22:47:19,049] INFO authentication webauthn_register_begin:206 - Registration options converted to dictionary
[2025-06-20 22:47:19,049] INFO authentication webauthn_register_begin:207 - Options dict keys: ['challenge', 'rp', 'user', 'pubKeyCredParams', 'timeout', 'excludeCredentials', 'authenticatorSelection', 'attestation']
[2025-06-20 22:47:19,049] INFO authentication webauthn_register_begin:208 - User ID in options: bmV3OQ==
[2025-06-20 22:47:19,050] INFO authentication webauthn_register_begin:209 - Challenge in options: bORj5vAGOeId0QR1dESCnhZcwVjY6AU8gP45wE7Uk98oK4RH5MGKD1t6uTInCdSQeczEysirVKj4DfFPMUoH/g==
[2025-06-20 22:47:19,050] INFO authentication webauthn_register_begin:216 - === WebAuthn Registration Begin Complete ===
[2025-06-20 22:47:19,050] INFO authentication webauthn_register_begin:217 - Response data: {'options': {'challenge': 'bORj5vAGOeId0QR1dESCnhZcwVjY6AU8gP45wE7Uk98oK4RH5MGKD1t6uTInCdSQeczEysirVKj4DfFPMUoH/g==', 'rp': {'name': 'Secure Dashboard', 'id': 'localhost'}, 'user': {'id': 'bmV3OQ==', 'name': 'new9', 'displayName': 'new new'}, 'pubKeyCredParams': [{'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_256: -7>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.EDDSA: -8>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_512: -36>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_256: -37>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_384: -38>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_512: -39>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_256: -257>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_384: -258>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_512: -259>}], 'timeout': 60000, 'excludeCredentials': [], 'authenticatorSelection': {'authenticatorAttachment': None, 'requireResidentKey': False, 'residentKey': None, 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>}, 'attestation': <AttestationConveyancePreference.NONE: 'none'>}, 'challenge_id': '320f362e-082d-4d1e-a2fc-b6476ae417b7'}
[2025-06-20 22:47:39,949] INFO authentication webauthn_register_complete:238 - === WebAuthn Registration Complete ===
[2025-06-20 22:47:39,949] INFO authentication webauthn_register_complete:239 - Request data: {'username': 'new9', 'challenge_id': '320f362e-082d-4d1e-a2fc-b6476ae417b7', 'credential_id': 'GDehNH+TK/Rukq5v5Fi46A==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBg3oTR/kyv0bpKub+RYuOilAQIDJiABIVggzOsu8PPZFohfSiwO5WrH5HrGys1BKK1QgKZmmaodGxIiWCByXAInruLJBG02Sz163gwsE5NsS1M+Q7mAC1VIr7L9sA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoiYk9SajV2QUdPZUlkMFFSMWRFU0NuaFpjd1ZqWTZBVThnUDQ1d0U3VWs5OG9LNFJINU1HS0QxdDZ1VEluQ2RTUWVjekV5c2lyVktqNERmRlBNVW9IX2ciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2UsIm90aGVyX2tleXNfY2FuX2JlX2FkZGVkX2hlcmUiOiJkbyBub3QgY29tcGFyZSBjbGllbnREYXRhSlNPTiBhZ2FpbnN0IGEgdGVtcGxhdGUuIFNlZSBodHRwczovL2dvby5nbC95YWJQZXgifQ==', 'transports': [], 'backup_eligible': True, 'backup_state': False}
[2025-06-20 22:47:39,949] INFO authentication webauthn_register_complete:240 - Request data type: <class 'dict'>
[2025-06-20 22:47:39,949] INFO authentication webauthn_register_complete:241 - Request data keys: ['username', 'challenge_id', 'credential_id', 'attestation_object', 'client_data_json', 'transports', 'backup_eligible', 'backup_state']
[2025-06-20 22:47:39,951] INFO authentication webauthn_register_complete:245 - Field 'username': type=<class 'str'>, length=4
[2025-06-20 22:47:39,951] INFO authentication webauthn_register_complete:245 - Field 'challenge_id': type=<class 'str'>, length=36
[2025-06-20 22:47:39,951] INFO authentication webauthn_register_complete:245 - Field 'credential_id': type=<class 'str'>, length=24
[2025-06-20 22:47:39,951] INFO authentication webauthn_register_complete:247 -   Value: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 22:47:39,951] INFO authentication webauthn_register_complete:249 -   Contains padding: True
[2025-06-20 22:47:39,951] INFO authentication webauthn_register_complete:250 -   Valid base64 length: True
[2025-06-20 22:47:39,951] INFO authentication webauthn_register_complete:245 - Field 'attestation_object': type=<class 'str'>, length=240
[2025-06-20 22:47:39,953] INFO authentication webauthn_register_complete:247 -   Value: o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBg3oTR/kyv0bpKub+RYuOilAQIDJiABIVggzOsu8PPZFohfSiwO5WrH5HrGys1BKK1QgKZmmaodGxIiWCByXAInruLJBG02Sz163gwsE5NsS1M+Q7mAC1VIr7L9sA==
[2025-06-20 22:47:39,953] INFO authentication webauthn_register_complete:249 -   Contains padding: True
[2025-06-20 22:47:39,953] INFO authentication webauthn_register_complete:250 -   Valid base64 length: True
[2025-06-20 22:47:39,953] INFO authentication webauthn_register_complete:245 - Field 'client_data_json': type=<class 'str'>, length=388
[2025-06-20 22:47:39,953] INFO authentication webauthn_register_complete:247 -   Value: eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoiYk9SajV2QUdPZUlkMFFSMWRFU0NuaFpjd1ZqWTZBVThnUDQ1d0U3VWs5OG9LNFJINU1HS0QxdDZ1VEluQ2RTUWVjekV5c2lyVktqNERmRlBNVW9IX2ciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2UsIm90aGVyX2tleXNfY2FuX2JlX2FkZGVkX2hlcmUiOiJkbyBub3QgY29tcGFyZSBjbGllbnREYXRhSlNPTiBhZ2FpbnN0IGEgdGVtcGxhdGUuIFNlZSBodHRwczovL2dvby5nbC95YWJQZXgifQ==
[2025-06-20 22:47:39,953] INFO authentication webauthn_register_complete:249 -   Contains padding: True
[2025-06-20 22:47:39,953] INFO authentication webauthn_register_complete:250 -   Valid base64 length: True
[2025-06-20 22:47:39,953] INFO authentication webauthn_register_complete:245 - Field 'transports': type=<class 'list'>, length=0
[2025-06-20 22:47:39,953] INFO authentication webauthn_register_complete:245 - Field 'backup_eligible': type=<class 'bool'>, length=4
[2025-06-20 22:47:39,953] INFO authentication webauthn_register_complete:245 - Field 'backup_state': type=<class 'bool'>, length=0
[2025-06-20 22:47:39,954] INFO authentication webauthn_register_complete:257 - Serializer validated successfully
[2025-06-20 22:47:39,954] INFO authentication webauthn_register_complete:258 - Validated data: {'username': 'new9', 'credential_id': 'GDehNH+TK/Rukq5v5Fi46A==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBg3oTR/kyv0bpKub+RYuOilAQIDJiABIVggzOsu8PPZFohfSiwO5WrH5HrGys1BKK1QgKZmmaodGxIiWCByXAInruLJBG02Sz163gwsE5NsS1M+Q7mAC1VIr7L9sA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoiYk9SajV2QUdPZUlkMFFSMWRFU0NuaFpjd1ZqWTZBVThnUDQ1d0U3VWs5OG9LNFJINU1HS0QxdDZ1VEluQ2RTUWVjekV5c2lyVktqNERmRlBNVW9IX2ciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2UsIm90aGVyX2tleXNfY2FuX2JlX2FkZGVkX2hlcmUiOiJkbyBub3QgY29tcGFyZSBjbGllbnREYXRhSlNPTiBhZ2FpbnN0IGEgdGVtcGxhdGUuIFNlZSBodHRwczovL2dvby5nbC95YWJQZXgifQ==', 'transports': [], 'backup_eligible': True, 'backup_state': False}
[2025-06-20 22:47:39,954] INFO authentication webauthn_register_complete:261 - Challenge ID from request: 320f362e-082d-4d1e-a2fc-b6476ae417b7
[2025-06-20 22:47:39,955] INFO authentication webauthn_register_complete:272 - Retrieved stored challenge data:
[2025-06-20 22:47:39,955] INFO authentication webauthn_register_complete:273 -   - Challenge: bORj5vAGOeId0QR1dESCnhZcwVjY6AU8gP45wE7Uk98oK4RH5MGKD1t6uTInCdSQeczEysirVKj4DfFPMUoH/g==
[2025-06-20 22:47:39,955] INFO authentication webauthn_register_complete:274 -   - Username: new9
[2025-06-20 22:47:39,955] INFO authentication webauthn_register_complete:275 -   - Type: registration
[2025-06-20 22:47:39,958] INFO authentication webauthn_register_complete:279 - User found: new9 (ID: 10)
[2025-06-20 22:47:39,958] INFO authentication webauthn_register_complete:285 - Starting verification for user: new9
[2025-06-20 22:47:39,958] INFO authentication webauthn_register_complete:286 - Challenge: bORj5vAGOeId0QR1dESCnhZcwVjY6AU8gP45wE7Uk98oK4RH5MGKD1t6uTInCdSQeczEysirVKj4DfFPMUoH/g==
[2025-06-20 22:47:39,959] INFO authentication webauthn_register_complete:287 - RP ID: localhost
[2025-06-20 22:47:39,959] INFO authentication webauthn_register_complete:288 - Origin: http://localhost:5173
[2025-06-20 22:47:39,959] INFO authentication webauthn_register_complete:291 - Original credential_id: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 22:47:39,959] INFO authentication webauthn_register_complete:292 - Credential_id length: 24
[2025-06-20 22:47:39,959] INFO authentication webauthn_register_complete:293 - Credential_id contains padding: True
[2025-06-20 22:47:39,959] INFO authentication webauthn_register_complete:294 - Credential_id is valid base64: True
[2025-06-20 22:47:39,960] INFO authentication webauthn_register_complete:303 - Decoded raw_id length: 16 bytes
[2025-06-20 22:47:39,960] INFO authentication webauthn_register_complete:304 - Raw_id (hex): 1837a1347f932bf46e92ae6fe458b8e8
[2025-06-20 22:47:39,960] INFO authentication webauthn_register_complete:308 - Re-encoded credential_id: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 22:47:39,960] INFO authentication webauthn_register_complete:309 - Original vs re-encoded match: False
[2025-06-20 22:47:39,960] INFO authentication webauthn_register_complete:313 - Standard base64 encoded: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 22:47:39,961] INFO authentication webauthn_register_complete:314 - Original vs standard base64 match: True
[2025-06-20 22:47:39,961] INFO authentication webauthn_register_complete:319 - Attestation object length: 178 bytes
[2025-06-20 22:47:39,961] INFO authentication webauthn_register_complete:320 - Client data JSON length: 289 bytes
[2025-06-20 22:47:39,961] INFO authentication webauthn_register_complete:321 - Client data JSON content: {"type":"webauthn.create","challenge":"bORj5vAGOeId0QR1dESCnhZcwVjY6AU8gP45wE7Uk98oK4RH5MGKD1t6uTInCdSQeczEysirVKj4DfFPMUoH_g","origin":"http://localhost:5173","crossOrigin":false,"other_keys_can_be_added_here":"do not compare clientDataJSON against a template. See https://goo.gl/yabPex"}
[2025-06-20 22:47:39,961] INFO authentication webauthn_register_complete:327 - AuthenticatorAttestationResponse created successfully
[2025-06-20 22:47:39,961] INFO authentication webauthn_register_complete:332 - Converted credential_id to base64url: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 22:47:39,962] INFO authentication webauthn_register_complete:333 - Original vs base64url match: False
[2025-06-20 22:47:39,962] INFO authentication webauthn_register_complete:341 - RegistrationCredential created successfully
[2025-06-20 22:47:39,962] INFO authentication webauthn_register_complete:342 - Credential ID type: <class 'str'>
[2025-06-20 22:47:39,962] INFO authentication webauthn_register_complete:343 - Credential ID value: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 22:47:39,962] INFO authentication webauthn_register_complete:344 - Credential raw_id type: <class 'bytes'>
[2025-06-20 22:47:39,962] INFO authentication webauthn_register_complete:345 - Credential raw_id length: 16 bytes
[2025-06-20 22:47:39,963] INFO authentication webauthn_register_complete:346 - Credential raw_id (hex): 1837a1347f932bf46e92ae6fe458b8e8
[2025-06-20 22:47:39,963] INFO authentication webauthn_register_complete:347 - Credential type: public-key
[2025-06-20 22:47:39,963] INFO authentication webauthn_register_complete:351 - Base64url encoding of raw_id: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 22:47:39,963] INFO authentication webauthn_register_complete:352 - ID and base64url(raw_id) match: True
[2025-06-20 22:47:39,963] INFO authentication webauthn_register_complete:353 - ID and raw_id have correct types: True
[2025-06-20 22:47:39,963] INFO authentication webauthn_register_complete:355 - Starting verification with webauthn library...
[2025-06-20 22:47:39,966] INFO authentication webauthn_register_complete:363 - === Verification Successful ===
[2025-06-20 22:47:39,966] INFO authentication webauthn_register_complete:364 - Verification object: VerifiedRegistration(credential_id=b'\x187\xa14\x7f\x93+\xf4n\x92\xaeo\xe4X\xb8\xe8', credential_public_key=b'\xa5\x01\x02\x03& \x01!X \xcc\xeb.\xf0\xf3\xd9\x16\x88_J,\x0e\xe5j\xc7\xe4z\xc6\xca\xcdA(\xadP\x80\xa6f\x99\xaa\x1d\x1b\x12"X r\\\x02\'\xae\xe2\xc9\x04m6K=z\xde\x0c,\x13\x93lKS>C\xb9\x80\x0bUH\xaf\xb2\xfd\xb0', sign_count=0, aaguid='00000000-0000-0000-0000-000000000000', fmt='none', credential_type='public-key', user_verified=True, attestation_object=b'\xa3cfmtdnonegattStmt\xa0hauthDataX\x94I\x96\r\xe5\x88\x0e\x8cht4\x17\x0fdv`[\x8f\xe4\xae\xb9\xa2\x862\xc7\x99\\\xf3\xba\x83\x1d\x97c]\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x187\xa14\x7f\x93+\xf4n\x92\xaeo\xe4X\xb8\xe8\xa5\x01\x02\x03& \x01!X \xcc\xeb.\xf0\xf3\xd9\x16\x88_J,\x0e\xe5j\xc7\xe4z\xc6\xca\xcdA(\xadP\x80\xa6f\x99\xaa\x1d\x1b\x12"X r\\\x02\'\xae\xe2\xc9\x04m6K=z\xde\x0c,\x13\x93lKS>C\xb9\x80\x0bUH\xaf\xb2\xfd\xb0', credential_device_type=<CredentialDeviceType.MULTI_DEVICE: 'multi_device'>, credential_backed_up=True)
[2025-06-20 22:47:39,966] INFO authentication webauthn_register_complete:365 - Sign count: 0
[2025-06-20 22:47:39,966] INFO authentication webauthn_register_complete:366 - Credential public key length: 77 bytes
[2025-06-20 22:47:39,966] INFO authentication webauthn_register_complete:367 - Credential public key (base64): pQECAyYgASFYIMzrLvDz2RaIX0osDuVqx+R6xsrNQSitUICmZpmqHRsSIlggclwCJ67iyQRtNks9et4MLBOTbEtTPkO5gAtVSK+y/bA=
[2025-06-20 22:47:39,972] INFO authentication webauthn_register_complete:379 - WebAuthnCredential saved to database:
[2025-06-20 22:47:39,972] INFO authentication webauthn_register_complete:380 -   - ID: 2
[2025-06-20 22:47:39,972] INFO authentication webauthn_register_complete:381 -   - User: new9
[2025-06-20 22:47:39,973] INFO authentication webauthn_register_complete:382 -   - Credential ID: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 22:47:39,973] INFO authentication webauthn_register_complete:383 -   - Sign count: 0
[2025-06-20 22:47:39,973] INFO authentication webauthn_register_complete:384 -   - Transports: []
[2025-06-20 22:47:39,973] INFO authentication webauthn_register_complete:387 - Challenge 320f362e-082d-4d1e-a2fc-b6476ae417b7 removed from memory
[2025-06-20 22:47:39,973] INFO authentication webauthn_register_complete:388 - Remaining challenges: 0
[2025-06-20 22:47:39,980] INFO authentication webauthn_register_complete:395 - === WebAuthn Registration Complete Success ===
[2025-06-20 22:47:39,980] INFO authentication webauthn_register_complete:396 - Response data: {'message': 'WebAuthn credential registered successfully', 'credential': {'id': 2, 'credential_id': 'GDehNH+TK/Rukq5v5Fi46A==', 'sign_count': 0, 'transports': [], 'backup_eligible': True, 'backup_state': False, 'created_at': '2025-06-20T17:17:39.967555Z', 'last_used_at': None}}
[2025-06-20 22:49:13,307] INFO authentication webauthn_authenticate_begin:416 - === WebAuthn Authentication Begin ===
[2025-06-20 22:49:13,308] INFO authentication webauthn_authenticate_begin:417 - Request data: {'username': 'new9'}
[2025-06-20 22:49:13,308] INFO authentication webauthn_authenticate_begin:425 - Processing authentication for user: new9
[2025-06-20 22:49:13,311] INFO authentication webauthn_authenticate_begin:430 - User found: new9 (ID: 10)
[2025-06-20 22:49:13,314] INFO authentication webauthn_authenticate_begin:439 - Found 2 credentials for user new9
[2025-06-20 22:49:13,317] INFO authentication webauthn_authenticate_begin:455 - Added credential: GDehNH+TK/Rukq5v5Fi46A== (transports: [])
[2025-06-20 22:49:13,317] INFO authentication webauthn_authenticate_begin:455 - Added credential: S0h/J4e0JUC/vAoorffXNw== (transports: [])
[2025-06-20 22:49:13,317] INFO authentication webauthn_authenticate_begin:457 - Generating authentication options...
[2025-06-20 22:49:13,317] INFO authentication webauthn_authenticate_begin:458 - RP ID: localhost
[2025-06-20 22:49:13,318] INFO authentication webauthn_authenticate_begin:459 - Allow credentials count: 2
[2025-06-20 22:49:13,318] INFO authentication webauthn_authenticate_begin:467 - Authentication options generated successfully
[2025-06-20 22:49:13,318] INFO authentication webauthn_authenticate_begin:468 - Challenge (base64): R9lHNqQLrwHqRkqwduPSgOwqRSttmEIyCPsd/1hk3RQvMujnZfRPHldB/LDv/iv4xhYPOMtzSgiUNIxEon9mXg==
[2025-06-20 22:49:13,318] INFO authentication webauthn_authenticate_begin:469 - Challenge length: 64 bytes
[2025-06-20 22:49:13,318] INFO authentication webauthn_authenticate_begin:479 - Challenge stored with ID: 3498a315-4135-4479-a183-13b0f5ec715c
[2025-06-20 22:49:13,318] INFO authentication webauthn_authenticate_begin:480 - Total challenges in memory: 1
[2025-06-20 23:08:20,443] INFO authentication webauthn_authenticate_begin:491 - === WebAuthn Authentication Begin ===
[2025-06-20 23:08:20,444] INFO authentication webauthn_authenticate_begin:492 - Request data: {'username': 'new9'}
[2025-06-20 23:08:20,444] INFO authentication webauthn_authenticate_begin:511 - Processing authentication for user: new9
[2025-06-20 23:08:20,448] INFO authentication webauthn_authenticate_begin:516 - User found: new9 (ID: 10)
[2025-06-20 23:08:20,451] INFO authentication webauthn_authenticate_begin:525 - Found 2 credentials for user new9
[2025-06-20 23:08:20,453] INFO authentication webauthn_authenticate_begin:541 - Added credential: GDehNH+TK/Rukq5v5Fi46A== (transports: [])
[2025-06-20 23:08:20,453] INFO authentication webauthn_authenticate_begin:541 - Added credential: S0h/J4e0JUC/vAoorffXNw== (transports: [])
[2025-06-20 23:08:20,453] INFO authentication webauthn_authenticate_begin:544 - Generating authentication options...
[2025-06-20 23:08:20,453] INFO authentication webauthn_authenticate_begin:545 - RP ID: localhost
[2025-06-20 23:08:20,453] INFO authentication webauthn_authenticate_begin:546 - Allow credentials count: 2
[2025-06-20 23:08:20,454] INFO authentication webauthn_authenticate_begin:554 - Authentication options generated successfully
[2025-06-20 23:08:20,454] INFO authentication webauthn_authenticate_begin:555 - Challenge (base64): w2S7fkcZ6TNgPHkGCbzsEz03J6hPVlFJ/bnT6Z7EydMcHo7fU/nAZzhvIWf6GM7+oUU7oC0ulwjenn0RAQw8yw==
[2025-06-20 23:08:20,454] INFO authentication webauthn_authenticate_begin:557 - Challenge length: 64 bytes
[2025-06-20 23:08:20,454] INFO authentication webauthn_authenticate_begin:568 - Challenge stored with ID: cc47a072-db13-47bc-932e-caca27b5122c
[2025-06-20 23:08:20,454] INFO authentication webauthn_authenticate_begin:569 - Total challenges in memory: 1
[2025-06-20 23:09:11,727] INFO authentication webauthn_authenticate_begin:491 - === WebAuthn Authentication Begin ===
[2025-06-20 23:09:11,727] INFO authentication webauthn_authenticate_begin:492 - Request data: {'username': 'new9'}
[2025-06-20 23:09:11,728] INFO authentication webauthn_authenticate_begin:511 - Processing authentication for user: new9
[2025-06-20 23:09:11,731] INFO authentication webauthn_authenticate_begin:516 - User found: new9 (ID: 10)
[2025-06-20 23:09:11,734] INFO authentication webauthn_authenticate_begin:525 - Found 2 credentials for user new9
[2025-06-20 23:09:11,737] INFO authentication webauthn_authenticate_begin:541 - Added credential: GDehNH+TK/Rukq5v5Fi46A== (transports: [])
[2025-06-20 23:09:11,737] INFO authentication webauthn_authenticate_begin:541 - Added credential: S0h/J4e0JUC/vAoorffXNw== (transports: [])
[2025-06-20 23:09:11,737] INFO authentication webauthn_authenticate_begin:544 - Generating authentication options...
[2025-06-20 23:09:11,737] INFO authentication webauthn_authenticate_begin:545 - RP ID: localhost
[2025-06-20 23:09:11,738] INFO authentication webauthn_authenticate_begin:546 - Allow credentials count: 2
[2025-06-20 23:09:11,738] INFO authentication webauthn_authenticate_begin:554 - Authentication options generated successfully
[2025-06-20 23:09:11,738] INFO authentication webauthn_authenticate_begin:555 - Challenge (base64): yKwfBV3YSDIKAm/o7u4MTJHZT/o/RllOdN1Y+teJ3ReRlxvcpRtwJwKJeUEY4AtpsOFbcK6Qdosl+7hWRs8y9Q==
[2025-06-20 23:09:11,738] INFO authentication webauthn_authenticate_begin:557 - Challenge length: 64 bytes
[2025-06-20 23:09:11,739] INFO authentication webauthn_authenticate_begin:568 - Challenge stored with ID: 06a5c45b-b4ba-4c26-9ad7-e7b99e247c63
[2025-06-20 23:09:11,739] INFO authentication webauthn_authenticate_begin:569 - Total challenges in memory: 1
[2025-06-20 23:14:26,700] INFO authentication webauthn_authenticate_begin:491 - === WebAuthn Authentication Begin ===
[2025-06-20 23:14:26,703] INFO authentication webauthn_authenticate_begin:492 - Request data: {'username': 'new9'}
[2025-06-20 23:14:26,705] INFO authentication webauthn_authenticate_begin:511 - Processing authentication for user: new9
[2025-06-20 23:14:26,710] INFO authentication webauthn_authenticate_begin:516 - User found: new9 (ID: 10)
[2025-06-20 23:14:26,714] INFO authentication webauthn_authenticate_begin:525 - Found 2 credentials for user new9
[2025-06-20 23:14:26,718] INFO authentication webauthn_authenticate_begin:541 - Added credential: GDehNH+TK/Rukq5v5Fi46A== (transports: [])
[2025-06-20 23:14:26,720] INFO authentication webauthn_authenticate_begin:541 - Added credential: S0h/J4e0JUC/vAoorffXNw== (transports: [])
[2025-06-20 23:14:26,720] INFO authentication webauthn_authenticate_begin:544 - Generating authentication options...
[2025-06-20 23:14:26,721] INFO authentication webauthn_authenticate_begin:545 - RP ID: localhost
[2025-06-20 23:14:26,721] INFO authentication webauthn_authenticate_begin:546 - Allow credentials count: 2
[2025-06-20 23:14:26,721] INFO authentication webauthn_authenticate_begin:554 - Authentication options generated successfully
[2025-06-20 23:14:26,722] INFO authentication webauthn_authenticate_begin:555 - Challenge (base64): sVSiuZvKhMZpB2iLOU+dTnVDwU0p9E1yfSU3hEd1K9v9pi12enMrJTcx2+XDm0FHmdM4GgQQDWNReOvvxMu4Yg==
[2025-06-20 23:14:26,722] INFO authentication webauthn_authenticate_begin:557 - Challenge length: 64 bytes
[2025-06-20 23:14:26,722] INFO authentication webauthn_authenticate_begin:568 - Challenge stored with ID: 86f381e8-5927-4ea1-a34c-bab7c32d7690
[2025-06-20 23:14:26,722] INFO authentication webauthn_authenticate_begin:569 - Total challenges in memory: 1

====================================================================================================
[2025-06-20 23:24:43,715] INFO authentication webauthn_authenticate_begin:491 - === WebAuthn Authentication Begin ===
[2025-06-20 23:24:43,715] INFO authentication webauthn_authenticate_begin:492 - Request data: {'username': 'new9'}
[2025-06-20 23:24:43,715] INFO authentication webauthn_authenticate_begin:511 - Processing authentication for user: new9
[2025-06-20 23:24:43,719] INFO authentication webauthn_authenticate_begin:516 - User found: new9 (ID: 10)
[2025-06-20 23:24:43,721] INFO authentication webauthn_authenticate_begin:525 - Found 2 credentials for user new9
[2025-06-20 23:24:43,724] INFO authentication webauthn_authenticate_begin:541 - Added credential: GDehNH+TK/Rukq5v5Fi46A== (transports: [])
[2025-06-20 23:24:43,724] INFO authentication webauthn_authenticate_begin:541 - Added credential: S0h/J4e0JUC/vAoorffXNw== (transports: [])
[2025-06-20 23:24:43,724] INFO authentication webauthn_authenticate_begin:544 - Generating authentication options...
[2025-06-20 23:24:43,724] INFO authentication webauthn_authenticate_begin:545 - RP ID: localhost
[2025-06-20 23:24:43,724] INFO authentication webauthn_authenticate_begin:546 - Allow credentials count: 2
[2025-06-20 23:24:43,724] INFO authentication webauthn_authenticate_begin:554 - Authentication options generated successfully
[2025-06-20 23:24:43,725] INFO authentication webauthn_authenticate_begin:555 - Challenge (base64): bziCK0o8kE587ccAM8cwq7pNUvpyfOlqkY7Buq/gB0cfRtkgq9826Z08Kk4em6k+eMeGrrl8x9IfY6ANF79T7w==
[2025-06-20 23:24:43,725] INFO authentication webauthn_authenticate_begin:557 - Challenge length: 64 bytes
[2025-06-20 23:24:43,725] INFO authentication webauthn_authenticate_begin:568 - Challenge stored with ID: 22465eba-5796-4234-857f-daea44e85608
[2025-06-20 23:24:43,725] INFO authentication webauthn_authenticate_begin:569 - Total challenges in memory: 1
[2025-06-20 23:24:43,725] INFO authentication webauthn_authenticate_begin:573 - Allow credential: {'id': 'GDehNH+TK/Rukq5v5Fi46A==', 'type': 'public-key', 'transports': []}
[2025-06-20 23:26:00,843] INFO authentication webauthn_authenticate_begin:491 - === WebAuthn Authentication Begin ===
[2025-06-20 23:26:00,845] INFO authentication webauthn_authenticate_begin:492 - Request data: {'username': 'new9'}
[2025-06-20 23:26:00,847] INFO authentication webauthn_authenticate_begin:511 - Processing authentication for user: new9
[2025-06-20 23:26:00,850] INFO authentication webauthn_authenticate_begin:516 - User found: new9 (ID: 10)
[2025-06-20 23:26:00,852] INFO authentication webauthn_authenticate_begin:525 - Found 2 credentials for user new9
[2025-06-20 23:26:00,857] INFO authentication webauthn_authenticate_begin:541 - Added credential: GDehNH+TK/Rukq5v5Fi46A== (transports: [])
[2025-06-20 23:26:00,857] INFO authentication webauthn_authenticate_begin:541 - Added credential: S0h/J4e0JUC/vAoorffXNw== (transports: [])
[2025-06-20 23:26:00,857] INFO authentication webauthn_authenticate_begin:544 - Generating authentication options...
[2025-06-20 23:26:00,858] INFO authentication webauthn_authenticate_begin:545 - RP ID: localhost
[2025-06-20 23:26:00,858] INFO authentication webauthn_authenticate_begin:546 - Allow credentials count: 2
[2025-06-20 23:26:00,858] INFO authentication webauthn_authenticate_begin:554 - Authentication options generated successfully
[2025-06-20 23:26:00,858] INFO authentication webauthn_authenticate_begin:555 - Challenge (base64): xs8+6xLhMh8SyIDVE7sABvXZn4bNY5hCrS27PSgE0vyhkmJdBFdaLUlgApO//8pqqjgdovclMjK2xXU5gWMUFg==
[2025-06-20 23:26:00,858] INFO authentication webauthn_authenticate_begin:557 - Challenge length: 64 bytes
[2025-06-20 23:26:00,860] INFO authentication webauthn_authenticate_begin:568 - Challenge stored with ID: 616fa11d-4bca-4900-9bb3-31a0df2a84eb
[2025-06-20 23:26:00,860] INFO authentication webauthn_authenticate_begin:569 - Total challenges in memory: 1
[2025-06-20 23:26:00,860] INFO authentication webauthn_authenticate_begin:573 - Allow credential 573: {'id': 'GDehNH+TK/Rukq5v5Fi46A==', 'type': 'public-key', 'transports': []}
[2025-06-20 23:28:07,563] INFO authentication webauthn_authenticate_begin:491 - === WebAuthn Authentication Begin ===
[2025-06-20 23:28:07,563] INFO authentication webauthn_authenticate_begin:492 - Request data: {'username': 'new9'}
[2025-06-20 23:28:07,564] INFO authentication webauthn_authenticate_begin:511 - Processing authentication for user: new9
[2025-06-20 23:28:07,565] INFO authentication webauthn_authenticate_begin:516 - User found: new9 (ID: 10)
[2025-06-20 23:28:07,567] INFO authentication webauthn_authenticate_begin:525 - Found 2 credentials for user new9
[2025-06-20 23:28:07,569] INFO authentication webauthn_authenticate_begin:541 - Added credential: GDehNH+TK/Rukq5v5Fi46A== (transports: [])
[2025-06-20 23:28:07,569] INFO authentication webauthn_authenticate_begin:541 - Added credential: S0h/J4e0JUC/vAoorffXNw== (transports: [])
[2025-06-20 23:28:07,569] INFO authentication webauthn_authenticate_begin:544 - Generating authentication options...
[2025-06-20 23:28:07,569] INFO authentication webauthn_authenticate_begin:545 - RP ID: localhost
[2025-06-20 23:28:07,569] INFO authentication webauthn_authenticate_begin:546 - Allow credentials count: 2
[2025-06-20 23:28:07,569] INFO authentication webauthn_authenticate_begin:554 - Authentication options generated successfully
[2025-06-20 23:28:07,569] INFO authentication webauthn_authenticate_begin:555 - Challenge (base64): gndI2pvCF/Ag+v+cRAyP9sDhAaILFSYQca92xkvEZO/N8CfadxbviBL2QcAG4Ln/oOsLBwznqiAO8/taRA5GJA==
[2025-06-20 23:28:07,571] INFO authentication webauthn_authenticate_begin:557 - Challenge length: 64 bytes
[2025-06-20 23:28:07,571] INFO authentication webauthn_authenticate_begin:568 - Challenge stored with ID: 44e49d9b-e45e-4e9c-b925-9b877cb2e9b5
[2025-06-20 23:28:07,571] INFO authentication webauthn_authenticate_begin:569 - Total challenges in memory: 1
[2025-06-20 23:28:07,572] INFO authentication webauthn_authenticate_begin:573 - Allow credential: {'id': 'GDehNH+TK/Rukq5v5Fi46A==', 'type': 'public-key', 'transports': []}
[2025-06-20 23:28:07,572] INFO authentication webauthn_authenticate_begin:574 - Allow credential id: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 23:28:07,572] INFO authentication webauthn_authenticate_begin:575 - Allow credential type: public-key
[2025-06-20 23:28:07,572] INFO authentication webauthn_authenticate_begin:576 - Allow credential transports: []
[2025-06-20 23:28:07,572] INFO authentication webauthn_authenticate_begin:573 - Allow credential: {'id': 'S0h/J4e0JUC/vAoorffXNw==', 'type': 'public-key', 'transports': []}
[2025-06-20 23:28:07,572] INFO authentication webauthn_authenticate_begin:574 - Allow credential id: S0h/J4e0JUC/vAoorffXNw==
[2025-06-20 23:28:07,573] INFO authentication webauthn_authenticate_begin:575 - Allow credential type: public-key
[2025-06-20 23:28:07,573] INFO authentication webauthn_authenticate_begin:576 - Allow credential transports: []
[2025-06-20 23:28:07,573] INFO authentication webauthn_authenticate_begin:592 - Authentication options converted to dictionary
[2025-06-20 23:28:07,573] INFO authentication webauthn_authenticate_begin:593 - Options dict keys: ['challenge', 'rpId', 'allowCredentials', 'userVerification', 'timeout']
[2025-06-20 23:28:07,574] INFO authentication webauthn_authenticate_begin:594 - Challenge in options: gndI2pvCF/Ag+v+cRAyP9sDhAaILFSYQca92xkvEZO/N8CfadxbviBL2QcAG4Ln/oOsLBwznqiAO8/taRA5GJA==
[2025-06-20 23:28:07,574] INFO authentication webauthn_authenticate_begin:595 - Allow credentials count in options: 2
[2025-06-20 23:28:07,574] INFO authentication webauthn_authenticate_begin:603 - === WebAuthn Authentication Begin Complete ===
[2025-06-20 23:28:07,574] INFO authentication webauthn_authenticate_begin:604 - Response data: {'options': {'challenge': 'gndI2pvCF/Ag+v+cRAyP9sDhAaILFSYQca92xkvEZO/N8CfadxbviBL2QcAG4Ln/oOsLBwznqiAO8/taRA5GJA==', 'rpId': 'localhost', 'allowCredentials': [{'type': 'public-key', 'id': 'GDehNH+TK/Rukq5v5Fi46A==', 'transports': []}, {'type': 'public-key', 'id': 'S0h/J4e0JUC/vAoorffXNw==', 'transports': []}], 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>, 'timeout': 60000}, 'challenge_id': '44e49d9b-e45e-4e9c-b925-9b877cb2e9b5'}
[2025-06-20 23:29:26,645] INFO authentication webauthn_authenticate_complete:613 - === WebAuthn Authentication Complete ===
[2025-06-20 23:29:26,645] INFO authentication webauthn_authenticate_complete:614 - Request data: {'username': 'new9', 'challenge_id': '44e49d9b-e45e-4e9c-b925-9b877cb2e9b5', 'credential_id': 'GDehNH+TK/Rukq5v5Fi46A==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiZ25kSTJwdkNGX0FnLXYtY1JBeVA5c0RoQWFJTEZTWVFjYTkyeGt2RVpPX044Q2ZhZHhidmlCTDJRY0FHNExuX29Pc0xCd3pucWlBTzhfdGFSQTVHSkEiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEYCIQC3sMNPd/7OLvtsnvAB/Jxt9PxAYMkwOyRAkvlxD5wyQgIhAIMW8i0sJMVbR5Nu4SspblsFXAabd8Q5QoMRVRjoZtYm'}
[2025-06-20 23:29:26,647] INFO authentication webauthn_authenticate_complete:624 - Serializer validated successfully
[2025-06-20 23:29:26,647] INFO authentication webauthn_authenticate_complete:625 - Validated data: {'username': 'new9', 'credential_id': 'GDehNH+TK/Rukq5v5Fi46A==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiZ25kSTJwdkNGX0FnLXYtY1JBeVA5c0RoQWFJTEZTWVFjYTkyeGt2RVpPX044Q2ZhZHhidmlCTDJRY0FHNExuX29Pc0xCd3pucWlBTzhfdGFSQTVHSkEiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEYCIQC3sMNPd/7OLvtsnvAB/Jxt9PxAYMkwOyRAkvlxD5wyQgIhAIMW8i0sJMVbR5Nu4SspblsFXAabd8Q5QoMRVRjoZtYm'}
[2025-06-20 23:29:26,647] INFO authentication webauthn_authenticate_complete:663 - Challenge ID from request: 44e49d9b-e45e-4e9c-b925-9b877cb2e9b5
[2025-06-20 23:29:26,647] INFO authentication webauthn_authenticate_complete:678 - Retrieved stored challenge data:
[2025-06-20 23:29:26,648] INFO authentication webauthn_authenticate_complete:679 -   - Challenge: gndI2pvCF/Ag+v+cRAyP9sDhAaILFSYQca92xkvEZO/N8CfadxbviBL2QcAG4Ln/oOsLBwznqiAO8/taRA5GJA==
[2025-06-20 23:29:26,648] INFO authentication webauthn_authenticate_complete:680 -   - Username: new9
[2025-06-20 23:29:26,648] INFO authentication webauthn_authenticate_complete:681 -   - Type: authentication
[2025-06-20 23:29:26,651] INFO authentication webauthn_authenticate_complete:686 - User found: new9 (ID: 10)
[2025-06-20 23:29:26,654] INFO authentication webauthn_authenticate_complete:699 - Credential found: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 23:29:26,654] INFO authentication webauthn_authenticate_complete:700 - Credential public key length: 77 bytes
[2025-06-20 23:29:26,654] INFO authentication webauthn_authenticate_complete:702 - Credential sign count: 0
[2025-06-20 23:29:26,655] INFO authentication webauthn_authenticate_complete:712 - Starting authentication verification...
[2025-06-20 23:29:26,655] INFO authentication webauthn_authenticate_complete:713 - Challenge: gndI2pvCF/Ag+v+cRAyP9sDhAaILFSYQca92xkvEZO/N8CfadxbviBL2QcAG4Ln/oOsLBwznqiAO8/taRA5GJA==
[2025-06-20 23:29:26,655] INFO authentication webauthn_authenticate_complete:714 - RP ID: localhost
[2025-06-20 23:29:26,655] INFO authentication webauthn_authenticate_complete:715 - Origin: http://localhost:5173
[2025-06-20 23:29:26,655] INFO authentication webauthn_authenticate_complete:720 - Decoded credential_id length: 16 bytes
[2025-06-20 23:29:26,656] INFO authentication webauthn_authenticate_complete:722 - Decoded credential_id (hex): 1837a1347f932bf46e92ae6fe458b8e8
[2025-06-20 23:29:26,656] INFO authentication webauthn_authenticate_complete:727 - Re-encoded credential_id: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 23:29:26,656] INFO authentication webauthn_authenticate_complete:728 - Original vs re-encoded match: True
[2025-06-20 23:29:26,658] INFO authentication webauthn_authenticate_complete:734 - URL-safe encoded credential_id: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 23:29:26,658] INFO authentication webauthn_authenticate_complete:735 - Original vs urlsafe match: False
[2025-06-20 23:29:26,658] INFO authentication webauthn_authenticate_complete:741 - Converted credential_id to base64url: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 23:29:26,658] ERROR authentication webauthn_authenticate_complete:822 - Authentication verification failed: type object 'AuthenticationCredential' has no attribute 'Response'
[2025-06-20 23:29:26,658] ERROR authentication webauthn_authenticate_complete:823 - Exception type: AttributeError
[2025-06-20 23:29:26,661] ERROR authentication webauthn_authenticate_complete:824 - Traceback: Traceback (most recent call last):
  File "C:\Users\fazi\Desktop\machine task\secure-dashboard\backend\authentication\views.py", line 746, in webauthn_authenticate_complete
    response=AuthenticationCredential.Response(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'AuthenticationCredential' has no attribute 'Response'

[2025-06-20 23:34:35,343] INFO authentication webauthn_authenticate_begin:492 - === WebAuthn Authentication Begin ===
[2025-06-20 23:34:35,343] INFO authentication webauthn_authenticate_begin:493 - Request data: {'username': 'new9'}
[2025-06-20 23:34:35,344] INFO authentication webauthn_authenticate_begin:512 - Processing authentication for user: new9
[2025-06-20 23:34:35,349] INFO authentication webauthn_authenticate_begin:517 - User found: new9 (ID: 10)
[2025-06-20 23:34:35,355] INFO authentication webauthn_authenticate_begin:526 - Found 2 credentials for user new9
[2025-06-20 23:34:35,359] INFO authentication webauthn_authenticate_begin:542 - Added credential: GDehNH+TK/Rukq5v5Fi46A== (transports: [])
[2025-06-20 23:34:35,360] INFO authentication webauthn_authenticate_begin:542 - Added credential: S0h/J4e0JUC/vAoorffXNw== (transports: [])
[2025-06-20 23:34:35,360] INFO authentication webauthn_authenticate_begin:545 - Generating authentication options...
[2025-06-20 23:34:35,360] INFO authentication webauthn_authenticate_begin:546 - RP ID: localhost
[2025-06-20 23:34:35,361] INFO authentication webauthn_authenticate_begin:547 - Allow credentials count: 2
[2025-06-20 23:34:35,361] INFO authentication webauthn_authenticate_begin:555 - Authentication options generated successfully
[2025-06-20 23:34:35,361] INFO authentication webauthn_authenticate_begin:556 - Challenge (base64): O5n+9Eeebhel6qhZME64vVZz2aWSfuPtNHkFh5vhUVlceeHt8f3YXakrPoqtbLN8RqC7xihyt3Av9IFsH/1tcg==
[2025-06-20 23:34:35,362] INFO authentication webauthn_authenticate_begin:558 - Challenge length: 64 bytes
[2025-06-20 23:34:35,362] INFO authentication webauthn_authenticate_begin:569 - Challenge stored with ID: eab84cce-adef-4666-8d18-ab9785b31390
[2025-06-20 23:34:35,362] INFO authentication webauthn_authenticate_begin:570 - Total challenges in memory: 1
[2025-06-20 23:34:35,362] INFO authentication webauthn_authenticate_begin:574 - Allow credential: {'id': 'GDehNH+TK/Rukq5v5Fi46A==', 'type': 'public-key', 'transports': []}
[2025-06-20 23:34:35,363] INFO authentication webauthn_authenticate_begin:575 - Allow credential id: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 23:34:35,363] INFO authentication webauthn_authenticate_begin:576 - Allow credential type: public-key
[2025-06-20 23:34:35,364] INFO authentication webauthn_authenticate_begin:577 - Allow credential transports: []
[2025-06-20 23:34:35,364] INFO authentication webauthn_authenticate_begin:574 - Allow credential: {'id': 'S0h/J4e0JUC/vAoorffXNw==', 'type': 'public-key', 'transports': []}
[2025-06-20 23:34:35,364] INFO authentication webauthn_authenticate_begin:575 - Allow credential id: S0h/J4e0JUC/vAoorffXNw==
[2025-06-20 23:34:35,364] INFO authentication webauthn_authenticate_begin:576 - Allow credential type: public-key
[2025-06-20 23:34:35,365] INFO authentication webauthn_authenticate_begin:577 - Allow credential transports: []
[2025-06-20 23:34:35,366] INFO authentication webauthn_authenticate_begin:593 - Authentication options converted to dictionary
[2025-06-20 23:34:35,366] INFO authentication webauthn_authenticate_begin:594 - Options dict keys: ['challenge', 'rpId', 'allowCredentials', 'userVerification', 'timeout']
[2025-06-20 23:34:35,366] INFO authentication webauthn_authenticate_begin:595 - Challenge in options: O5n+9Eeebhel6qhZME64vVZz2aWSfuPtNHkFh5vhUVlceeHt8f3YXakrPoqtbLN8RqC7xihyt3Av9IFsH/1tcg==
[2025-06-20 23:34:35,367] INFO authentication webauthn_authenticate_begin:596 - Allow credentials count in options: 2
[2025-06-20 23:34:35,367] INFO authentication webauthn_authenticate_begin:604 - === WebAuthn Authentication Begin Complete ===
[2025-06-20 23:34:35,367] INFO authentication webauthn_authenticate_begin:605 - Response data: {'options': {'challenge': 'O5n+9Eeebhel6qhZME64vVZz2aWSfuPtNHkFh5vhUVlceeHt8f3YXakrPoqtbLN8RqC7xihyt3Av9IFsH/1tcg==', 'rpId': 'localhost', 'allowCredentials': [{'type': 'public-key', 'id': 'GDehNH+TK/Rukq5v5Fi46A==', 'transports': []}, {'type': 'public-key', 'id': 'S0h/J4e0JUC/vAoorffXNw==', 'transports': []}], 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>, 'timeout': 60000}, 'challenge_id': 'eab84cce-adef-4666-8d18-ab9785b31390'}
[2025-06-20 23:34:54,718] INFO authentication webauthn_authenticate_begin:492 - === WebAuthn Authentication Begin ===
[2025-06-20 23:34:54,719] INFO authentication webauthn_authenticate_begin:493 - Request data: {'username': 'new9'}
[2025-06-20 23:34:54,720] INFO authentication webauthn_authenticate_begin:512 - Processing authentication for user: new9
[2025-06-20 23:34:54,724] INFO authentication webauthn_authenticate_begin:517 - User found: new9 (ID: 10)
[2025-06-20 23:34:54,726] INFO authentication webauthn_authenticate_begin:526 - Found 2 credentials for user new9
[2025-06-20 23:34:54,727] INFO authentication webauthn_authenticate_begin:542 - Added credential: GDehNH+TK/Rukq5v5Fi46A== (transports: [])
[2025-06-20 23:34:54,728] INFO authentication webauthn_authenticate_begin:542 - Added credential: S0h/J4e0JUC/vAoorffXNw== (transports: [])
[2025-06-20 23:34:54,728] INFO authentication webauthn_authenticate_begin:545 - Generating authentication options...
[2025-06-20 23:34:54,728] INFO authentication webauthn_authenticate_begin:546 - RP ID: localhost
[2025-06-20 23:34:54,728] INFO authentication webauthn_authenticate_begin:547 - Allow credentials count: 2
[2025-06-20 23:34:54,729] INFO authentication webauthn_authenticate_begin:555 - Authentication options generated successfully
[2025-06-20 23:34:54,729] INFO authentication webauthn_authenticate_begin:556 - Challenge (base64): WD94X76a+1C7J3ICpOzOmVCxn9DxjPzELYoTrmsiiBlpa6oRyrvLq1o/GtDxXuD3X/IJLDZz6cT4SxalEw974Q==
[2025-06-20 23:34:54,729] INFO authentication webauthn_authenticate_begin:558 - Challenge length: 64 bytes
[2025-06-20 23:34:54,729] INFO authentication webauthn_authenticate_begin:569 - Challenge stored with ID: b0a4dafb-0017-401b-841a-1d34bc27c218
[2025-06-20 23:34:54,729] INFO authentication webauthn_authenticate_begin:570 - Total challenges in memory: 2
[2025-06-20 23:34:54,730] INFO authentication webauthn_authenticate_begin:574 - Allow credential: {'id': 'GDehNH+TK/Rukq5v5Fi46A==', 'type': 'public-key', 'transports': []}
[2025-06-20 23:34:54,730] INFO authentication webauthn_authenticate_begin:575 - Allow credential id: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 23:34:54,730] INFO authentication webauthn_authenticate_begin:576 - Allow credential type: public-key
[2025-06-20 23:34:54,730] INFO authentication webauthn_authenticate_begin:577 - Allow credential transports: []
[2025-06-20 23:34:54,730] INFO authentication webauthn_authenticate_begin:574 - Allow credential: {'id': 'S0h/J4e0JUC/vAoorffXNw==', 'type': 'public-key', 'transports': []}
[2025-06-20 23:34:54,731] INFO authentication webauthn_authenticate_begin:575 - Allow credential id: S0h/J4e0JUC/vAoorffXNw==
[2025-06-20 23:34:54,731] INFO authentication webauthn_authenticate_begin:576 - Allow credential type: public-key
[2025-06-20 23:34:54,731] INFO authentication webauthn_authenticate_begin:577 - Allow credential transports: []
[2025-06-20 23:34:54,731] INFO authentication webauthn_authenticate_begin:593 - Authentication options converted to dictionary
[2025-06-20 23:34:54,731] INFO authentication webauthn_authenticate_begin:594 - Options dict keys: ['challenge', 'rpId', 'allowCredentials', 'userVerification', 'timeout']
[2025-06-20 23:34:54,732] INFO authentication webauthn_authenticate_begin:595 - Challenge in options: WD94X76a+1C7J3ICpOzOmVCxn9DxjPzELYoTrmsiiBlpa6oRyrvLq1o/GtDxXuD3X/IJLDZz6cT4SxalEw974Q==
[2025-06-20 23:34:54,732] INFO authentication webauthn_authenticate_begin:596 - Allow credentials count in options: 2
[2025-06-20 23:34:54,732] INFO authentication webauthn_authenticate_begin:604 - === WebAuthn Authentication Begin Complete ===
[2025-06-20 23:34:54,732] INFO authentication webauthn_authenticate_begin:605 - Response data: {'options': {'challenge': 'WD94X76a+1C7J3ICpOzOmVCxn9DxjPzELYoTrmsiiBlpa6oRyrvLq1o/GtDxXuD3X/IJLDZz6cT4SxalEw974Q==', 'rpId': 'localhost', 'allowCredentials': [{'type': 'public-key', 'id': 'GDehNH+TK/Rukq5v5Fi46A==', 'transports': []}, {'type': 'public-key', 'id': 'S0h/J4e0JUC/vAoorffXNw==', 'transports': []}], 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>, 'timeout': 60000}, 'challenge_id': 'b0a4dafb-0017-401b-841a-1d34bc27c218'}
[2025-06-20 23:35:26,559] INFO authentication webauthn_authenticate_begin:492 - === WebAuthn Authentication Begin ===
[2025-06-20 23:35:26,560] INFO authentication webauthn_authenticate_begin:493 - Request data: {'username': 'new9'}
[2025-06-20 23:35:26,561] INFO authentication webauthn_authenticate_begin:512 - Processing authentication for user: new9
[2025-06-20 23:35:26,563] INFO authentication webauthn_authenticate_begin:517 - User found: new9 (ID: 10)
[2025-06-20 23:35:26,564] INFO authentication webauthn_authenticate_begin:526 - Found 2 credentials for user new9
[2025-06-20 23:35:26,567] INFO authentication webauthn_authenticate_begin:542 - Added credential: GDehNH+TK/Rukq5v5Fi46A== (transports: [])
[2025-06-20 23:35:26,568] INFO authentication webauthn_authenticate_begin:542 - Added credential: S0h/J4e0JUC/vAoorffXNw== (transports: [])
[2025-06-20 23:35:26,568] INFO authentication webauthn_authenticate_begin:545 - Generating authentication options...
[2025-06-20 23:35:26,568] INFO authentication webauthn_authenticate_begin:546 - RP ID: localhost
[2025-06-20 23:35:26,568] INFO authentication webauthn_authenticate_begin:547 - Allow credentials count: 2
[2025-06-20 23:35:26,568] INFO authentication webauthn_authenticate_begin:555 - Authentication options generated successfully
[2025-06-20 23:35:26,568] INFO authentication webauthn_authenticate_begin:556 - Challenge (base64): XFOzpDjIvHIRk9Uj4XOJ9yFLj6vpRkODphWoweCjXdTjIUQGFGlgmcqY3foyJ/2xN6+oBrFSukrXmLyhwa3w0Q==
[2025-06-20 23:35:26,568] INFO authentication webauthn_authenticate_begin:558 - Challenge length: 64 bytes
[2025-06-20 23:35:26,569] INFO authentication webauthn_authenticate_begin:569 - Challenge stored with ID: 06efbdd9-a12e-47fe-8c5e-6398dee5d2ed
[2025-06-20 23:35:26,569] INFO authentication webauthn_authenticate_begin:570 - Total challenges in memory: 3
[2025-06-20 23:35:26,569] INFO authentication webauthn_authenticate_begin:574 - Allow credential: {'id': 'GDehNH+TK/Rukq5v5Fi46A==', 'type': 'public-key', 'transports': []}
[2025-06-20 23:35:26,569] INFO authentication webauthn_authenticate_begin:575 - Allow credential id: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 23:35:26,569] INFO authentication webauthn_authenticate_begin:576 - Allow credential type: public-key
[2025-06-20 23:35:26,569] INFO authentication webauthn_authenticate_begin:577 - Allow credential transports: []
[2025-06-20 23:35:26,570] INFO authentication webauthn_authenticate_begin:574 - Allow credential: {'id': 'S0h/J4e0JUC/vAoorffXNw==', 'type': 'public-key', 'transports': []}
[2025-06-20 23:35:26,570] INFO authentication webauthn_authenticate_begin:575 - Allow credential id: S0h/J4e0JUC/vAoorffXNw==
[2025-06-20 23:35:26,570] INFO authentication webauthn_authenticate_begin:576 - Allow credential type: public-key
[2025-06-20 23:35:26,570] INFO authentication webauthn_authenticate_begin:577 - Allow credential transports: []
[2025-06-20 23:35:26,570] INFO authentication webauthn_authenticate_begin:593 - Authentication options converted to dictionary
[2025-06-20 23:35:26,571] INFO authentication webauthn_authenticate_begin:594 - Options dict keys: ['challenge', 'rpId', 'allowCredentials', 'userVerification', 'timeout']
[2025-06-20 23:35:26,571] INFO authentication webauthn_authenticate_begin:595 - Challenge in options: XFOzpDjIvHIRk9Uj4XOJ9yFLj6vpRkODphWoweCjXdTjIUQGFGlgmcqY3foyJ/2xN6+oBrFSukrXmLyhwa3w0Q==
[2025-06-20 23:35:26,571] INFO authentication webauthn_authenticate_begin:596 - Allow credentials count in options: 2
[2025-06-20 23:35:26,571] INFO authentication webauthn_authenticate_begin:604 - === WebAuthn Authentication Begin Complete ===
[2025-06-20 23:35:26,571] INFO authentication webauthn_authenticate_begin:605 - Response data: {'options': {'challenge': 'XFOzpDjIvHIRk9Uj4XOJ9yFLj6vpRkODphWoweCjXdTjIUQGFGlgmcqY3foyJ/2xN6+oBrFSukrXmLyhwa3w0Q==', 'rpId': 'localhost', 'allowCredentials': [{'type': 'public-key', 'id': 'GDehNH+TK/Rukq5v5Fi46A==', 'transports': []}, {'type': 'public-key', 'id': 'S0h/J4e0JUC/vAoorffXNw==', 'transports': []}], 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>, 'timeout': 60000}, 'challenge_id': '06efbdd9-a12e-47fe-8c5e-6398dee5d2ed'}
[2025-06-20 23:36:11,719] INFO authentication webauthn_authenticate_complete:614 - === WebAuthn Authentication Complete ===
[2025-06-20 23:36:11,720] INFO authentication webauthn_authenticate_complete:615 - Request data: {'username': 'new9', 'challenge_id': '06efbdd9-a12e-47fe-8c5e-6398dee5d2ed', 'credential_id': 'GDehNH+TK/Rukq5v5Fi46A==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiWEZPenBEakl2SElSazlVajRYT0o5eUZMajZ2cFJrT0RwaFdvd2VDalhkVGpJVVFHRkdsZ21jcVkzZm95Sl8yeE42LW9CckZTdWtyWG1MeWh3YTN3MFEiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEUCIQCFaaLsmitiymLtkkM0h+caUCdCuXhM2Esfn8e62ejPYQIgBurBRo/R6zRwS/meDFqvpYvKzEE52qokdcUwrh/iH7c='}
[2025-06-20 23:36:11,721] INFO authentication webauthn_authenticate_complete:625 - Serializer validated successfully
[2025-06-20 23:36:11,721] INFO authentication webauthn_authenticate_complete:626 - Validated data: {'username': 'new9', 'credential_id': 'GDehNH+TK/Rukq5v5Fi46A==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiWEZPenBEakl2SElSazlVajRYT0o5eUZMajZ2cFJrT0RwaFdvd2VDalhkVGpJVVFHRkdsZ21jcVkzZm95Sl8yeE42LW9CckZTdWtyWG1MeWh3YTN3MFEiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEUCIQCFaaLsmitiymLtkkM0h+caUCdCuXhM2Esfn8e62ejPYQIgBurBRo/R6zRwS/meDFqvpYvKzEE52qokdcUwrh/iH7c='}
[2025-06-20 23:36:11,721] INFO authentication webauthn_authenticate_complete:664 - Challenge ID from request: 06efbdd9-a12e-47fe-8c5e-6398dee5d2ed
[2025-06-20 23:36:11,721] INFO authentication webauthn_authenticate_complete:679 - Retrieved stored challenge data:
[2025-06-20 23:36:11,721] INFO authentication webauthn_authenticate_complete:680 -   - Challenge: XFOzpDjIvHIRk9Uj4XOJ9yFLj6vpRkODphWoweCjXdTjIUQGFGlgmcqY3foyJ/2xN6+oBrFSukrXmLyhwa3w0Q==
[2025-06-20 23:36:11,721] INFO authentication webauthn_authenticate_complete:681 -   - Username: new9
[2025-06-20 23:36:11,722] INFO authentication webauthn_authenticate_complete:682 -   - Type: authentication
[2025-06-20 23:36:11,724] INFO authentication webauthn_authenticate_complete:687 - User found: new9 (ID: 10)
[2025-06-20 23:36:11,725] INFO authentication webauthn_authenticate_complete:700 - Credential found: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 23:36:11,726] INFO authentication webauthn_authenticate_complete:701 - Credential public key length: 77 bytes
[2025-06-20 23:36:11,726] INFO authentication webauthn_authenticate_complete:703 - Credential sign count: 0
[2025-06-20 23:36:11,726] INFO authentication webauthn_authenticate_complete:713 - Starting authentication verification...
[2025-06-20 23:36:11,726] INFO authentication webauthn_authenticate_complete:714 - Challenge: XFOzpDjIvHIRk9Uj4XOJ9yFLj6vpRkODphWoweCjXdTjIUQGFGlgmcqY3foyJ/2xN6+oBrFSukrXmLyhwa3w0Q==
[2025-06-20 23:36:11,726] INFO authentication webauthn_authenticate_complete:715 - RP ID: localhost
[2025-06-20 23:36:11,726] INFO authentication webauthn_authenticate_complete:716 - Origin: http://localhost:5173
[2025-06-20 23:36:11,727] INFO authentication webauthn_authenticate_complete:721 - Decoded credential_id length: 16 bytes
[2025-06-20 23:36:11,727] INFO authentication webauthn_authenticate_complete:723 - Decoded credential_id (hex): 1837a1347f932bf46e92ae6fe458b8e8
[2025-06-20 23:36:11,727] INFO authentication webauthn_authenticate_complete:728 - Re-encoded credential_id: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 23:36:11,728] INFO authentication webauthn_authenticate_complete:729 - Original vs re-encoded match: True
[2025-06-20 23:36:11,728] INFO authentication webauthn_authenticate_complete:735 - URL-safe encoded credential_id: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 23:36:11,728] INFO authentication webauthn_authenticate_complete:736 - Original vs urlsafe match: False
[2025-06-20 23:36:11,728] INFO authentication webauthn_authenticate_complete:742 - Converted credential_id to base64url: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 23:36:11,728] INFO authentication webauthn_authenticate_complete:753 - AuthenticatorAssertionResponse created successfully
[2025-06-20 23:36:11,730] INFO authentication webauthn_authenticate_complete:761 - AuthenticationCredential created successfully
[2025-06-20 23:36:11,730] INFO authentication webauthn_authenticate_complete:762 - Credential ID type: <class 'str'>
[2025-06-20 23:36:11,730] INFO authentication webauthn_authenticate_complete:763 - Credential ID value: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 23:36:11,730] INFO authentication webauthn_authenticate_complete:764 - Credential raw_id type: <class 'bytes'>
[2025-06-20 23:36:11,730] INFO authentication webauthn_authenticate_complete:765 - Credential raw_id length: 16 bytes
[2025-06-20 23:36:11,731] INFO authentication webauthn_authenticate_complete:767 - Credential raw_id (hex): 1837a1347f932bf46e92ae6fe458b8e8
[2025-06-20 23:36:11,731] INFO authentication webauthn_authenticate_complete:768 - Credential type: public-key
[2025-06-20 23:36:11,731] INFO authentication webauthn_authenticate_complete:772 - Base64url encoding of raw_id: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 23:36:11,731] INFO authentication webauthn_authenticate_complete:773 - ID and base64url(raw_id) match: True
[2025-06-20 23:36:11,731] INFO authentication webauthn_authenticate_complete:774 - ID and raw_id have correct types: True
[2025-06-20 23:36:11,731] INFO authentication webauthn_authenticate_complete:776 - Starting verification with webauthn library...
[2025-06-20 23:36:11,762] INFO authentication webauthn_authenticate_complete:786 - === Authentication Verification Successful ===
[2025-06-20 23:36:11,763] INFO authentication webauthn_authenticate_complete:787 - Verification object: VerifiedAuthentication(credential_id=b'\x187\xa14\x7f\x93+\xf4n\x92\xaeo\xe4X\xb8\xe8', new_sign_count=0, credential_device_type=<CredentialDeviceType.MULTI_DEVICE: 'multi_device'>, credential_backed_up=True, user_verified=True)
[2025-06-20 23:36:11,763] INFO authentication webauthn_authenticate_complete:788 - New sign count: 0
[2025-06-20 23:36:11,763] INFO authentication webauthn_authenticate_complete:789 - Previous sign count: 0
[2025-06-20 23:36:11,783] INFO authentication webauthn_authenticate_complete:795 - Credential updated - new sign count: 0
[2025-06-20 23:36:11,801] INFO authentication webauthn_authenticate_complete:800 - User new9 logged in successfully
[2025-06-20 23:36:11,837] INFO authentication webauthn_authenticate_complete:804 - JWT tokens generated successfully
[2025-06-20 23:36:11,838] INFO authentication webauthn_authenticate_complete:808 - Challenge 06efbdd9-a12e-47fe-8c5e-6398dee5d2ed removed from memory
[2025-06-20 23:36:11,838] INFO authentication webauthn_authenticate_complete:809 - Remaining challenges: 2
[2025-06-20 23:36:11,847] INFO authentication webauthn_authenticate_complete:820 - === WebAuthn Authentication Complete Success ===
[2025-06-20 23:36:11,847] INFO authentication webauthn_authenticate_complete:821 - Response data: {'message': 'Authentication successful', 'user': {'id': 10, 'username': 'new9', 'email': 'new9@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T17:02:56.120981Z'}, 'tokens': {'access': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzUwNDQ2MzcxLCJpYXQiOjE3NTA0NDI3NzEsImp0aSI6ImQ5ZDA0OGZmMTcyODQ4YWJiNmYzN2M3ODkxOGE3MWRiIiwidXNlcl9pZCI6MTB9.nB5RdtvucG-96lGFOmXW9qXHNUPkLNQUQYjpZTAftBw', 'refresh': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTc1MDUyOTE3MSwiaWF0IjoxNzUwNDQyNzcxLCJqdGkiOiI4Y2UyMTFkZGE5NGQ0MjM0OWYxYzk2YjAxZjM3OGQ2OSIsInVzZXJfaWQiOjEwfQ.oXmbqm9uMFdiGtXg_WOeRfKFxQc15V_KYSYGbSj6_Ig'}}
[2025-06-20 23:38:02,129] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-20 23:38:02,129] INFO authentication user_profile:840 - User accessing profile: new9 (ID: 10)
[2025-06-20 23:38:02,131] INFO authentication user_profile:845 - Profile data retrieved: {'id': 10, 'username': 'new9', 'email': 'new9@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T17:02:56.120981Z'}
[2025-06-20 23:38:02,137] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-20 23:38:02,137] INFO authentication user_profile:840 - User accessing profile: new9 (ID: 10)
[2025-06-20 23:38:02,138] INFO authentication user_profile:845 - Profile data retrieved: {'id': 10, 'username': 'new9', 'email': 'new9@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T17:02:56.120981Z'}
[2025-06-20 23:48:49,877] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-20 23:48:49,882] INFO authentication user_profile:840 - User accessing profile: new9 (ID: 10)
[2025-06-20 23:48:49,896] INFO authentication user_profile:845 - Profile data retrieved: {'id': 10, 'username': 'new9', 'email': 'new9@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T17:02:56.120981Z'}
[2025-06-20 23:49:12,959] INFO authentication webauthn_authenticate_begin:492 - === WebAuthn Authentication Begin ===
[2025-06-20 23:49:12,962] INFO authentication webauthn_authenticate_begin:493 - Request data: {'username': 'new9'}
[2025-06-20 23:49:12,963] INFO authentication cleanup_expired_challenges:102 - Cleaned up expired challenge: eab84cce-adef-4666-8d18-ab9785b31390
[2025-06-20 23:49:12,963] INFO authentication cleanup_expired_challenges:102 - Cleaned up expired challenge: b0a4dafb-0017-401b-841a-1d34bc27c218
[2025-06-20 23:49:12,967] INFO authentication webauthn_authenticate_begin:512 - Processing authentication for user: new9
[2025-06-20 23:49:12,971] INFO authentication webauthn_authenticate_begin:517 - User found: new9 (ID: 10)
[2025-06-20 23:49:12,980] INFO authentication webauthn_authenticate_begin:526 - Found 2 credentials for user new9
[2025-06-20 23:49:12,987] INFO authentication webauthn_authenticate_begin:542 - Added credential: GDehNH+TK/Rukq5v5Fi46A== (transports: [])
[2025-06-20 23:49:12,988] INFO authentication webauthn_authenticate_begin:542 - Added credential: S0h/J4e0JUC/vAoorffXNw== (transports: [])
[2025-06-20 23:49:12,988] INFO authentication webauthn_authenticate_begin:545 - Generating authentication options...
[2025-06-20 23:49:12,988] INFO authentication webauthn_authenticate_begin:546 - RP ID: localhost
[2025-06-20 23:49:12,989] INFO authentication webauthn_authenticate_begin:547 - Allow credentials count: 2
[2025-06-20 23:49:12,991] INFO authentication webauthn_authenticate_begin:555 - Authentication options generated successfully
[2025-06-20 23:49:12,991] INFO authentication webauthn_authenticate_begin:556 - Challenge (base64): f/8VIyvQP2fY6tIfIkt+jy/Sd/iS0Qwed09Z/RFzYDqzGPdhfVzh9X85zvXwWUp1vrQ64YITylr3TPnZ4nJs5g==
[2025-06-20 23:49:12,992] INFO authentication webauthn_authenticate_begin:558 - Challenge length: 64 bytes
[2025-06-20 23:49:12,992] INFO authentication webauthn_authenticate_begin:569 - Challenge stored with ID: 49459a9d-1503-44ce-8994-c332bdaefe0f
[2025-06-20 23:49:12,992] INFO authentication webauthn_authenticate_begin:570 - Total challenges in memory: 1
[2025-06-20 23:49:12,993] INFO authentication webauthn_authenticate_begin:574 - Allow credential: {'id': 'GDehNH+TK/Rukq5v5Fi46A==', 'type': 'public-key', 'transports': []}
[2025-06-20 23:49:12,993] INFO authentication webauthn_authenticate_begin:575 - Allow credential id: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 23:49:12,993] INFO authentication webauthn_authenticate_begin:576 - Allow credential type: public-key
[2025-06-20 23:49:12,993] INFO authentication webauthn_authenticate_begin:577 - Allow credential transports: []
[2025-06-20 23:49:12,993] INFO authentication webauthn_authenticate_begin:574 - Allow credential: {'id': 'S0h/J4e0JUC/vAoorffXNw==', 'type': 'public-key', 'transports': []}
[2025-06-20 23:49:12,993] INFO authentication webauthn_authenticate_begin:575 - Allow credential id: S0h/J4e0JUC/vAoorffXNw==
[2025-06-20 23:49:12,994] INFO authentication webauthn_authenticate_begin:576 - Allow credential type: public-key
[2025-06-20 23:49:12,994] INFO authentication webauthn_authenticate_begin:577 - Allow credential transports: []
[2025-06-20 23:49:12,994] INFO authentication webauthn_authenticate_begin:593 - Authentication options converted to dictionary
[2025-06-20 23:49:12,994] INFO authentication webauthn_authenticate_begin:594 - Options dict keys: ['challenge', 'rpId', 'allowCredentials', 'userVerification', 'timeout']
[2025-06-20 23:49:12,995] INFO authentication webauthn_authenticate_begin:595 - Challenge in options: f/8VIyvQP2fY6tIfIkt+jy/Sd/iS0Qwed09Z/RFzYDqzGPdhfVzh9X85zvXwWUp1vrQ64YITylr3TPnZ4nJs5g==
[2025-06-20 23:49:12,995] INFO authentication webauthn_authenticate_begin:596 - Allow credentials count in options: 2
[2025-06-20 23:49:12,995] INFO authentication webauthn_authenticate_begin:604 - === WebAuthn Authentication Begin Complete ===
[2025-06-20 23:49:12,996] INFO authentication webauthn_authenticate_begin:605 - Response data: {'options': {'challenge': 'f/8VIyvQP2fY6tIfIkt+jy/Sd/iS0Qwed09Z/RFzYDqzGPdhfVzh9X85zvXwWUp1vrQ64YITylr3TPnZ4nJs5g==', 'rpId': 'localhost', 'allowCredentials': [{'type': 'public-key', 'id': 'GDehNH+TK/Rukq5v5Fi46A==', 'transports': []}, {'type': 'public-key', 'id': 'S0h/J4e0JUC/vAoorffXNw==', 'transports': []}], 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>, 'timeout': 60000}, 'challenge_id': '49459a9d-1503-44ce-8994-c332bdaefe0f'}
[2025-06-20 23:50:48,935] INFO authentication webauthn_authenticate_complete:614 - === WebAuthn Authentication Complete ===
[2025-06-20 23:50:48,936] INFO authentication webauthn_authenticate_complete:615 - Request data: {'username': 'new9', 'challenge_id': '49459a9d-1503-44ce-8994-c332bdaefe0f', 'credential_id': 'GDehNH+TK/Rukq5v5Fi46A==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiZl84Vkl5dlFQMmZZNnRJZklrdC1qeV9TZF9pUzBRd2VkMDlaX1JGellEcXpHUGRoZlZ6aDlYODV6dlh3V1VwMXZyUTY0WUlUeWxyM1RQblo0bkpzNWciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEUCIQDy80a+snqw5Yc/2Abv2nCA664tkqPE9ozDraAk8Kh5fgIgUw32N2ccpPyVVPCGg1CrBe1B20jKi6iqGFns4K14gcU='}
[2025-06-20 23:50:48,937] INFO authentication webauthn_authenticate_complete:625 - Serializer validated successfully
[2025-06-20 23:50:48,939] INFO authentication webauthn_authenticate_complete:626 - Validated data: {'username': 'new9', 'credential_id': 'GDehNH+TK/Rukq5v5Fi46A==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiZl84Vkl5dlFQMmZZNnRJZklrdC1qeV9TZF9pUzBRd2VkMDlaX1JGellEcXpHUGRoZlZ6aDlYODV6dlh3V1VwMXZyUTY0WUlUeWxyM1RQblo0bkpzNWciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEUCIQDy80a+snqw5Yc/2Abv2nCA664tkqPE9ozDraAk8Kh5fgIgUw32N2ccpPyVVPCGg1CrBe1B20jKi6iqGFns4K14gcU='}
[2025-06-20 23:50:48,940] INFO authentication webauthn_authenticate_complete:664 - Challenge ID from request: 49459a9d-1503-44ce-8994-c332bdaefe0f
[2025-06-20 23:50:48,940] INFO authentication webauthn_authenticate_complete:679 - Retrieved stored challenge data:
[2025-06-20 23:50:48,940] INFO authentication webauthn_authenticate_complete:680 -   - Challenge: f/8VIyvQP2fY6tIfIkt+jy/Sd/iS0Qwed09Z/RFzYDqzGPdhfVzh9X85zvXwWUp1vrQ64YITylr3TPnZ4nJs5g==
[2025-06-20 23:50:48,941] INFO authentication webauthn_authenticate_complete:681 -   - Username: new9
[2025-06-20 23:50:48,941] INFO authentication webauthn_authenticate_complete:682 -   - Type: authentication
[2025-06-20 23:50:48,945] INFO authentication webauthn_authenticate_complete:687 - User found: new9 (ID: 10)
[2025-06-20 23:50:48,948] INFO authentication webauthn_authenticate_complete:700 - Credential found: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 23:50:48,948] INFO authentication webauthn_authenticate_complete:701 - Credential public key length: 77 bytes
[2025-06-20 23:50:48,948] INFO authentication webauthn_authenticate_complete:703 - Credential sign count: 0
[2025-06-20 23:50:48,949] INFO authentication webauthn_authenticate_complete:713 - Starting authentication verification...
[2025-06-20 23:50:48,949] INFO authentication webauthn_authenticate_complete:714 - Challenge: f/8VIyvQP2fY6tIfIkt+jy/Sd/iS0Qwed09Z/RFzYDqzGPdhfVzh9X85zvXwWUp1vrQ64YITylr3TPnZ4nJs5g==
[2025-06-20 23:50:48,949] INFO authentication webauthn_authenticate_complete:715 - RP ID: localhost
[2025-06-20 23:50:48,949] INFO authentication webauthn_authenticate_complete:716 - Origin: http://localhost:5173
[2025-06-20 23:50:48,950] INFO authentication webauthn_authenticate_complete:721 - Decoded credential_id length: 16 bytes
[2025-06-20 23:50:48,950] INFO authentication webauthn_authenticate_complete:723 - Decoded credential_id (hex): 1837a1347f932bf46e92ae6fe458b8e8
[2025-06-20 23:50:48,951] INFO authentication webauthn_authenticate_complete:728 - Re-encoded credential_id: GDehNH+TK/Rukq5v5Fi46A==
[2025-06-20 23:50:48,951] INFO authentication webauthn_authenticate_complete:729 - Original vs re-encoded match: True
[2025-06-20 23:50:48,952] INFO authentication webauthn_authenticate_complete:735 - URL-safe encoded credential_id: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 23:50:48,952] INFO authentication webauthn_authenticate_complete:736 - Original vs urlsafe match: False
[2025-06-20 23:50:48,952] INFO authentication webauthn_authenticate_complete:742 - Converted credential_id to base64url: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 23:50:48,953] INFO authentication webauthn_authenticate_complete:753 - AuthenticatorAssertionResponse created successfully
[2025-06-20 23:50:48,953] INFO authentication webauthn_authenticate_complete:761 - AuthenticationCredential created successfully
[2025-06-20 23:50:48,954] INFO authentication webauthn_authenticate_complete:762 - Credential ID type: <class 'str'>
[2025-06-20 23:50:48,954] INFO authentication webauthn_authenticate_complete:763 - Credential ID value: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 23:50:48,955] INFO authentication webauthn_authenticate_complete:764 - Credential raw_id type: <class 'bytes'>
[2025-06-20 23:50:48,955] INFO authentication webauthn_authenticate_complete:765 - Credential raw_id length: 16 bytes
[2025-06-20 23:50:48,955] INFO authentication webauthn_authenticate_complete:767 - Credential raw_id (hex): 1837a1347f932bf46e92ae6fe458b8e8
[2025-06-20 23:50:48,955] INFO authentication webauthn_authenticate_complete:768 - Credential type: public-key
[2025-06-20 23:50:48,955] INFO authentication webauthn_authenticate_complete:772 - Base64url encoding of raw_id: GDehNH-TK_Rukq5v5Fi46A
[2025-06-20 23:50:48,955] INFO authentication webauthn_authenticate_complete:773 - ID and base64url(raw_id) match: True
[2025-06-20 23:50:48,956] INFO authentication webauthn_authenticate_complete:774 - ID and raw_id have correct types: True
[2025-06-20 23:50:48,956] INFO authentication webauthn_authenticate_complete:776 - Starting verification with webauthn library...
[2025-06-20 23:50:48,987] INFO authentication webauthn_authenticate_complete:786 - === Authentication Verification Successful ===
[2025-06-20 23:50:48,988] INFO authentication webauthn_authenticate_complete:787 - Verification object: VerifiedAuthentication(credential_id=b'\x187\xa14\x7f\x93+\xf4n\x92\xaeo\xe4X\xb8\xe8', new_sign_count=0, credential_device_type=<CredentialDeviceType.MULTI_DEVICE: 'multi_device'>, credential_backed_up=True, user_verified=True)
[2025-06-20 23:50:48,988] INFO authentication webauthn_authenticate_complete:788 - New sign count: 0
[2025-06-20 23:50:48,988] INFO authentication webauthn_authenticate_complete:789 - Previous sign count: 0
[2025-06-20 23:50:49,010] INFO authentication webauthn_authenticate_complete:795 - Credential updated - new sign count: 0
[2025-06-20 23:50:49,035] INFO authentication webauthn_authenticate_complete:800 - User new9 logged in successfully
[2025-06-20 23:50:49,047] INFO authentication webauthn_authenticate_complete:804 - JWT tokens generated successfully
[2025-06-20 23:50:49,047] INFO authentication webauthn_authenticate_complete:808 - Challenge 49459a9d-1503-44ce-8994-c332bdaefe0f removed from memory
[2025-06-20 23:50:49,047] INFO authentication webauthn_authenticate_complete:809 - Remaining challenges: 0
[2025-06-20 23:50:49,050] INFO authentication webauthn_authenticate_complete:820 - === WebAuthn Authentication Complete Success ===
[2025-06-20 23:50:49,050] INFO authentication webauthn_authenticate_complete:821 - Response data: {'message': 'Authentication successful', 'user': {'id': 10, 'username': 'new9', 'email': 'new9@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T17:02:56.120981Z'}, 'tokens': {'access': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzUwNDQ3MjQ5LCJpYXQiOjE3NTA0NDM2NDksImp0aSI6ImYxYjVlYTAxMGU1ZjQxZTJiY2QxNDI5NDM3ZDliNjRhIiwidXNlcl9pZCI6MTB9.BCaeM9eZfPA8davHLxG8B4YnTIPREtOFLKanSzPLgWg', 'refresh': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTc1MDUzMDA0OSwiaWF0IjoxNzUwNDQzNjQ5LCJqdGkiOiI4OTRmNmM0NTlhNmU0ZmE3YmNhMTc5MWE1ZTI1MGMwNiIsInVzZXJfaWQiOjEwfQ.oUCBGrgNL55BgnJtvFkS35KgwSVe0vA8o1eCvA7L_lM'}}
[2025-06-20 23:50:49,112] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-20 23:50:49,112] INFO authentication user_profile:840 - User accessing profile: new9 (ID: 10)
[2025-06-20 23:50:49,114] INFO authentication user_profile:845 - Profile data retrieved: {'id': 10, 'username': 'new9', 'email': 'new9@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T17:02:56.120981Z'}
[2025-06-20 23:50:49,122] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-20 23:50:49,123] INFO authentication user_profile:840 - User accessing profile: new9 (ID: 10)
[2025-06-20 23:50:49,125] INFO authentication user_profile:845 - Profile data retrieved: {'id': 10, 'username': 'new9', 'email': 'new9@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T17:02:56.120981Z'}
[2025-06-21 00:27:34,364] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 00:27:34,376] INFO authentication user_profile:840 - User accessing profile: new9 (ID: 10)
[2025-06-21 00:27:34,398] INFO authentication user_profile:845 - Profile data retrieved: {'id': 10, 'username': 'new9', 'email': 'new9@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T17:02:56.120981Z'}
[2025-06-21 00:27:34,414] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 00:27:34,414] INFO authentication user_profile:840 - User accessing profile: new9 (ID: 10)
[2025-06-21 00:27:34,417] INFO authentication user_profile:845 - Profile data retrieved: {'id': 10, 'username': 'new9', 'email': 'new9@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T17:02:56.120981Z'}
[2025-06-21 00:27:34,456] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 00:27:34,457] INFO authentication user_profile:840 - User accessing profile: new9 (ID: 10)
[2025-06-21 00:27:34,459] INFO authentication user_profile:845 - Profile data retrieved: {'id': 10, 'username': 'new9', 'email': 'new9@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T17:02:56.120981Z'}
[2025-06-21 00:27:34,469] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 00:27:34,469] INFO authentication user_profile:840 - User accessing profile: new9 (ID: 10)
[2025-06-21 00:27:34,471] INFO authentication user_profile:845 - Profile data retrieved: {'id': 10, 'username': 'new9', 'email': 'new9@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T17:02:56.120981Z'}
[2025-06-21 00:29:04,313] INFO authentication register_user:115 - === User Registration ===
[2025-06-21 00:29:04,316] INFO authentication register_user:116 - Request data: {'username': 'new10', 'email': 'new10@gmail.com', 'first_name': 'new', 'last_name': 'new', 'password': 'new10@1234', 'password_confirm': 'new10@1234'}
[2025-06-21 00:29:04,917] INFO authentication register_user:121 - User registered successfully: new10 (ID: 11)
[2025-06-21 00:29:10,143] INFO authentication webauthn_register_begin:182 - === WebAuthn Registration Begin ===
[2025-06-21 00:29:10,143] INFO authentication webauthn_register_begin:183 - Request data: {'username': 'new10', 'display_name': 'new new'}
[2025-06-21 00:29:10,144] INFO authentication webauthn_register_begin:193 - Processing registration for user: new10, display_name: new new
[2025-06-21 00:29:10,148] INFO authentication webauthn_register_begin:200 - User found: new10 (ID: 11)
[2025-06-21 00:29:10,148] INFO authentication webauthn_register_begin:208 - Generating registration options...
[2025-06-21 00:29:10,148] INFO authentication webauthn_register_begin:209 - RP Name: Secure Dashboard
[2025-06-21 00:29:10,148] INFO authentication webauthn_register_begin:210 - RP ID: localhost
[2025-06-21 00:29:10,148] INFO authentication webauthn_register_begin:211 - User ID (bytes): b'new10'
[2025-06-21 00:29:10,155] INFO authentication webauthn_register_begin:224 - Registration options generated successfully
[2025-06-21 00:29:10,155] INFO authentication webauthn_register_begin:225 - Challenge (base64): ju9jJYdSnGtbBzsSvisgVyzEPvIKNxwkZgidzo/lRPlLnL4a82jnA+AE83zfpVGzW5XYNa8EFXdiqUJR37iLwg==
[2025-06-21 00:29:10,156] INFO authentication webauthn_register_begin:227 - Challenge length: 64 bytes
[2025-06-21 00:29:10,156] INFO authentication webauthn_register_begin:238 - Challenge stored with ID: 56d9323f-37f8-4514-9c10-684cd19aa552
[2025-06-21 00:29:10,156] INFO authentication webauthn_register_begin:239 - Total challenges in memory: 1
[2025-06-21 00:29:10,158] INFO authentication webauthn_register_begin:276 - Registration options converted to dictionary
[2025-06-21 00:29:10,158] INFO authentication webauthn_register_begin:277 - Options dict keys: ['challenge', 'rp', 'user', 'pubKeyCredParams', 'timeout', 'excludeCredentials', 'authenticatorSelection', 'attestation']
[2025-06-21 00:29:10,158] INFO authentication webauthn_register_begin:278 - User ID in options: bmV3MTA=
[2025-06-21 00:29:10,158] INFO authentication webauthn_register_begin:279 - Challenge in options: ju9jJYdSnGtbBzsSvisgVyzEPvIKNxwkZgidzo/lRPlLnL4a82jnA+AE83zfpVGzW5XYNa8EFXdiqUJR37iLwg==
[2025-06-21 00:29:10,158] INFO authentication webauthn_register_begin:286 - === WebAuthn Registration Begin Complete ===
[2025-06-21 00:29:10,160] INFO authentication webauthn_register_begin:287 - Response data: {'options': {'challenge': 'ju9jJYdSnGtbBzsSvisgVyzEPvIKNxwkZgidzo/lRPlLnL4a82jnA+AE83zfpVGzW5XYNa8EFXdiqUJR37iLwg==', 'rp': {'name': 'Secure Dashboard', 'id': 'localhost'}, 'user': {'id': 'bmV3MTA=', 'name': 'new10', 'displayName': 'new new'}, 'pubKeyCredParams': [{'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_256: -7>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.EDDSA: -8>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_512: -36>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_256: -37>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_384: -38>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_512: -39>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_256: -257>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_384: -258>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_512: -259>}], 'timeout': 60000, 'excludeCredentials': [], 'authenticatorSelection': {'authenticatorAttachment': None, 'requireResidentKey': False, 'residentKey': None, 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>}, 'attestation': <AttestationConveyancePreference.NONE: 'none'>}, 'challenge_id': '56d9323f-37f8-4514-9c10-684cd19aa552'}
[2025-06-21 00:29:42,567] INFO authentication webauthn_register_complete:295 - === WebAuthn Registration Complete ===
[2025-06-21 00:29:42,569] INFO authentication webauthn_register_complete:296 - Request data: {'username': 'new10', 'challenge_id': '56d9323f-37f8-4514-9c10-684cd19aa552', 'credential_id': '2qONK+7vg1JafPJrfBnFEw==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAENqjjSvu74NSWnzya3wZxROlAQIDJiABIVggzmV5o1fhEI9rlGPE/jtx3A0+zKVvvTCLS5SOJe+y7w8iWCCcGxq/nVCqSEEHzMaSvLO2+YWpj7MqwGKnCr2zyW+ibA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoianU5akpZZFNuR3RiQnpzU3Zpc2dWeXpFUHZJS054d2taZ2lkem9fbFJQbExuTDRhODJqbkEtQUU4M3pmcFZHelc1WFlOYThFRlhkaXFVSlIzN2lMd2ciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9'}
[2025-06-21 00:29:42,574] INFO authentication webauthn_register_complete:297 - Request data type: <class 'dict'>
[2025-06-21 00:29:42,576] INFO authentication webauthn_register_complete:298 - Request data keys: ['username', 'challenge_id', 'credential_id', 'attestation_object', 'client_data_json']
[2025-06-21 00:29:42,577] INFO authentication webauthn_register_complete:303 - Field 'username': type=<class 'str'>, length=5
[2025-06-21 00:29:42,578] INFO authentication webauthn_register_complete:303 - Field 'challenge_id': type=<class 'str'>, length=36
[2025-06-21 00:29:42,578] INFO authentication webauthn_register_complete:303 - Field 'credential_id': type=<class 'str'>, length=24
[2025-06-21 00:29:42,579] INFO authentication webauthn_register_complete:306 -   Value: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-21 00:29:42,579] INFO authentication webauthn_register_complete:308 -   Contains padding: True
[2025-06-21 00:29:42,579] INFO authentication webauthn_register_complete:309 -   Valid base64 length: True
[2025-06-21 00:29:42,579] INFO authentication webauthn_register_complete:303 - Field 'attestation_object': type=<class 'str'>, length=240
[2025-06-21 00:29:42,579] INFO authentication webauthn_register_complete:306 -   Value: o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAENqjjSvu74NSWnzya3wZxROlAQIDJiABIVggzmV5o1fhEI9rlGPE/jtx3A0+zKVvvTCLS5SOJe+y7w8iWCCcGxq/nVCqSEEHzMaSvLO2+YWpj7MqwGKnCr2zyW+ibA==
[2025-06-21 00:29:42,580] INFO authentication webauthn_register_complete:308 -   Contains padding: True
[2025-06-21 00:29:42,580] INFO authentication webauthn_register_complete:309 -   Valid base64 length: True
[2025-06-21 00:29:42,580] INFO authentication webauthn_register_complete:303 - Field 'client_data_json': type=<class 'str'>, length=240
[2025-06-21 00:29:42,580] INFO authentication webauthn_register_complete:306 -   Value: eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoianU5akpZZFNuR3RiQnpzU3Zpc2dWeXpFUHZJS054d2taZ2lkem9fbFJQbExuTDRhODJqbkEtQUU4M3pmcFZHelc1WFlOYThFRlhkaXFVSlIzN2lMd2ciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9
[2025-06-21 00:29:42,581] INFO authentication webauthn_register_complete:308 -   Contains padding: False
[2025-06-21 00:29:42,581] INFO authentication webauthn_register_complete:309 -   Valid base64 length: True
[2025-06-21 00:29:42,585] INFO authentication webauthn_register_complete:317 - Serializer validated successfully
[2025-06-21 00:29:42,593] INFO authentication webauthn_register_complete:318 - Validated data: {'username': 'new10', 'credential_id': '2qONK+7vg1JafPJrfBnFEw==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAENqjjSvu74NSWnzya3wZxROlAQIDJiABIVggzmV5o1fhEI9rlGPE/jtx3A0+zKVvvTCLS5SOJe+y7w8iWCCcGxq/nVCqSEEHzMaSvLO2+YWpj7MqwGKnCr2zyW+ibA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoianU5akpZZFNuR3RiQnpzU3Zpc2dWeXpFUHZJS054d2taZ2lkem9fbFJQbExuTDRhODJqbkEtQUU4M3pmcFZHelc1WFlOYThFRlhkaXFVSlIzN2lMd2ciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'transports': [], 'backup_eligible': False, 'backup_state': False}
[2025-06-21 00:29:42,597] INFO authentication webauthn_register_complete:321 - Challenge ID from request: 56d9323f-37f8-4514-9c10-684cd19aa552
[2025-06-21 00:29:42,602] INFO authentication webauthn_register_complete:334 - Retrieved stored challenge data:
[2025-06-21 00:29:42,604] INFO authentication webauthn_register_complete:335 -   - Challenge: ju9jJYdSnGtbBzsSvisgVyzEPvIKNxwkZgidzo/lRPlLnL4a82jnA+AE83zfpVGzW5XYNa8EFXdiqUJR37iLwg==
[2025-06-21 00:29:42,604] INFO authentication webauthn_register_complete:336 -   - Username: new10
[2025-06-21 00:29:42,604] INFO authentication webauthn_register_complete:337 -   - Type: registration
[2025-06-21 00:29:42,612] INFO authentication webauthn_register_complete:341 - User found: new10 (ID: 11)
[2025-06-21 00:29:42,613] INFO authentication webauthn_register_complete:347 - Starting verification for user: new10
[2025-06-21 00:29:42,615] INFO authentication webauthn_register_complete:348 - Challenge: ju9jJYdSnGtbBzsSvisgVyzEPvIKNxwkZgidzo/lRPlLnL4a82jnA+AE83zfpVGzW5XYNa8EFXdiqUJR37iLwg==
[2025-06-21 00:29:42,616] INFO authentication webauthn_register_complete:349 - RP ID: localhost
[2025-06-21 00:29:42,616] INFO authentication webauthn_register_complete:350 - Origin: http://localhost:5173
[2025-06-21 00:29:42,616] INFO authentication webauthn_register_complete:353 - Original credential_id: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-21 00:29:42,617] INFO authentication webauthn_register_complete:354 - Credential_id length: 24
[2025-06-21 00:29:42,617] INFO authentication webauthn_register_complete:355 - Credential_id contains padding: True
[2025-06-21 00:29:42,617] INFO authentication webauthn_register_complete:356 - Credential_id is valid base64: True
[2025-06-21 00:29:42,617] INFO authentication webauthn_register_complete:366 - Decoded raw_id length: 16 bytes
[2025-06-21 00:29:42,620] INFO authentication webauthn_register_complete:367 - Raw_id (hex): daa38d2beeef83525a7cf26b7c19c513
[2025-06-21 00:29:42,621] INFO authentication webauthn_register_complete:372 - Re-encoded credential_id: 2qONK-7vg1JafPJrfBnFEw
[2025-06-21 00:29:42,621] INFO authentication webauthn_register_complete:373 - Original vs re-encoded match: False
[2025-06-21 00:29:42,622] INFO authentication webauthn_register_complete:378 - Standard base64 encoded: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-21 00:29:42,622] INFO authentication webauthn_register_complete:379 - Original vs standard base64 match: True
[2025-06-21 00:29:42,622] INFO authentication webauthn_register_complete:387 - Attestation object length: 178 bytes
[2025-06-21 00:29:42,626] INFO authentication webauthn_register_complete:389 - Client data JSON length: 180 bytes
[2025-06-21 00:29:42,626] INFO authentication webauthn_register_complete:390 - Client data JSON content: {"type":"webauthn.create","challenge":"ju9jJYdSnGtbBzsSvisgVyzEPvIKNxwkZgidzo_lRPlLnL4a82jnA-AE83zfpVGzW5XYNa8EFXdiqUJR37iLwg","origin":"http://localhost:5173","crossOrigin":false}
[2025-06-21 00:29:42,627] INFO authentication webauthn_register_complete:396 - AuthenticatorAttestationResponse created successfully
[2025-06-21 00:29:42,629] INFO authentication webauthn_register_complete:401 - Converted credential_id to base64url: 2qONK-7vg1JafPJrfBnFEw
[2025-06-21 00:29:42,629] INFO authentication webauthn_register_complete:403 - Original vs base64url match: False
[2025-06-21 00:29:42,630] INFO authentication webauthn_register_complete:412 - RegistrationCredential created successfully
[2025-06-21 00:29:42,631] INFO authentication webauthn_register_complete:413 - Credential ID type: <class 'str'>
[2025-06-21 00:29:42,631] INFO authentication webauthn_register_complete:414 - Credential ID value: 2qONK-7vg1JafPJrfBnFEw
[2025-06-21 00:29:42,631] INFO authentication webauthn_register_complete:415 - Credential raw_id type: <class 'bytes'>
[2025-06-21 00:29:42,632] INFO authentication webauthn_register_complete:416 - Credential raw_id length: 16 bytes
[2025-06-21 00:29:42,632] INFO authentication webauthn_register_complete:418 - Credential raw_id (hex): daa38d2beeef83525a7cf26b7c19c513
[2025-06-21 00:29:42,632] INFO authentication webauthn_register_complete:419 - Credential type: public-key
[2025-06-21 00:29:42,632] INFO authentication webauthn_register_complete:423 - Base64url encoding of raw_id: 2qONK-7vg1JafPJrfBnFEw
[2025-06-21 00:29:42,632] INFO authentication webauthn_register_complete:424 - ID and base64url(raw_id) match: True
[2025-06-21 00:29:42,633] INFO authentication webauthn_register_complete:426 - ID and raw_id have correct types: True
[2025-06-21 00:29:42,636] INFO authentication webauthn_register_complete:429 - Starting verification with webauthn library...
[2025-06-21 00:29:42,867] INFO authentication webauthn_register_complete:437 - === Verification Successful ===
[2025-06-21 00:29:42,868] INFO authentication webauthn_register_complete:438 - Verification object: VerifiedRegistration(credential_id=b'\xda\xa3\x8d+\xee\xef\x83RZ|\xf2k|\x19\xc5\x13', credential_public_key=b'\xa5\x01\x02\x03& \x01!X \xceey\xa3W\xe1\x10\x8fk\x94c\xc4\xfe;q\xdc\r>\xcc\xa5o\xbd0\x8bK\x94\x8e%\xef\xb2\xef\x0f"X \x9c\x1b\x1a\xbf\x9dP\xaaHA\x07\xcc\xc6\x92\xbc\xb3\xb6\xf9\x85\xa9\x8f\xb3*\xc0b\xa7\n\xbd\xb3\xc9o\xa2l', sign_count=0, aaguid='00000000-0000-0000-0000-000000000000', fmt='none', credential_type='public-key', user_verified=True, attestation_object=b'\xa3cfmtdnonegattStmt\xa0hauthDataX\x94I\x96\r\xe5\x88\x0e\x8cht4\x17\x0fdv`[\x8f\xe4\xae\xb9\xa2\x862\xc7\x99\\\xf3\xba\x83\x1d\x97c]\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\xda\xa3\x8d+\xee\xef\x83RZ|\xf2k|\x19\xc5\x13\xa5\x01\x02\x03& \x01!X \xceey\xa3W\xe1\x10\x8fk\x94c\xc4\xfe;q\xdc\r>\xcc\xa5o\xbd0\x8bK\x94\x8e%\xef\xb2\xef\x0f"X \x9c\x1b\x1a\xbf\x9dP\xaaHA\x07\xcc\xc6\x92\xbc\xb3\xb6\xf9\x85\xa9\x8f\xb3*\xc0b\xa7\n\xbd\xb3\xc9o\xa2l', credential_device_type=<CredentialDeviceType.MULTI_DEVICE: 'multi_device'>, credential_backed_up=True)
[2025-06-21 00:29:42,868] INFO authentication webauthn_register_complete:439 - Sign count: 0
[2025-06-21 00:29:42,869] INFO authentication webauthn_register_complete:440 - Credential public key length: 77 bytes
[2025-06-21 00:29:42,869] INFO authentication webauthn_register_complete:442 - Credential public key (base64): pQECAyYgASFYIM5leaNX4RCPa5RjxP47cdwNPsylb70wi0uUjiXvsu8PIlggnBsav51QqkhBB8zGkryztvmFqY+zKsBipwq9s8lvomw=
[2025-06-21 00:29:42,887] INFO authentication webauthn_register_complete:457 - WebAuthnCredential saved to database:
[2025-06-21 00:29:42,887] INFO authentication webauthn_register_complete:458 -   - ID: 3
[2025-06-21 00:29:42,888] INFO authentication webauthn_register_complete:459 -   - User: new10
[2025-06-21 00:29:42,888] INFO authentication webauthn_register_complete:460 -   - Credential ID: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-21 00:29:42,889] INFO authentication webauthn_register_complete:461 -   - Sign count: 0
[2025-06-21 00:29:42,889] INFO authentication webauthn_register_complete:462 -   - Transports: []
[2025-06-21 00:29:42,889] INFO authentication webauthn_register_complete:465 - Challenge 56d9323f-37f8-4514-9c10-684cd19aa552 removed from memory
[2025-06-21 00:29:42,889] INFO authentication webauthn_register_complete:466 - Remaining challenges: 0
[2025-06-21 00:29:42,902] INFO authentication webauthn_register_complete:473 - === WebAuthn Registration Complete Success ===
[2025-06-21 00:29:42,902] INFO authentication webauthn_register_complete:474 - Response data: {'message': 'WebAuthn credential registered successfully', 'credential': {'id': 3, 'credential_id': '2qONK+7vg1JafPJrfBnFEw==', 'sign_count': 0, 'transports': [], 'backup_eligible': False, 'backup_state': False, 'created_at': '2025-06-20T18:59:42.873500Z', 'last_used_at': None}}
[2025-06-21 00:30:16,976] INFO authentication webauthn_authenticate_begin:492 - === WebAuthn Authentication Begin ===
[2025-06-21 00:30:16,977] INFO authentication webauthn_authenticate_begin:493 - Request data: {'username': 'new10'}
[2025-06-21 00:30:16,978] INFO authentication webauthn_authenticate_begin:512 - Processing authentication for user: new10
[2025-06-21 00:30:16,981] INFO authentication webauthn_authenticate_begin:517 - User found: new10 (ID: 11)
[2025-06-21 00:30:16,986] INFO authentication webauthn_authenticate_begin:526 - Found 1 credentials for user new10
[2025-06-21 00:30:16,991] INFO authentication webauthn_authenticate_begin:542 - Added credential: 2qONK+7vg1JafPJrfBnFEw== (transports: [])
[2025-06-21 00:30:16,991] INFO authentication webauthn_authenticate_begin:545 - Generating authentication options...
[2025-06-21 00:30:16,991] INFO authentication webauthn_authenticate_begin:546 - RP ID: localhost
[2025-06-21 00:30:16,991] INFO authentication webauthn_authenticate_begin:547 - Allow credentials count: 1
[2025-06-21 00:30:16,992] INFO authentication webauthn_authenticate_begin:555 - Authentication options generated successfully
[2025-06-21 00:30:16,992] INFO authentication webauthn_authenticate_begin:556 - Challenge (base64): p6y10o6ppfST9uQdtO/oFvooou/aUX3lQxSze9WHwqhjcErfAbR4myVjE3JjRd4L1bC/B4ouT7fk+fjclRNeqQ==
[2025-06-21 00:30:16,992] INFO authentication webauthn_authenticate_begin:558 - Challenge length: 64 bytes
[2025-06-21 00:30:16,992] INFO authentication webauthn_authenticate_begin:569 - Challenge stored with ID: fb7a2a66-90bd-4d6b-b88c-0ec19b8b0a34
[2025-06-21 00:30:16,993] INFO authentication webauthn_authenticate_begin:570 - Total challenges in memory: 1
[2025-06-21 00:30:16,993] INFO authentication webauthn_authenticate_begin:574 - Allow credential: {'id': '2qONK+7vg1JafPJrfBnFEw==', 'type': 'public-key', 'transports': []}
[2025-06-21 00:30:16,993] INFO authentication webauthn_authenticate_begin:575 - Allow credential id: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-21 00:30:16,993] INFO authentication webauthn_authenticate_begin:576 - Allow credential type: public-key
[2025-06-21 00:30:16,993] INFO authentication webauthn_authenticate_begin:577 - Allow credential transports: []
[2025-06-21 00:30:16,993] INFO authentication webauthn_authenticate_begin:593 - Authentication options converted to dictionary
[2025-06-21 00:30:16,994] INFO authentication webauthn_authenticate_begin:594 - Options dict keys: ['challenge', 'rpId', 'allowCredentials', 'userVerification', 'timeout']
[2025-06-21 00:30:16,994] INFO authentication webauthn_authenticate_begin:595 - Challenge in options: p6y10o6ppfST9uQdtO/oFvooou/aUX3lQxSze9WHwqhjcErfAbR4myVjE3JjRd4L1bC/B4ouT7fk+fjclRNeqQ==
[2025-06-21 00:30:16,994] INFO authentication webauthn_authenticate_begin:596 - Allow credentials count in options: 1
[2025-06-21 00:30:16,994] INFO authentication webauthn_authenticate_begin:604 - === WebAuthn Authentication Begin Complete ===
[2025-06-21 00:30:16,995] INFO authentication webauthn_authenticate_begin:605 - Response data: {'options': {'challenge': 'p6y10o6ppfST9uQdtO/oFvooou/aUX3lQxSze9WHwqhjcErfAbR4myVjE3JjRd4L1bC/B4ouT7fk+fjclRNeqQ==', 'rpId': 'localhost', 'allowCredentials': [{'type': 'public-key', 'id': '2qONK+7vg1JafPJrfBnFEw==', 'transports': []}], 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>, 'timeout': 60000}, 'challenge_id': 'fb7a2a66-90bd-4d6b-b88c-0ec19b8b0a34'}
[2025-06-21 00:30:34,916] INFO authentication webauthn_authenticate_complete:614 - === WebAuthn Authentication Complete ===
[2025-06-21 00:30:34,916] INFO authentication webauthn_authenticate_complete:615 - Request data: {'username': 'new10', 'challenge_id': 'fb7a2a66-90bd-4d6b-b88c-0ec19b8b0a34', 'credential_id': '2qONK+7vg1JafPJrfBnFEw==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoicDZ5MTBvNnBwZlNUOXVRZHRPX29Gdm9vb3VfYVVYM2xReFN6ZTlXSHdxaGpjRXJmQWJSNG15VmpFM0pqUmQ0TDFiQ19CNG91VDdmay1mamNsUk5lcVEiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2UsIm90aGVyX2tleXNfY2FuX2JlX2FkZGVkX2hlcmUiOiJkbyBub3QgY29tcGFyZSBjbGllbnREYXRhSlNPTiBhZ2FpbnN0IGEgdGVtcGxhdGUuIFNlZSBodHRwczovL2dvby5nbC95YWJQZXgifQ==', 'signature': 'MEUCIQD+e3xTifg2nnakEMEpM+064WugnJgclDZbroxLc1zeHgIgQLLV87uXuASL4i89dyrBBi2CjTq0nNgtC+nDsVjMfqE='}
[2025-06-21 00:30:34,919] INFO authentication webauthn_authenticate_complete:625 - Serializer validated successfully
[2025-06-21 00:30:34,919] INFO authentication webauthn_authenticate_complete:626 - Validated data: {'username': 'new10', 'credential_id': '2qONK+7vg1JafPJrfBnFEw==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoicDZ5MTBvNnBwZlNUOXVRZHRPX29Gdm9vb3VfYVVYM2xReFN6ZTlXSHdxaGpjRXJmQWJSNG15VmpFM0pqUmQ0TDFiQ19CNG91VDdmay1mamNsUk5lcVEiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2UsIm90aGVyX2tleXNfY2FuX2JlX2FkZGVkX2hlcmUiOiJkbyBub3QgY29tcGFyZSBjbGllbnREYXRhSlNPTiBhZ2FpbnN0IGEgdGVtcGxhdGUuIFNlZSBodHRwczovL2dvby5nbC95YWJQZXgifQ==', 'signature': 'MEUCIQD+e3xTifg2nnakEMEpM+064WugnJgclDZbroxLc1zeHgIgQLLV87uXuASL4i89dyrBBi2CjTq0nNgtC+nDsVjMfqE='}
[2025-06-21 00:30:34,920] INFO authentication webauthn_authenticate_complete:664 - Challenge ID from request: fb7a2a66-90bd-4d6b-b88c-0ec19b8b0a34
[2025-06-21 00:30:34,920] INFO authentication webauthn_authenticate_complete:679 - Retrieved stored challenge data:
[2025-06-21 00:30:34,920] INFO authentication webauthn_authenticate_complete:680 -   - Challenge: p6y10o6ppfST9uQdtO/oFvooou/aUX3lQxSze9WHwqhjcErfAbR4myVjE3JjRd4L1bC/B4ouT7fk+fjclRNeqQ==
[2025-06-21 00:30:34,920] INFO authentication webauthn_authenticate_complete:681 -   - Username: new10
[2025-06-21 00:30:34,921] INFO authentication webauthn_authenticate_complete:682 -   - Type: authentication
[2025-06-21 00:30:34,924] INFO authentication webauthn_authenticate_complete:687 - User found: new10 (ID: 11)
[2025-06-21 00:30:34,928] INFO authentication webauthn_authenticate_complete:700 - Credential found: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-21 00:30:34,928] INFO authentication webauthn_authenticate_complete:701 - Credential public key length: 77 bytes
[2025-06-21 00:30:34,928] INFO authentication webauthn_authenticate_complete:703 - Credential sign count: 0
[2025-06-21 00:30:34,928] INFO authentication webauthn_authenticate_complete:713 - Starting authentication verification...
[2025-06-21 00:30:34,930] INFO authentication webauthn_authenticate_complete:714 - Challenge: p6y10o6ppfST9uQdtO/oFvooou/aUX3lQxSze9WHwqhjcErfAbR4myVjE3JjRd4L1bC/B4ouT7fk+fjclRNeqQ==
[2025-06-21 00:30:34,930] INFO authentication webauthn_authenticate_complete:715 - RP ID: localhost
[2025-06-21 00:30:34,930] INFO authentication webauthn_authenticate_complete:716 - Origin: http://localhost:5173
[2025-06-21 00:30:34,930] INFO authentication webauthn_authenticate_complete:721 - Decoded credential_id length: 16 bytes
[2025-06-21 00:30:34,930] INFO authentication webauthn_authenticate_complete:723 - Decoded credential_id (hex): daa38d2beeef83525a7cf26b7c19c513
[2025-06-21 00:30:34,931] INFO authentication webauthn_authenticate_complete:728 - Re-encoded credential_id: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-21 00:30:34,931] INFO authentication webauthn_authenticate_complete:729 - Original vs re-encoded match: True
[2025-06-21 00:30:34,933] INFO authentication webauthn_authenticate_complete:735 - URL-safe encoded credential_id: 2qONK-7vg1JafPJrfBnFEw
[2025-06-21 00:30:34,933] INFO authentication webauthn_authenticate_complete:736 - Original vs urlsafe match: False
[2025-06-21 00:30:34,933] INFO authentication webauthn_authenticate_complete:742 - Converted credential_id to base64url: 2qONK-7vg1JafPJrfBnFEw
[2025-06-21 00:30:34,933] INFO authentication webauthn_authenticate_complete:753 - AuthenticatorAssertionResponse created successfully
[2025-06-21 00:30:34,935] INFO authentication webauthn_authenticate_complete:761 - AuthenticationCredential created successfully
[2025-06-21 00:30:34,935] INFO authentication webauthn_authenticate_complete:762 - Credential ID type: <class 'str'>
[2025-06-21 00:30:34,936] INFO authentication webauthn_authenticate_complete:763 - Credential ID value: 2qONK-7vg1JafPJrfBnFEw
[2025-06-21 00:30:34,936] INFO authentication webauthn_authenticate_complete:764 - Credential raw_id type: <class 'bytes'>
[2025-06-21 00:30:34,936] INFO authentication webauthn_authenticate_complete:765 - Credential raw_id length: 16 bytes
[2025-06-21 00:30:34,936] INFO authentication webauthn_authenticate_complete:767 - Credential raw_id (hex): daa38d2beeef83525a7cf26b7c19c513
[2025-06-21 00:30:34,936] INFO authentication webauthn_authenticate_complete:768 - Credential type: public-key
[2025-06-21 00:30:34,936] INFO authentication webauthn_authenticate_complete:772 - Base64url encoding of raw_id: 2qONK-7vg1JafPJrfBnFEw
[2025-06-21 00:30:34,937] INFO authentication webauthn_authenticate_complete:773 - ID and base64url(raw_id) match: True
[2025-06-21 00:30:34,937] INFO authentication webauthn_authenticate_complete:774 - ID and raw_id have correct types: True
[2025-06-21 00:30:34,937] INFO authentication webauthn_authenticate_complete:776 - Starting verification with webauthn library...
[2025-06-21 00:30:34,961] INFO authentication webauthn_authenticate_complete:786 - === Authentication Verification Successful ===
[2025-06-21 00:30:34,961] INFO authentication webauthn_authenticate_complete:787 - Verification object: VerifiedAuthentication(credential_id=b'\xda\xa3\x8d+\xee\xef\x83RZ|\xf2k|\x19\xc5\x13', new_sign_count=0, credential_device_type=<CredentialDeviceType.MULTI_DEVICE: 'multi_device'>, credential_backed_up=True, user_verified=True)
[2025-06-21 00:30:34,961] INFO authentication webauthn_authenticate_complete:788 - New sign count: 0
[2025-06-21 00:30:34,961] INFO authentication webauthn_authenticate_complete:789 - Previous sign count: 0
[2025-06-21 00:30:34,981] INFO authentication webauthn_authenticate_complete:795 - Credential updated - new sign count: 0
[2025-06-21 00:30:35,004] INFO authentication webauthn_authenticate_complete:800 - User new10 logged in successfully
[2025-06-21 00:30:35,016] INFO authentication webauthn_authenticate_complete:804 - JWT tokens generated successfully
[2025-06-21 00:30:35,017] INFO authentication webauthn_authenticate_complete:808 - Challenge fb7a2a66-90bd-4d6b-b88c-0ec19b8b0a34 removed from memory
[2025-06-21 00:30:35,017] INFO authentication webauthn_authenticate_complete:809 - Remaining challenges: 0
[2025-06-21 00:30:35,018] INFO authentication webauthn_authenticate_complete:820 - === WebAuthn Authentication Complete Success ===
[2025-06-21 00:30:35,018] INFO authentication webauthn_authenticate_complete:821 - Response data: {'message': 'Authentication successful', 'user': {'id': 11, 'username': 'new10', 'email': 'new10@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T18:59:04.441424Z'}, 'tokens': {'access': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzUwNDQ5NjM1LCJpYXQiOjE3NTA0NDYwMzUsImp0aSI6ImI0NjY3YTMxNjQ4OTQyODI4NWY3NjYxMGNhYTA0ZjA2IiwidXNlcl9pZCI6MTF9.Q5ZoEa6_ktH2eWIC5sYazGpIfyqpWtlMtozC-9tuM6g', 'refresh': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTc1MDUzMjQzNSwiaWF0IjoxNzUwNDQ2MDM1LCJqdGkiOiI4OGMzMmI0ODdhN2I0NWNkOGE4MWJhNGExNDk5MDUzMSIsInVzZXJfaWQiOjExfQ.2L3tidQeDhgzteJEfarU6SnUjik5pLYoeXYUYj-8gds'}}
[2025-06-21 00:30:35,071] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 00:30:35,072] INFO authentication user_profile:840 - User accessing profile: new10 (ID: 11)
[2025-06-21 00:30:35,072] INFO authentication user_profile:845 - Profile data retrieved: {'id': 11, 'username': 'new10', 'email': 'new10@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T18:59:04.441424Z'}
[2025-06-21 00:30:35,084] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 00:30:35,084] INFO authentication user_profile:840 - User accessing profile: new10 (ID: 11)
[2025-06-21 00:30:35,086] INFO authentication user_profile:845 - Profile data retrieved: {'id': 11, 'username': 'new10', 'email': 'new10@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T18:59:04.441424Z'}
[2025-06-21 00:31:13,496] INFO authentication register_user:115 - === User Registration ===
[2025-06-21 00:31:13,496] INFO authentication register_user:116 - Request data: {'username': 'new11', 'email': 'new11@gmail.com', 'first_name': 'new', 'last_name': 'new', 'password': 'new11@1234', 'password_confirm': 'new11@1234'}
[2025-06-21 00:31:13,884] INFO authentication register_user:121 - User registered successfully: new11 (ID: 12)
[2025-06-21 00:31:15,213] INFO authentication webauthn_register_begin:182 - === WebAuthn Registration Begin ===
[2025-06-21 00:31:15,213] INFO authentication webauthn_register_begin:183 - Request data: {'username': 'new11', 'display_name': 'new new'}
[2025-06-21 00:31:15,213] INFO authentication webauthn_register_begin:193 - Processing registration for user: new11, display_name: new new
[2025-06-21 00:31:15,219] INFO authentication webauthn_register_begin:200 - User found: new11 (ID: 12)
[2025-06-21 00:31:15,219] INFO authentication webauthn_register_begin:208 - Generating registration options...
[2025-06-21 00:31:15,221] INFO authentication webauthn_register_begin:209 - RP Name: Secure Dashboard
[2025-06-21 00:31:15,221] INFO authentication webauthn_register_begin:210 - RP ID: localhost
[2025-06-21 00:31:15,221] INFO authentication webauthn_register_begin:211 - User ID (bytes): b'new11'
[2025-06-21 00:31:15,222] INFO authentication webauthn_register_begin:224 - Registration options generated successfully
[2025-06-21 00:31:15,222] INFO authentication webauthn_register_begin:225 - Challenge (base64): juSjftRKHOBmfwogbQLTBuo1gyfSn6IQz6iUriAbexy1Hvrw5L7G2Zzmbm6Bi/7cpteZ3hbY4NoXMrNgyzPrdg==
[2025-06-21 00:31:15,222] INFO authentication webauthn_register_begin:227 - Challenge length: 64 bytes
[2025-06-21 00:31:15,223] INFO authentication webauthn_register_begin:238 - Challenge stored with ID: b6755a19-8c9a-4d1e-bec4-a0303e2e10d3
[2025-06-21 00:31:15,223] INFO authentication webauthn_register_begin:239 - Total challenges in memory: 1
[2025-06-21 00:31:15,223] INFO authentication webauthn_register_begin:276 - Registration options converted to dictionary
[2025-06-21 00:31:15,223] INFO authentication webauthn_register_begin:277 - Options dict keys: ['challenge', 'rp', 'user', 'pubKeyCredParams', 'timeout', 'excludeCredentials', 'authenticatorSelection', 'attestation']
[2025-06-21 00:31:15,223] INFO authentication webauthn_register_begin:278 - User ID in options: bmV3MTE=
[2025-06-21 00:31:15,224] INFO authentication webauthn_register_begin:279 - Challenge in options: juSjftRKHOBmfwogbQLTBuo1gyfSn6IQz6iUriAbexy1Hvrw5L7G2Zzmbm6Bi/7cpteZ3hbY4NoXMrNgyzPrdg==
[2025-06-21 00:31:15,224] INFO authentication webauthn_register_begin:286 - === WebAuthn Registration Begin Complete ===
[2025-06-21 00:31:15,224] INFO authentication webauthn_register_begin:287 - Response data: {'options': {'challenge': 'juSjftRKHOBmfwogbQLTBuo1gyfSn6IQz6iUriAbexy1Hvrw5L7G2Zzmbm6Bi/7cpteZ3hbY4NoXMrNgyzPrdg==', 'rp': {'name': 'Secure Dashboard', 'id': 'localhost'}, 'user': {'id': 'bmV3MTE=', 'name': 'new11', 'displayName': 'new new'}, 'pubKeyCredParams': [{'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_256: -7>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.EDDSA: -8>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_512: -36>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_256: -37>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_384: -38>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_512: -39>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_256: -257>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_384: -258>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_512: -259>}], 'timeout': 60000, 'excludeCredentials': [], 'authenticatorSelection': {'authenticatorAttachment': None, 'requireResidentKey': False, 'residentKey': None, 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>}, 'attestation': <AttestationConveyancePreference.NONE: 'none'>}, 'challenge_id': 'b6755a19-8c9a-4d1e-bec4-a0303e2e10d3'}
[2025-06-21 00:36:33,742] INFO authentication register_user:115 - === User Registration ===
[2025-06-21 00:36:33,744] INFO authentication register_user:116 - Request data: {'username': 'sam', 'email': 'sam@gmail.com', 'first_name': 'sam', 'last_name': 'sam', 'password': 'sam@12345', 'password_confirm': 'sam@12345'}
[2025-06-21 00:36:34,236] INFO authentication register_user:121 - User registered successfully: sam (ID: 13)
[2025-06-21 00:36:36,072] INFO authentication webauthn_register_begin:182 - === WebAuthn Registration Begin ===
[2025-06-21 00:36:36,073] INFO authentication webauthn_register_begin:183 - Request data: {'username': 'sam', 'display_name': 'sam sam'}
[2025-06-21 00:36:36,074] INFO authentication webauthn_register_begin:193 - Processing registration for user: sam, display_name: sam sam
[2025-06-21 00:36:36,079] INFO authentication webauthn_register_begin:200 - User found: sam (ID: 13)
[2025-06-21 00:36:36,079] INFO authentication webauthn_register_begin:208 - Generating registration options...
[2025-06-21 00:36:36,079] INFO authentication webauthn_register_begin:209 - RP Name: Secure Dashboard
[2025-06-21 00:36:36,080] INFO authentication webauthn_register_begin:210 - RP ID: localhost
[2025-06-21 00:36:36,080] INFO authentication webauthn_register_begin:211 - User ID (bytes): b'sam'
[2025-06-21 00:36:36,081] INFO authentication webauthn_register_begin:224 - Registration options generated successfully
[2025-06-21 00:36:36,081] INFO authentication webauthn_register_begin:225 - Challenge (base64): lvZJEk16RAuSIM2iwU36X8SyE749LmPrv/Rbli2UwmFVCfG/QDbU6WGvyKDmWpGDmAR1cEJnEpacvQtwiyQHYw==
[2025-06-21 00:36:36,082] INFO authentication webauthn_register_begin:227 - Challenge length: 64 bytes
[2025-06-21 00:36:36,082] INFO authentication webauthn_register_begin:238 - Challenge stored with ID: 8e257fcb-7a85-4fec-91b5-e42f067806ea
[2025-06-21 00:36:36,082] INFO authentication webauthn_register_begin:239 - Total challenges in memory: 2
[2025-06-21 00:36:36,084] INFO authentication webauthn_register_begin:276 - Registration options converted to dictionary
[2025-06-21 00:36:36,085] INFO authentication webauthn_register_begin:277 - Options dict keys: ['challenge', 'rp', 'user', 'pubKeyCredParams', 'timeout', 'excludeCredentials', 'authenticatorSelection', 'attestation']
[2025-06-21 00:36:36,085] INFO authentication webauthn_register_begin:278 - User ID in options: c2Ft
[2025-06-21 00:36:36,085] INFO authentication webauthn_register_begin:279 - Challenge in options: lvZJEk16RAuSIM2iwU36X8SyE749LmPrv/Rbli2UwmFVCfG/QDbU6WGvyKDmWpGDmAR1cEJnEpacvQtwiyQHYw==
[2025-06-21 00:36:36,086] INFO authentication webauthn_register_begin:286 - === WebAuthn Registration Begin Complete ===
[2025-06-21 00:36:36,086] INFO authentication webauthn_register_begin:287 - Response data: {'options': {'challenge': 'lvZJEk16RAuSIM2iwU36X8SyE749LmPrv/Rbli2UwmFVCfG/QDbU6WGvyKDmWpGDmAR1cEJnEpacvQtwiyQHYw==', 'rp': {'name': 'Secure Dashboard', 'id': 'localhost'}, 'user': {'id': 'c2Ft', 'name': 'sam', 'displayName': 'sam sam'}, 'pubKeyCredParams': [{'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_256: -7>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.EDDSA: -8>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.ECDSA_SHA_512: -36>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_256: -37>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_384: -38>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PSS_SHA_512: -39>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_256: -257>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_384: -258>}, {'type': 'public-key', 'alg': <COSEAlgorithmIdentifier.RSASSA_PKCS1_v1_5_SHA_512: -259>}], 'timeout': 60000, 'excludeCredentials': [], 'authenticatorSelection': {'authenticatorAttachment': None, 'requireResidentKey': False, 'residentKey': None, 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>}, 'attestation': <AttestationConveyancePreference.NONE: 'none'>}, 'challenge_id': '8e257fcb-7a85-4fec-91b5-e42f067806ea'}
[2025-06-21 00:37:51,038] INFO authentication webauthn_register_complete:295 - === WebAuthn Registration Complete ===
[2025-06-21 00:37:51,038] INFO authentication webauthn_register_complete:296 - Request data: {'username': 'sam', 'challenge_id': '8e257fcb-7a85-4fec-91b5-e42f067806ea', 'credential_id': 'bqTYzPI9X+vQT5X/DMHRXw==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEG6k2MzyPV/r0E+V/wzB0V+lAQIDJiABIVggVlQGnz6rEyhWeCCDseDJnk2OzSxK6n/i8Edg/W3BzIciWCAbXlaF4c1ddkfezUMKJ+2aNkXtcDRBJmIj9NPp1/k2lA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoibHZaSkVrMTZSQXVTSU0yaXdVMzZYOFN5RTc0OUxtUHJ2X1JibGkyVXdtRlZDZkdfUURiVTZXR3Z5S0RtV3BHRG1BUjFjRUpuRXBhY3ZRdHdpeVFIWXciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9'}
[2025-06-21 00:37:51,038] INFO authentication webauthn_register_complete:297 - Request data type: <class 'dict'>
[2025-06-21 00:37:51,038] INFO authentication webauthn_register_complete:298 - Request data keys: ['username', 'challenge_id', 'credential_id', 'attestation_object', 'client_data_json']
[2025-06-21 00:37:51,039] INFO authentication webauthn_register_complete:303 - Field 'username': type=<class 'str'>, length=3
[2025-06-21 00:37:51,039] INFO authentication webauthn_register_complete:303 - Field 'challenge_id': type=<class 'str'>, length=36
[2025-06-21 00:37:51,039] INFO authentication webauthn_register_complete:303 - Field 'credential_id': type=<class 'str'>, length=24
[2025-06-21 00:37:51,039] INFO authentication webauthn_register_complete:306 -   Value: bqTYzPI9X+vQT5X/DMHRXw==
[2025-06-21 00:37:51,040] INFO authentication webauthn_register_complete:308 -   Contains padding: True
[2025-06-21 00:37:51,040] INFO authentication webauthn_register_complete:309 -   Valid base64 length: True
[2025-06-21 00:37:51,040] INFO authentication webauthn_register_complete:303 - Field 'attestation_object': type=<class 'str'>, length=240
[2025-06-21 00:37:51,040] INFO authentication webauthn_register_complete:306 -   Value: o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEG6k2MzyPV/r0E+V/wzB0V+lAQIDJiABIVggVlQGnz6rEyhWeCCDseDJnk2OzSxK6n/i8Edg/W3BzIciWCAbXlaF4c1ddkfezUMKJ+2aNkXtcDRBJmIj9NPp1/k2lA==
[2025-06-21 00:37:51,040] INFO authentication webauthn_register_complete:308 -   Contains padding: True
[2025-06-21 00:37:51,041] INFO authentication webauthn_register_complete:309 -   Valid base64 length: True
[2025-06-21 00:37:51,041] INFO authentication webauthn_register_complete:303 - Field 'client_data_json': type=<class 'str'>, length=240
[2025-06-21 00:37:51,041] INFO authentication webauthn_register_complete:306 -   Value: eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoibHZaSkVrMTZSQXVTSU0yaXdVMzZYOFN5RTc0OUxtUHJ2X1JibGkyVXdtRlZDZkdfUURiVTZXR3Z5S0RtV3BHRG1BUjFjRUpuRXBhY3ZRdHdpeVFIWXciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9
[2025-06-21 00:37:51,041] INFO authentication webauthn_register_complete:308 -   Contains padding: False
[2025-06-21 00:37:51,041] INFO authentication webauthn_register_complete:309 -   Valid base64 length: True
[2025-06-21 00:37:51,042] INFO authentication webauthn_register_complete:317 - Serializer validated successfully
[2025-06-21 00:37:51,043] INFO authentication webauthn_register_complete:318 - Validated data: {'username': 'sam', 'credential_id': 'bqTYzPI9X+vQT5X/DMHRXw==', 'attestation_object': 'o2NmbXRkbm9uZWdhdHRTdG10oGhhdXRoRGF0YViUSZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2NdAAAAAAAAAAAAAAAAAAAAAAAAAAAAEG6k2MzyPV/r0E+V/wzB0V+lAQIDJiABIVggVlQGnz6rEyhWeCCDseDJnk2OzSxK6n/i8Edg/W3BzIciWCAbXlaF4c1ddkfezUMKJ+2aNkXtcDRBJmIj9NPp1/k2lA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uY3JlYXRlIiwiY2hhbGxlbmdlIjoibHZaSkVrMTZSQXVTSU0yaXdVMzZYOFN5RTc0OUxtUHJ2X1JibGkyVXdtRlZDZkdfUURiVTZXR3Z5S0RtV3BHRG1BUjFjRUpuRXBhY3ZRdHdpeVFIWXciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'transports': [], 'backup_eligible': False, 'backup_state': False}
[2025-06-21 00:37:51,043] INFO authentication webauthn_register_complete:321 - Challenge ID from request: 8e257fcb-7a85-4fec-91b5-e42f067806ea
[2025-06-21 00:37:51,043] INFO authentication webauthn_register_complete:334 - Retrieved stored challenge data:
[2025-06-21 00:37:51,043] INFO authentication webauthn_register_complete:335 -   - Challenge: lvZJEk16RAuSIM2iwU36X8SyE749LmPrv/Rbli2UwmFVCfG/QDbU6WGvyKDmWpGDmAR1cEJnEpacvQtwiyQHYw==
[2025-06-21 00:37:51,045] INFO authentication webauthn_register_complete:336 -   - Username: sam
[2025-06-21 00:37:51,045] INFO authentication webauthn_register_complete:337 -   - Type: registration
[2025-06-21 00:37:51,048] INFO authentication webauthn_register_complete:341 - User found: sam (ID: 13)
[2025-06-21 00:37:51,048] INFO authentication webauthn_register_complete:347 - Starting verification for user: sam
[2025-06-21 00:37:51,048] INFO authentication webauthn_register_complete:348 - Challenge: lvZJEk16RAuSIM2iwU36X8SyE749LmPrv/Rbli2UwmFVCfG/QDbU6WGvyKDmWpGDmAR1cEJnEpacvQtwiyQHYw==
[2025-06-21 00:37:51,048] INFO authentication webauthn_register_complete:349 - RP ID: localhost
[2025-06-21 00:37:51,048] INFO authentication webauthn_register_complete:350 - Origin: http://localhost:5173
[2025-06-21 00:37:51,048] INFO authentication webauthn_register_complete:353 - Original credential_id: bqTYzPI9X+vQT5X/DMHRXw==
[2025-06-21 00:37:51,048] INFO authentication webauthn_register_complete:354 - Credential_id length: 24
[2025-06-21 00:37:51,049] INFO authentication webauthn_register_complete:355 - Credential_id contains padding: True
[2025-06-21 00:37:51,049] INFO authentication webauthn_register_complete:356 - Credential_id is valid base64: True
[2025-06-21 00:37:51,050] INFO authentication webauthn_register_complete:366 - Decoded raw_id length: 16 bytes
[2025-06-21 00:37:51,051] INFO authentication webauthn_register_complete:367 - Raw_id (hex): 6ea4d8ccf23d5febd04f95ff0cc1d15f
[2025-06-21 00:37:51,051] INFO authentication webauthn_register_complete:372 - Re-encoded credential_id: bqTYzPI9X-vQT5X_DMHRXw
[2025-06-21 00:37:51,052] INFO authentication webauthn_register_complete:373 - Original vs re-encoded match: False
[2025-06-21 00:37:51,052] INFO authentication webauthn_register_complete:378 - Standard base64 encoded: bqTYzPI9X+vQT5X/DMHRXw==
[2025-06-21 00:37:51,052] INFO authentication webauthn_register_complete:379 - Original vs standard base64 match: True
[2025-06-21 00:37:51,052] INFO authentication webauthn_register_complete:387 - Attestation object length: 178 bytes
[2025-06-21 00:37:51,052] INFO authentication webauthn_register_complete:389 - Client data JSON length: 180 bytes
[2025-06-21 00:37:51,053] INFO authentication webauthn_register_complete:390 - Client data JSON content: {"type":"webauthn.create","challenge":"lvZJEk16RAuSIM2iwU36X8SyE749LmPrv_Rbli2UwmFVCfG_QDbU6WGvyKDmWpGDmAR1cEJnEpacvQtwiyQHYw","origin":"http://localhost:5173","crossOrigin":false}
[2025-06-21 00:37:51,053] INFO authentication webauthn_register_complete:396 - AuthenticatorAttestationResponse created successfully
[2025-06-21 00:37:51,054] INFO authentication webauthn_register_complete:401 - Converted credential_id to base64url: bqTYzPI9X-vQT5X_DMHRXw
[2025-06-21 00:37:51,054] INFO authentication webauthn_register_complete:403 - Original vs base64url match: False
[2025-06-21 00:37:51,054] INFO authentication webauthn_register_complete:412 - RegistrationCredential created successfully
[2025-06-21 00:37:51,054] INFO authentication webauthn_register_complete:413 - Credential ID type: <class 'str'>
[2025-06-21 00:37:51,054] INFO authentication webauthn_register_complete:414 - Credential ID value: bqTYzPI9X-vQT5X_DMHRXw
[2025-06-21 00:37:51,054] INFO authentication webauthn_register_complete:415 - Credential raw_id type: <class 'bytes'>
[2025-06-21 00:37:51,054] INFO authentication webauthn_register_complete:416 - Credential raw_id length: 16 bytes
[2025-06-21 00:37:51,056] INFO authentication webauthn_register_complete:418 - Credential raw_id (hex): 6ea4d8ccf23d5febd04f95ff0cc1d15f
[2025-06-21 00:37:51,056] INFO authentication webauthn_register_complete:419 - Credential type: public-key
[2025-06-21 00:37:51,056] INFO authentication webauthn_register_complete:423 - Base64url encoding of raw_id: bqTYzPI9X-vQT5X_DMHRXw
[2025-06-21 00:37:51,056] INFO authentication webauthn_register_complete:424 - ID and base64url(raw_id) match: True
[2025-06-21 00:37:51,056] INFO authentication webauthn_register_complete:426 - ID and raw_id have correct types: True
[2025-06-21 00:37:51,056] INFO authentication webauthn_register_complete:429 - Starting verification with webauthn library...
[2025-06-21 00:37:51,061] INFO authentication webauthn_register_complete:437 - === Verification Successful ===
[2025-06-21 00:37:51,061] INFO authentication webauthn_register_complete:438 - Verification object: VerifiedRegistration(credential_id=b'n\xa4\xd8\xcc\xf2=_\xeb\xd0O\x95\xff\x0c\xc1\xd1_', credential_public_key=b'\xa5\x01\x02\x03& \x01!X VT\x06\x9f>\xab\x13(Vx \x83\xb1\xe0\xc9\x9eM\x8e\xcd,J\xea\x7f\xe2\xf0G`\xfdm\xc1\xcc\x87"X \x1b^V\x85\xe1\xcd]vG\xde\xcdC\n\'\xed\x9a6E\xedp4A&b#\xf4\xd3\xe9\xd7\xf96\x94', sign_count=0, aaguid='00000000-0000-0000-0000-000000000000', fmt='none', credential_type='public-key', user_verified=True, attestation_object=b'\xa3cfmtdnonegattStmt\xa0hauthDataX\x94I\x96\r\xe5\x88\x0e\x8cht4\x17\x0fdv`[\x8f\xe4\xae\xb9\xa2\x862\xc7\x99\\\xf3\xba\x83\x1d\x97c]\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10n\xa4\xd8\xcc\xf2=_\xeb\xd0O\x95\xff\x0c\xc1\xd1_\xa5\x01\x02\x03& \x01!X VT\x06\x9f>\xab\x13(Vx \x83\xb1\xe0\xc9\x9eM\x8e\xcd,J\xea\x7f\xe2\xf0G`\xfdm\xc1\xcc\x87"X \x1b^V\x85\xe1\xcd]vG\xde\xcdC\n\'\xed\x9a6E\xedp4A&b#\xf4\xd3\xe9\xd7\xf96\x94', credential_device_type=<CredentialDeviceType.MULTI_DEVICE: 'multi_device'>, credential_backed_up=True)
[2025-06-21 00:37:51,062] INFO authentication webauthn_register_complete:439 - Sign count: 0
[2025-06-21 00:37:51,062] INFO authentication webauthn_register_complete:440 - Credential public key length: 77 bytes
[2025-06-21 00:37:51,062] INFO authentication webauthn_register_complete:442 - Credential public key (base64): pQECAyYgASFYIFZUBp8+qxMoVnggg7HgyZ5Njs0sSup/4vBHYP1twcyHIlggG15WheHNXXZH3s1DCiftmjZF7XA0QSZiI/TT6df5NpQ=
[2025-06-21 00:37:51,073] INFO authentication webauthn_register_complete:457 - WebAuthnCredential saved to database:
[2025-06-21 00:37:51,074] INFO authentication webauthn_register_complete:458 -   - ID: 4
[2025-06-21 00:37:51,074] INFO authentication webauthn_register_complete:459 -   - User: sam
[2025-06-21 00:37:51,074] INFO authentication webauthn_register_complete:460 -   - Credential ID: bqTYzPI9X+vQT5X/DMHRXw==
[2025-06-21 00:37:51,074] INFO authentication webauthn_register_complete:461 -   - Sign count: 0
[2025-06-21 00:37:51,074] INFO authentication webauthn_register_complete:462 -   - Transports: []
[2025-06-21 00:37:51,074] INFO authentication webauthn_register_complete:465 - Challenge 8e257fcb-7a85-4fec-91b5-e42f067806ea removed from memory
[2025-06-21 00:37:51,074] INFO authentication webauthn_register_complete:466 - Remaining challenges: 1
[2025-06-21 00:37:51,077] INFO authentication webauthn_register_complete:473 - === WebAuthn Registration Complete Success ===
[2025-06-21 00:37:51,077] INFO authentication webauthn_register_complete:474 - Response data: {'message': 'WebAuthn credential registered successfully', 'credential': {'id': 4, 'credential_id': 'bqTYzPI9X+vQT5X/DMHRXw==', 'sign_count': 0, 'transports': [], 'backup_eligible': False, 'backup_state': False, 'created_at': '2025-06-20T19:07:51.064330Z', 'last_used_at': None}}
[2025-06-21 00:37:59,424] INFO authentication webauthn_authenticate_begin:492 - === WebAuthn Authentication Begin ===
[2025-06-21 00:37:59,424] INFO authentication webauthn_authenticate_begin:493 - Request data: {'username': 'sam'}
[2025-06-21 00:37:59,426] INFO authentication webauthn_authenticate_begin:512 - Processing authentication for user: sam
[2025-06-21 00:37:59,429] INFO authentication webauthn_authenticate_begin:517 - User found: sam (ID: 13)
[2025-06-21 00:37:59,434] INFO authentication webauthn_authenticate_begin:526 - Found 1 credentials for user sam
[2025-06-21 00:37:59,438] INFO authentication webauthn_authenticate_begin:542 - Added credential: bqTYzPI9X+vQT5X/DMHRXw== (transports: [])
[2025-06-21 00:37:59,438] INFO authentication webauthn_authenticate_begin:545 - Generating authentication options...
[2025-06-21 00:37:59,438] INFO authentication webauthn_authenticate_begin:546 - RP ID: localhost
[2025-06-21 00:37:59,439] INFO authentication webauthn_authenticate_begin:547 - Allow credentials count: 1
[2025-06-21 00:37:59,439] INFO authentication webauthn_authenticate_begin:555 - Authentication options generated successfully
[2025-06-21 00:37:59,439] INFO authentication webauthn_authenticate_begin:556 - Challenge (base64): nw+/eBtPg4BnupfVTk1jrP9Pyq+oIuDUoiz9LJvObrV8x67sSQvqvDvi5hNu9E0Arxoa7lev9bX2tApFmU9uzw==
[2025-06-21 00:37:59,439] INFO authentication webauthn_authenticate_begin:558 - Challenge length: 64 bytes
[2025-06-21 00:37:59,439] INFO authentication webauthn_authenticate_begin:569 - Challenge stored with ID: af1dee31-7a24-4b2b-953c-0eb8df7b68d0
[2025-06-21 00:37:59,440] INFO authentication webauthn_authenticate_begin:570 - Total challenges in memory: 2
[2025-06-21 00:37:59,440] INFO authentication webauthn_authenticate_begin:574 - Allow credential: {'id': 'bqTYzPI9X+vQT5X/DMHRXw==', 'type': 'public-key', 'transports': []}
[2025-06-21 00:37:59,440] INFO authentication webauthn_authenticate_begin:575 - Allow credential id: bqTYzPI9X+vQT5X/DMHRXw==
[2025-06-21 00:37:59,440] INFO authentication webauthn_authenticate_begin:576 - Allow credential type: public-key
[2025-06-21 00:37:59,440] INFO authentication webauthn_authenticate_begin:577 - Allow credential transports: []
[2025-06-21 00:37:59,441] INFO authentication webauthn_authenticate_begin:593 - Authentication options converted to dictionary
[2025-06-21 00:37:59,441] INFO authentication webauthn_authenticate_begin:594 - Options dict keys: ['challenge', 'rpId', 'allowCredentials', 'userVerification', 'timeout']
[2025-06-21 00:37:59,441] INFO authentication webauthn_authenticate_begin:595 - Challenge in options: nw+/eBtPg4BnupfVTk1jrP9Pyq+oIuDUoiz9LJvObrV8x67sSQvqvDvi5hNu9E0Arxoa7lev9bX2tApFmU9uzw==
[2025-06-21 00:37:59,441] INFO authentication webauthn_authenticate_begin:596 - Allow credentials count in options: 1
[2025-06-21 00:37:59,441] INFO authentication webauthn_authenticate_begin:604 - === WebAuthn Authentication Begin Complete ===
[2025-06-21 00:37:59,442] INFO authentication webauthn_authenticate_begin:605 - Response data: {'options': {'challenge': 'nw+/eBtPg4BnupfVTk1jrP9Pyq+oIuDUoiz9LJvObrV8x67sSQvqvDvi5hNu9E0Arxoa7lev9bX2tApFmU9uzw==', 'rpId': 'localhost', 'allowCredentials': [{'type': 'public-key', 'id': 'bqTYzPI9X+vQT5X/DMHRXw==', 'transports': []}], 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>, 'timeout': 60000}, 'challenge_id': 'af1dee31-7a24-4b2b-953c-0eb8df7b68d0'}
[2025-06-21 00:38:20,367] INFO authentication webauthn_authenticate_complete:614 - === WebAuthn Authentication Complete ===
[2025-06-21 00:38:20,368] INFO authentication webauthn_authenticate_complete:615 - Request data: {'username': 'sam', 'challenge_id': 'af1dee31-7a24-4b2b-953c-0eb8df7b68d0', 'credential_id': 'bqTYzPI9X+vQT5X/DMHRXw==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoibnctX2VCdFBnNEJudXBmVlRrMWpyUDlQeXEtb0l1RFVvaXo5TEp2T2JyVjh4NjdzU1F2cXZEdmk1aE51OUUwQXJ4b2E3bGV2OWJYMnRBcEZtVTl1enciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEQCIA/lVCNdJitcu+7SK+19USCj/HoWLkONID91O5cfCbFUAiBOee9r1MAVjl1jZNAimthyz0jMLKoQ2OzMOsB3dBCdkQ=='}
[2025-06-21 00:38:20,369] INFO authentication webauthn_authenticate_complete:625 - Serializer validated successfully
[2025-06-21 00:38:20,381] INFO authentication webauthn_authenticate_complete:626 - Validated data: {'username': 'sam', 'credential_id': 'bqTYzPI9X+vQT5X/DMHRXw==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoibnctX2VCdFBnNEJudXBmVlRrMWpyUDlQeXEtb0l1RFVvaXo5TEp2T2JyVjh4NjdzU1F2cXZEdmk1aE51OUUwQXJ4b2E3bGV2OWJYMnRBcEZtVTl1enciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEQCIA/lVCNdJitcu+7SK+19USCj/HoWLkONID91O5cfCbFUAiBOee9r1MAVjl1jZNAimthyz0jMLKoQ2OzMOsB3dBCdkQ=='}
[2025-06-21 00:38:20,381] INFO authentication webauthn_authenticate_complete:664 - Challenge ID from request: af1dee31-7a24-4b2b-953c-0eb8df7b68d0
[2025-06-21 00:38:20,381] INFO authentication webauthn_authenticate_complete:679 - Retrieved stored challenge data:
[2025-06-21 00:38:20,382] INFO authentication webauthn_authenticate_complete:680 -   - Challenge: nw+/eBtPg4BnupfVTk1jrP9Pyq+oIuDUoiz9LJvObrV8x67sSQvqvDvi5hNu9E0Arxoa7lev9bX2tApFmU9uzw==
[2025-06-21 00:38:20,382] INFO authentication webauthn_authenticate_complete:681 -   - Username: sam
[2025-06-21 00:38:20,382] INFO authentication webauthn_authenticate_complete:682 -   - Type: authentication
[2025-06-21 00:38:20,397] INFO authentication webauthn_authenticate_complete:687 - User found: sam (ID: 13)
[2025-06-21 00:38:20,404] INFO authentication webauthn_authenticate_complete:700 - Credential found: bqTYzPI9X+vQT5X/DMHRXw==
[2025-06-21 00:38:20,404] INFO authentication webauthn_authenticate_complete:701 - Credential public key length: 77 bytes
[2025-06-21 00:38:20,405] INFO authentication webauthn_authenticate_complete:703 - Credential sign count: 0
[2025-06-21 00:38:20,407] INFO authentication webauthn_authenticate_complete:713 - Starting authentication verification...
[2025-06-21 00:38:20,411] INFO authentication webauthn_authenticate_complete:714 - Challenge: nw+/eBtPg4BnupfVTk1jrP9Pyq+oIuDUoiz9LJvObrV8x67sSQvqvDvi5hNu9E0Arxoa7lev9bX2tApFmU9uzw==
[2025-06-21 00:38:20,415] INFO authentication webauthn_authenticate_complete:715 - RP ID: localhost
[2025-06-21 00:38:20,417] INFO authentication webauthn_authenticate_complete:716 - Origin: http://localhost:5173
[2025-06-21 00:38:20,418] INFO authentication webauthn_authenticate_complete:721 - Decoded credential_id length: 16 bytes
[2025-06-21 00:38:20,418] INFO authentication webauthn_authenticate_complete:723 - Decoded credential_id (hex): 6ea4d8ccf23d5febd04f95ff0cc1d15f
[2025-06-21 00:38:20,418] INFO authentication webauthn_authenticate_complete:728 - Re-encoded credential_id: bqTYzPI9X+vQT5X/DMHRXw==
[2025-06-21 00:38:20,418] INFO authentication webauthn_authenticate_complete:729 - Original vs re-encoded match: True
[2025-06-21 00:38:20,418] INFO authentication webauthn_authenticate_complete:735 - URL-safe encoded credential_id: bqTYzPI9X-vQT5X_DMHRXw
[2025-06-21 00:38:20,419] INFO authentication webauthn_authenticate_complete:736 - Original vs urlsafe match: False
[2025-06-21 00:38:20,419] INFO authentication webauthn_authenticate_complete:742 - Converted credential_id to base64url: bqTYzPI9X-vQT5X_DMHRXw
[2025-06-21 00:38:20,419] INFO authentication webauthn_authenticate_complete:753 - AuthenticatorAssertionResponse created successfully
[2025-06-21 00:38:20,419] INFO authentication webauthn_authenticate_complete:761 - AuthenticationCredential created successfully
[2025-06-21 00:38:20,421] INFO authentication webauthn_authenticate_complete:762 - Credential ID type: <class 'str'>
[2025-06-21 00:38:20,421] INFO authentication webauthn_authenticate_complete:763 - Credential ID value: bqTYzPI9X-vQT5X_DMHRXw
[2025-06-21 00:38:20,422] INFO authentication webauthn_authenticate_complete:764 - Credential raw_id type: <class 'bytes'>
[2025-06-21 00:38:20,423] INFO authentication webauthn_authenticate_complete:765 - Credential raw_id length: 16 bytes
[2025-06-21 00:38:20,423] INFO authentication webauthn_authenticate_complete:767 - Credential raw_id (hex): 6ea4d8ccf23d5febd04f95ff0cc1d15f
[2025-06-21 00:38:20,424] INFO authentication webauthn_authenticate_complete:768 - Credential type: public-key
[2025-06-21 00:38:20,425] INFO authentication webauthn_authenticate_complete:772 - Base64url encoding of raw_id: bqTYzPI9X-vQT5X_DMHRXw
[2025-06-21 00:38:20,426] INFO authentication webauthn_authenticate_complete:773 - ID and base64url(raw_id) match: True
[2025-06-21 00:38:20,426] INFO authentication webauthn_authenticate_complete:774 - ID and raw_id have correct types: True
[2025-06-21 00:38:20,426] INFO authentication webauthn_authenticate_complete:776 - Starting verification with webauthn library...
[2025-06-21 00:38:20,449] INFO authentication webauthn_authenticate_complete:786 - === Authentication Verification Successful ===
[2025-06-21 00:38:20,449] INFO authentication webauthn_authenticate_complete:787 - Verification object: VerifiedAuthentication(credential_id=b'n\xa4\xd8\xcc\xf2=_\xeb\xd0O\x95\xff\x0c\xc1\xd1_', new_sign_count=0, credential_device_type=<CredentialDeviceType.MULTI_DEVICE: 'multi_device'>, credential_backed_up=True, user_verified=True)
[2025-06-21 00:38:20,449] INFO authentication webauthn_authenticate_complete:788 - New sign count: 0
[2025-06-21 00:38:20,451] INFO authentication webauthn_authenticate_complete:789 - Previous sign count: 0
[2025-06-21 00:38:20,475] INFO authentication webauthn_authenticate_complete:795 - Credential updated - new sign count: 0
[2025-06-21 00:38:20,509] INFO authentication webauthn_authenticate_complete:800 - User sam logged in successfully
[2025-06-21 00:38:20,523] INFO authentication webauthn_authenticate_complete:804 - JWT tokens generated successfully
[2025-06-21 00:38:20,524] INFO authentication webauthn_authenticate_complete:808 - Challenge af1dee31-7a24-4b2b-953c-0eb8df7b68d0 removed from memory
[2025-06-21 00:38:20,524] INFO authentication webauthn_authenticate_complete:809 - Remaining challenges: 1
[2025-06-21 00:38:20,527] INFO authentication webauthn_authenticate_complete:820 - === WebAuthn Authentication Complete Success ===
[2025-06-21 00:38:20,527] INFO authentication webauthn_authenticate_complete:821 - Response data: {'message': 'Authentication successful', 'user': {'id': 13, 'username': 'sam', 'email': 'sam@gmail.com', 'first_name': 'sam', 'last_name': 'sam', 'date_joined': '2025-06-20T19:06:33.770550Z'}, 'tokens': {'access': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzUwNDUwMTAwLCJpYXQiOjE3NTA0NDY1MDAsImp0aSI6IjQ2OTVhNmI5YThmNTQxNzA5MDAyNWQ4YWU3MjE5MGM4IiwidXNlcl9pZCI6MTN9._sQ4qQPS465O9aecFNPLzqa42VQNvL6gb6lx3x6Z3S8', 'refresh': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTc1MDUzMjkwMCwiaWF0IjoxNzUwNDQ2NTAwLCJqdGkiOiJmN2JmNWI4ZWFmNTg0MWZkOTMzYmFjNzI0OGNhYjQ1YiIsInVzZXJfaWQiOjEzfQ.wsbdXxXh2B3D5js4ryq3DVVREhYz5yukE_OyusWhP6o'}}
[2025-06-21 00:38:20,595] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 00:38:20,595] INFO authentication user_profile:840 - User accessing profile: sam (ID: 13)
[2025-06-21 00:38:20,596] INFO authentication user_profile:845 - Profile data retrieved: {'id': 13, 'username': 'sam', 'email': 'sam@gmail.com', 'first_name': 'sam', 'last_name': 'sam', 'date_joined': '2025-06-20T19:06:33.770550Z'}
[2025-06-21 00:38:20,604] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 00:38:20,606] INFO authentication user_profile:840 - User accessing profile: sam (ID: 13)
[2025-06-21 00:38:20,610] INFO authentication user_profile:845 - Profile data retrieved: {'id': 13, 'username': 'sam', 'email': 'sam@gmail.com', 'first_name': 'sam', 'last_name': 'sam', 'date_joined': '2025-06-20T19:06:33.770550Z'}
[2025-06-21 18:18:52,739] INFO authentication webauthn_authenticate_begin:492 - === WebAuthn Authentication Begin ===
[2025-06-21 18:18:52,739] INFO authentication webauthn_authenticate_begin:493 - Request data: {'username': 'new10'}
[2025-06-21 18:18:52,740] INFO authentication webauthn_authenticate_begin:512 - Processing authentication for user: new10
[2025-06-21 18:18:52,742] INFO authentication webauthn_authenticate_begin:517 - User found: new10 (ID: 11)
[2025-06-21 18:18:52,744] INFO authentication webauthn_authenticate_begin:526 - Found 1 credentials for user new10
[2025-06-21 18:18:52,746] INFO authentication webauthn_authenticate_begin:542 - Added credential: 2qONK+7vg1JafPJrfBnFEw== (transports: [])
[2025-06-21 18:18:52,746] INFO authentication webauthn_authenticate_begin:545 - Generating authentication options...
[2025-06-21 18:18:52,747] INFO authentication webauthn_authenticate_begin:546 - RP ID: localhost
[2025-06-21 18:18:52,747] INFO authentication webauthn_authenticate_begin:547 - Allow credentials count: 1
[2025-06-21 18:18:52,747] INFO authentication webauthn_authenticate_begin:555 - Authentication options generated successfully
[2025-06-21 18:18:52,747] INFO authentication webauthn_authenticate_begin:556 - Challenge (base64): g4L12oi/Msr79lGoxkkK3Xo9PjC8OEpdeUnFo73HiE/V+ByfvjWiqTTC2GzvZ8LSbH7LMcUuHPv591myh3kK2g==
[2025-06-21 18:18:52,748] INFO authentication webauthn_authenticate_begin:558 - Challenge length: 64 bytes
[2025-06-21 18:18:52,748] INFO authentication webauthn_authenticate_begin:569 - Challenge stored with ID: 3cca2a89-5a99-4988-9007-3cad5861dfc9
[2025-06-21 18:18:52,748] INFO authentication webauthn_authenticate_begin:570 - Total challenges in memory: 1
[2025-06-21 18:18:52,748] INFO authentication webauthn_authenticate_begin:574 - Allow credential: {'id': '2qONK+7vg1JafPJrfBnFEw==', 'type': 'public-key', 'transports': []}
[2025-06-21 18:18:52,748] INFO authentication webauthn_authenticate_begin:575 - Allow credential id: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-21 18:18:52,749] INFO authentication webauthn_authenticate_begin:576 - Allow credential type: public-key
[2025-06-21 18:18:52,749] INFO authentication webauthn_authenticate_begin:577 - Allow credential transports: []
[2025-06-21 18:18:52,749] INFO authentication webauthn_authenticate_begin:593 - Authentication options converted to dictionary
[2025-06-21 18:18:52,749] INFO authentication webauthn_authenticate_begin:594 - Options dict keys: ['challenge', 'rpId', 'allowCredentials', 'userVerification', 'timeout']
[2025-06-21 18:18:52,749] INFO authentication webauthn_authenticate_begin:595 - Challenge in options: g4L12oi/Msr79lGoxkkK3Xo9PjC8OEpdeUnFo73HiE/V+ByfvjWiqTTC2GzvZ8LSbH7LMcUuHPv591myh3kK2g==
[2025-06-21 18:18:52,750] INFO authentication webauthn_authenticate_begin:596 - Allow credentials count in options: 1
[2025-06-21 18:18:52,750] INFO authentication webauthn_authenticate_begin:604 - === WebAuthn Authentication Begin Complete ===
[2025-06-21 18:18:52,750] INFO authentication webauthn_authenticate_begin:605 - Response data: {'options': {'challenge': 'g4L12oi/Msr79lGoxkkK3Xo9PjC8OEpdeUnFo73HiE/V+ByfvjWiqTTC2GzvZ8LSbH7LMcUuHPv591myh3kK2g==', 'rpId': 'localhost', 'allowCredentials': [{'type': 'public-key', 'id': '2qONK+7vg1JafPJrfBnFEw==', 'transports': []}], 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>, 'timeout': 60000}, 'challenge_id': '3cca2a89-5a99-4988-9007-3cad5861dfc9'}
[2025-06-21 18:19:26,615] INFO authentication webauthn_authenticate_complete:614 - === WebAuthn Authentication Complete ===
[2025-06-21 18:19:26,615] INFO authentication webauthn_authenticate_complete:615 - Request data: {'username': 'new10', 'challenge_id': '3cca2a89-5a99-4988-9007-3cad5861dfc9', 'credential_id': '2qONK+7vg1JafPJrfBnFEw==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiZzRMMTJvaV9Nc3I3OWxHb3hra0szWG85UGpDOE9FcGRlVW5GbzczSGlFX1YtQnlmdmpXaXFUVEMyR3p2WjhMU2JIN0xNY1V1SFB2NTkxbXloM2tLMmciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEQCIDGQEQQVmPMyLu14W+3SVmmsQPh1y+ffK24kH8HcPJ+bAiA41ztL3BzAqyC7czQ6IABe+q2QWRlhhqSJEwpG8slUow=='}
[2025-06-21 18:19:26,616] INFO authentication webauthn_authenticate_complete:625 - Serializer validated successfully
[2025-06-21 18:19:26,616] INFO authentication webauthn_authenticate_complete:626 - Validated data: {'username': 'new10', 'credential_id': '2qONK+7vg1JafPJrfBnFEw==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiZzRMMTJvaV9Nc3I3OWxHb3hra0szWG85UGpDOE9FcGRlVW5GbzczSGlFX1YtQnlmdmpXaXFUVEMyR3p2WjhMU2JIN0xNY1V1SFB2NTkxbXloM2tLMmciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEQCIDGQEQQVmPMyLu14W+3SVmmsQPh1y+ffK24kH8HcPJ+bAiA41ztL3BzAqyC7czQ6IABe+q2QWRlhhqSJEwpG8slUow=='}
[2025-06-21 18:19:26,616] INFO authentication webauthn_authenticate_complete:664 - Challenge ID from request: 3cca2a89-5a99-4988-9007-3cad5861dfc9
[2025-06-21 18:19:26,616] INFO authentication webauthn_authenticate_complete:679 - Retrieved stored challenge data:
[2025-06-21 18:19:26,617] INFO authentication webauthn_authenticate_complete:680 -   - Challenge: g4L12oi/Msr79lGoxkkK3Xo9PjC8OEpdeUnFo73HiE/V+ByfvjWiqTTC2GzvZ8LSbH7LMcUuHPv591myh3kK2g==
[2025-06-21 18:19:26,617] INFO authentication webauthn_authenticate_complete:681 -   - Username: new10
[2025-06-21 18:19:26,617] INFO authentication webauthn_authenticate_complete:682 -   - Type: authentication
[2025-06-21 18:19:26,619] INFO authentication webauthn_authenticate_complete:687 - User found: new10 (ID: 11)
[2025-06-21 18:19:26,620] INFO authentication webauthn_authenticate_complete:700 - Credential found: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-21 18:19:26,621] INFO authentication webauthn_authenticate_complete:701 - Credential public key length: 77 bytes
[2025-06-21 18:19:26,621] INFO authentication webauthn_authenticate_complete:703 - Credential sign count: 0
[2025-06-21 18:19:26,621] INFO authentication webauthn_authenticate_complete:713 - Starting authentication verification...
[2025-06-21 18:19:26,621] INFO authentication webauthn_authenticate_complete:714 - Challenge: g4L12oi/Msr79lGoxkkK3Xo9PjC8OEpdeUnFo73HiE/V+ByfvjWiqTTC2GzvZ8LSbH7LMcUuHPv591myh3kK2g==
[2025-06-21 18:19:26,621] INFO authentication webauthn_authenticate_complete:715 - RP ID: localhost
[2025-06-21 18:19:26,621] INFO authentication webauthn_authenticate_complete:716 - Origin: http://localhost:5173
[2025-06-21 18:19:26,622] INFO authentication webauthn_authenticate_complete:721 - Decoded credential_id length: 16 bytes
[2025-06-21 18:19:26,622] INFO authentication webauthn_authenticate_complete:723 - Decoded credential_id (hex): daa38d2beeef83525a7cf26b7c19c513
[2025-06-21 18:19:26,622] INFO authentication webauthn_authenticate_complete:728 - Re-encoded credential_id: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-21 18:19:26,622] INFO authentication webauthn_authenticate_complete:729 - Original vs re-encoded match: True
[2025-06-21 18:19:26,622] INFO authentication webauthn_authenticate_complete:735 - URL-safe encoded credential_id: 2qONK-7vg1JafPJrfBnFEw
[2025-06-21 18:19:26,622] INFO authentication webauthn_authenticate_complete:736 - Original vs urlsafe match: False
[2025-06-21 18:19:26,623] INFO authentication webauthn_authenticate_complete:742 - Converted credential_id to base64url: 2qONK-7vg1JafPJrfBnFEw
[2025-06-21 18:19:26,623] INFO authentication webauthn_authenticate_complete:753 - AuthenticatorAssertionResponse created successfully
[2025-06-21 18:19:26,623] INFO authentication webauthn_authenticate_complete:761 - AuthenticationCredential created successfully
[2025-06-21 18:19:26,623] INFO authentication webauthn_authenticate_complete:762 - Credential ID type: <class 'str'>
[2025-06-21 18:19:26,623] INFO authentication webauthn_authenticate_complete:763 - Credential ID value: 2qONK-7vg1JafPJrfBnFEw
[2025-06-21 18:19:26,624] INFO authentication webauthn_authenticate_complete:764 - Credential raw_id type: <class 'bytes'>
[2025-06-21 18:19:26,624] INFO authentication webauthn_authenticate_complete:765 - Credential raw_id length: 16 bytes
[2025-06-21 18:19:26,624] INFO authentication webauthn_authenticate_complete:767 - Credential raw_id (hex): daa38d2beeef83525a7cf26b7c19c513
[2025-06-21 18:19:26,624] INFO authentication webauthn_authenticate_complete:768 - Credential type: public-key
[2025-06-21 18:19:26,624] INFO authentication webauthn_authenticate_complete:772 - Base64url encoding of raw_id: 2qONK-7vg1JafPJrfBnFEw
[2025-06-21 18:19:26,625] INFO authentication webauthn_authenticate_complete:773 - ID and base64url(raw_id) match: True
[2025-06-21 18:19:26,625] INFO authentication webauthn_authenticate_complete:774 - ID and raw_id have correct types: True
[2025-06-21 18:19:26,625] INFO authentication webauthn_authenticate_complete:776 - Starting verification with webauthn library...
[2025-06-21 18:19:26,652] INFO authentication webauthn_authenticate_complete:786 - === Authentication Verification Successful ===
[2025-06-21 18:19:26,652] INFO authentication webauthn_authenticate_complete:787 - Verification object: VerifiedAuthentication(credential_id=b'\xda\xa3\x8d+\xee\xef\x83RZ|\xf2k|\x19\xc5\x13', new_sign_count=0, credential_device_type=<CredentialDeviceType.MULTI_DEVICE: 'multi_device'>, credential_backed_up=True, user_verified=True)
[2025-06-21 18:19:26,653] INFO authentication webauthn_authenticate_complete:788 - New sign count: 0
[2025-06-21 18:19:26,653] INFO authentication webauthn_authenticate_complete:789 - Previous sign count: 0
[2025-06-21 18:19:26,671] INFO authentication webauthn_authenticate_complete:795 - Credential updated - new sign count: 0
[2025-06-21 18:19:26,693] INFO authentication webauthn_authenticate_complete:800 - User new10 logged in successfully
[2025-06-21 18:19:26,722] INFO authentication webauthn_authenticate_complete:804 - JWT tokens generated successfully
[2025-06-21 18:19:26,722] INFO authentication webauthn_authenticate_complete:808 - Challenge 3cca2a89-5a99-4988-9007-3cad5861dfc9 removed from memory
[2025-06-21 18:19:26,724] INFO authentication webauthn_authenticate_complete:809 - Remaining challenges: 0
[2025-06-21 18:19:26,741] INFO authentication webauthn_authenticate_complete:820 - === WebAuthn Authentication Complete Success ===
[2025-06-21 18:19:26,742] INFO authentication webauthn_authenticate_complete:821 - Response data: {'message': 'Authentication successful', 'user': {'id': 11, 'username': 'new10', 'email': 'new10@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T18:59:04.441424Z'}, 'tokens': {'access': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzUwNTEzNzY2LCJpYXQiOjE3NTA1MTAxNjYsImp0aSI6ImE5YTNhOWYwZjY2NjQ4NWE5YmVkNDc4MzE3YjkyNDA1IiwidXNlcl9pZCI6MTF9.2aQjeQwCMTIB9b_dtL3OJe4YbFCe5FPSfQz3Ndx71KQ', 'refresh': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTc1MDU5NjU2NiwiaWF0IjoxNzUwNTEwMTY2LCJqdGkiOiIxMzMxMTliMmJmMDA0ZWEwOTQ4N2UxMTQxNGU4OTgzOCIsInVzZXJfaWQiOjExfQ.bqXKDhc7Bh5AbLkRV0btg-GqnkogND1Zw43QvPnFjqI'}}
[2025-06-21 18:19:26,816] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 18:19:26,816] INFO authentication user_profile:840 - User accessing profile: new10 (ID: 11)
[2025-06-21 18:19:26,817] INFO authentication user_profile:845 - Profile data retrieved: {'id': 11, 'username': 'new10', 'email': 'new10@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T18:59:04.441424Z'}
[2025-06-21 18:19:26,824] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 18:19:26,824] INFO authentication user_profile:840 - User accessing profile: new10 (ID: 11)
[2025-06-21 18:19:26,825] INFO authentication user_profile:845 - Profile data retrieved: {'id': 11, 'username': 'new10', 'email': 'new10@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T18:59:04.441424Z'}
[2025-06-21 18:19:46,069] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 18:19:46,069] INFO authentication user_profile:840 - User accessing profile: new10 (ID: 11)
[2025-06-21 18:19:46,071] INFO authentication user_profile:845 - Profile data retrieved: {'id': 11, 'username': 'new10', 'email': 'new10@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T18:59:04.441424Z'}
[2025-06-21 18:19:46,078] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 18:19:46,078] INFO authentication user_profile:840 - User accessing profile: new10 (ID: 11)
[2025-06-21 18:19:46,079] INFO authentication user_profile:845 - Profile data retrieved: {'id': 11, 'username': 'new10', 'email': 'new10@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T18:59:04.441424Z'}
[2025-06-21 18:28:34,084] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 18:28:34,085] INFO authentication user_profile:840 - User accessing profile: new10 (ID: 11)
[2025-06-21 18:28:34,097] INFO authentication user_profile:845 - Profile data retrieved: {'id': 11, 'username': 'new10', 'email': 'new10@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T18:59:04.441424Z'}
[2025-06-21 18:28:34,113] INFO authentication user_profile:839 - === User Profile Access ===
[2025-06-21 18:28:34,113] INFO authentication user_profile:840 - User accessing profile: new10 (ID: 11)
[2025-06-21 18:28:34,115] INFO authentication user_profile:845 - Profile data retrieved: {'id': 11, 'username': 'new10', 'email': 'new10@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T18:59:04.441424Z'}
[2025-06-22 00:55:43,986] INFO authentication webauthn_authenticate_begin:492 - === WebAuthn Authentication Begin ===
[2025-06-22 00:55:43,987] INFO authentication webauthn_authenticate_begin:493 - Request data: {'username': 'new10'}
[2025-06-22 00:55:43,989] INFO authentication webauthn_authenticate_begin:512 - Processing authentication for user: new10
[2025-06-22 00:55:43,998] INFO authentication webauthn_authenticate_begin:517 - User found: new10 (ID: 11)
[2025-06-22 00:55:44,001] INFO authentication webauthn_authenticate_begin:526 - Found 1 credentials for user new10
[2025-06-22 00:55:44,005] INFO authentication webauthn_authenticate_begin:542 - Added credential: 2qONK+7vg1JafPJrfBnFEw== (transports: [])
[2025-06-22 00:55:44,005] INFO authentication webauthn_authenticate_begin:545 - Generating authentication options...
[2025-06-22 00:55:44,006] INFO authentication webauthn_authenticate_begin:546 - RP ID: localhost
[2025-06-22 00:55:44,006] INFO authentication webauthn_authenticate_begin:547 - Allow credentials count: 1
[2025-06-22 00:55:44,006] INFO authentication webauthn_authenticate_begin:555 - Authentication options generated successfully
[2025-06-22 00:55:44,006] INFO authentication webauthn_authenticate_begin:556 - Challenge (base64): e0oJ/bDi09lbqfdO0hgmF7Mi90Xz18ZK6EYPB+1e4K1u0pRVNzmvPEROhhV11yVmYK4X+knKyvOkE2L5Sf7McA==
[2025-06-22 00:55:44,008] INFO authentication webauthn_authenticate_begin:558 - Challenge length: 64 bytes
[2025-06-22 00:55:44,008] INFO authentication webauthn_authenticate_begin:569 - Challenge stored with ID: 6d32fa27-6cb9-4bb7-a6e1-a9483a83750d
[2025-06-22 00:55:44,008] INFO authentication webauthn_authenticate_begin:570 - Total challenges in memory: 1
[2025-06-22 00:55:44,008] INFO authentication webauthn_authenticate_begin:574 - Allow credential: {'id': '2qONK+7vg1JafPJrfBnFEw==', 'type': 'public-key', 'transports': []}
[2025-06-22 00:55:44,009] INFO authentication webauthn_authenticate_begin:575 - Allow credential id: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-22 00:55:44,009] INFO authentication webauthn_authenticate_begin:576 - Allow credential type: public-key
[2025-06-22 00:55:44,009] INFO authentication webauthn_authenticate_begin:577 - Allow credential transports: []
[2025-06-22 00:55:44,009] INFO authentication webauthn_authenticate_begin:593 - Authentication options converted to dictionary
[2025-06-22 00:55:44,009] INFO authentication webauthn_authenticate_begin:594 - Options dict keys: ['challenge', 'rpId', 'allowCredentials', 'userVerification', 'timeout']
[2025-06-22 00:55:44,009] INFO authentication webauthn_authenticate_begin:595 - Challenge in options: e0oJ/bDi09lbqfdO0hgmF7Mi90Xz18ZK6EYPB+1e4K1u0pRVNzmvPEROhhV11yVmYK4X+knKyvOkE2L5Sf7McA==
[2025-06-22 00:55:44,009] INFO authentication webauthn_authenticate_begin:596 - Allow credentials count in options: 1
[2025-06-22 00:55:44,010] INFO authentication webauthn_authenticate_begin:604 - === WebAuthn Authentication Begin Complete ===
[2025-06-22 00:55:44,010] INFO authentication webauthn_authenticate_begin:605 - Response data: {'options': {'challenge': 'e0oJ/bDi09lbqfdO0hgmF7Mi90Xz18ZK6EYPB+1e4K1u0pRVNzmvPEROhhV11yVmYK4X+knKyvOkE2L5Sf7McA==', 'rpId': 'localhost', 'allowCredentials': [{'type': 'public-key', 'id': '2qONK+7vg1JafPJrfBnFEw==', 'transports': []}], 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>, 'timeout': 60000}, 'challenge_id': '6d32fa27-6cb9-4bb7-a6e1-a9483a83750d'}
[2025-06-22 00:57:30,906] INFO authentication webauthn_authenticate_complete:614 - === WebAuthn Authentication Complete ===
[2025-06-22 00:57:30,907] INFO authentication webauthn_authenticate_complete:615 - Request data: {'username': 'new10', 'challenge_id': '6d32fa27-6cb9-4bb7-a6e1-a9483a83750d', 'credential_id': '2qONK+7vg1JafPJrfBnFEw==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiZTBvSl9iRGkwOWxicWZkTzBoZ21GN01pOTBYejE4Wks2RVlQQi0xZTRLMXUwcFJWTnptdlBFUk9oaFYxMXlWbVlLNFgta25LeXZPa0UyTDVTZjdNY0EiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEYCIQCpmkwpy3IH3g1iwuhmjWJx7is+pGUsSfYwsLQzvbOgzwIhALmr+e3CwN5cUv8Dfnl8kVxCR88SW6cI4YSSfJnYKBLo'}
[2025-06-22 00:57:30,907] INFO authentication webauthn_authenticate_complete:625 - Serializer validated successfully
[2025-06-22 00:57:30,908] INFO authentication webauthn_authenticate_complete:626 - Validated data: {'username': 'new10', 'credential_id': '2qONK+7vg1JafPJrfBnFEw==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiZTBvSl9iRGkwOWxicWZkTzBoZ21GN01pOTBYejE4Wks2RVlQQi0xZTRLMXUwcFJWTnptdlBFUk9oaFYxMXlWbVlLNFgta25LeXZPa0UyTDVTZjdNY0EiLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEYCIQCpmkwpy3IH3g1iwuhmjWJx7is+pGUsSfYwsLQzvbOgzwIhALmr+e3CwN5cUv8Dfnl8kVxCR88SW6cI4YSSfJnYKBLo'}
[2025-06-22 00:57:30,909] INFO authentication webauthn_authenticate_complete:664 - Challenge ID from request: 6d32fa27-6cb9-4bb7-a6e1-a9483a83750d
[2025-06-22 00:57:30,909] INFO authentication webauthn_authenticate_complete:679 - Retrieved stored challenge data:
[2025-06-22 00:57:30,909] INFO authentication webauthn_authenticate_complete:680 -   - Challenge: e0oJ/bDi09lbqfdO0hgmF7Mi90Xz18ZK6EYPB+1e4K1u0pRVNzmvPEROhhV11yVmYK4X+knKyvOkE2L5Sf7McA==
[2025-06-22 00:57:30,909] INFO authentication webauthn_authenticate_complete:681 -   - Username: new10
[2025-06-22 00:57:30,909] INFO authentication webauthn_authenticate_complete:682 -   - Type: authentication
[2025-06-22 00:57:30,912] INFO authentication webauthn_authenticate_complete:687 - User found: new10 (ID: 11)
[2025-06-22 00:57:30,914] INFO authentication webauthn_authenticate_complete:700 - Credential found: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-22 00:57:30,914] INFO authentication webauthn_authenticate_complete:701 - Credential public key length: 77 bytes
[2025-06-22 00:57:30,915] INFO authentication webauthn_authenticate_complete:703 - Credential sign count: 0
[2025-06-22 00:57:30,915] INFO authentication webauthn_authenticate_complete:713 - Starting authentication verification...
[2025-06-22 00:57:30,915] INFO authentication webauthn_authenticate_complete:714 - Challenge: e0oJ/bDi09lbqfdO0hgmF7Mi90Xz18ZK6EYPB+1e4K1u0pRVNzmvPEROhhV11yVmYK4X+knKyvOkE2L5Sf7McA==
[2025-06-22 00:57:30,915] INFO authentication webauthn_authenticate_complete:715 - RP ID: localhost
[2025-06-22 00:57:30,915] INFO authentication webauthn_authenticate_complete:716 - Origin: http://localhost:5173
[2025-06-22 00:57:30,915] INFO authentication webauthn_authenticate_complete:721 - Decoded credential_id length: 16 bytes
[2025-06-22 00:57:30,916] INFO authentication webauthn_authenticate_complete:723 - Decoded credential_id (hex): daa38d2beeef83525a7cf26b7c19c513
[2025-06-22 00:57:30,916] INFO authentication webauthn_authenticate_complete:728 - Re-encoded credential_id: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-22 00:57:30,916] INFO authentication webauthn_authenticate_complete:729 - Original vs re-encoded match: True
[2025-06-22 00:57:30,916] INFO authentication webauthn_authenticate_complete:735 - URL-safe encoded credential_id: 2qONK-7vg1JafPJrfBnFEw
[2025-06-22 00:57:30,917] INFO authentication webauthn_authenticate_complete:736 - Original vs urlsafe match: False
[2025-06-22 00:57:30,917] INFO authentication webauthn_authenticate_complete:742 - Converted credential_id to base64url: 2qONK-7vg1JafPJrfBnFEw
[2025-06-22 00:57:30,917] INFO authentication webauthn_authenticate_complete:753 - AuthenticatorAssertionResponse created successfully
[2025-06-22 00:57:30,919] INFO authentication webauthn_authenticate_complete:761 - AuthenticationCredential created successfully
[2025-06-22 00:57:30,919] INFO authentication webauthn_authenticate_complete:762 - Credential ID type: <class 'str'>
[2025-06-22 00:57:30,919] INFO authentication webauthn_authenticate_complete:763 - Credential ID value: 2qONK-7vg1JafPJrfBnFEw
[2025-06-22 00:57:30,919] INFO authentication webauthn_authenticate_complete:764 - Credential raw_id type: <class 'bytes'>
[2025-06-22 00:57:30,919] INFO authentication webauthn_authenticate_complete:765 - Credential raw_id length: 16 bytes
[2025-06-22 00:57:30,920] INFO authentication webauthn_authenticate_complete:767 - Credential raw_id (hex): daa38d2beeef83525a7cf26b7c19c513
[2025-06-22 00:57:30,920] INFO authentication webauthn_authenticate_complete:768 - Credential type: public-key
[2025-06-22 00:57:30,920] INFO authentication webauthn_authenticate_complete:772 - Base64url encoding of raw_id: 2qONK-7vg1JafPJrfBnFEw
[2025-06-22 00:57:30,920] INFO authentication webauthn_authenticate_complete:773 - ID and base64url(raw_id) match: True
[2025-06-22 00:57:30,920] INFO authentication webauthn_authenticate_complete:774 - ID and raw_id have correct types: True
[2025-06-22 00:57:30,921] INFO authentication webauthn_authenticate_complete:776 - Starting verification with webauthn library...
[2025-06-22 00:57:30,969] INFO authentication webauthn_authenticate_complete:786 - === Authentication Verification Successful ===
[2025-06-22 00:57:30,969] INFO authentication webauthn_authenticate_complete:787 - Verification object: VerifiedAuthentication(credential_id=b'\xda\xa3\x8d+\xee\xef\x83RZ|\xf2k|\x19\xc5\x13', new_sign_count=0, credential_device_type=<CredentialDeviceType.MULTI_DEVICE: 'multi_device'>, credential_backed_up=True, user_verified=True)
[2025-06-22 00:57:30,969] INFO authentication webauthn_authenticate_complete:788 - New sign count: 0
[2025-06-22 00:57:30,969] INFO authentication webauthn_authenticate_complete:789 - Previous sign count: 0
[2025-06-22 00:57:30,989] INFO authentication webauthn_authenticate_complete:795 - Credential updated - new sign count: 0
[2025-06-22 00:57:31,009] INFO authentication webauthn_authenticate_complete:800 - User new10 logged in successfully
[2025-06-22 00:57:31,048] INFO authentication webauthn_authenticate_complete:804 - JWT tokens generated successfully
[2025-06-22 00:57:31,049] INFO authentication webauthn_authenticate_complete:808 - Challenge 6d32fa27-6cb9-4bb7-a6e1-a9483a83750d removed from memory
[2025-06-22 00:57:31,049] INFO authentication webauthn_authenticate_complete:809 - Remaining challenges: 0
[2025-06-22 00:57:31,059] INFO authentication webauthn_authenticate_complete:820 - === WebAuthn Authentication Complete Success ===
[2025-06-22 00:57:31,059] INFO authentication webauthn_authenticate_complete:821 - Response data: {'message': 'Authentication successful', 'user': {'id': 11, 'username': 'new10', 'email': 'new10@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T18:59:04.441424Z'}, 'tokens': {'access': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzUwNTM3NjUxLCJpYXQiOjE3NTA1MzQwNTEsImp0aSI6ImM0ZTZkZDU4ZjQ2OTRiMDc4ZDU4NjIzNWRmYmY0ZGM1IiwidXNlcl9pZCI6MTF9.3h4q7wEMiMQfJ0Ck7LtMx_WmVnhlw3-C5mxcySoa4Zk', 'refresh': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTc1MDYyMDQ1MSwiaWF0IjoxNzUwNTM0MDUxLCJqdGkiOiJlYTZhNDcwMDlhNmU0OTQ0OWVmYzgxNDlkZTlmZTA3YyIsInVzZXJfaWQiOjExfQ.6hg5nAi2nuwyJAz8jfe7CXKFzyJSak_4doX49ZWzELk'}}
[2025-06-22 01:03:00,917] INFO authentication webauthn_authenticate_begin:492 - === WebAuthn Authentication Begin ===
[2025-06-22 01:03:00,918] INFO authentication webauthn_authenticate_begin:493 - Request data: {'username': 'new10'}
[2025-06-22 01:03:00,918] INFO authentication webauthn_authenticate_begin:512 - Processing authentication for user: new10
[2025-06-22 01:03:00,922] INFO authentication webauthn_authenticate_begin:517 - User found: new10 (ID: 11)
[2025-06-22 01:03:00,926] INFO authentication webauthn_authenticate_begin:526 - Found 1 credentials for user new10
[2025-06-22 01:03:00,930] INFO authentication webauthn_authenticate_begin:542 - Added credential: 2qONK+7vg1JafPJrfBnFEw== (transports: [])
[2025-06-22 01:03:00,930] INFO authentication webauthn_authenticate_begin:545 - Generating authentication options...
[2025-06-22 01:03:00,931] INFO authentication webauthn_authenticate_begin:546 - RP ID: localhost
[2025-06-22 01:03:00,931] INFO authentication webauthn_authenticate_begin:547 - Allow credentials count: 1
[2025-06-22 01:03:00,931] INFO authentication webauthn_authenticate_begin:555 - Authentication options generated successfully
[2025-06-22 01:03:00,931] INFO authentication webauthn_authenticate_begin:556 - Challenge (base64): n8Y3J213CVjIrnd2l6rCXyylC5VRNbWOpG2nDQIqJbREviDJPuId2S1dyDEsCwIGBBSOe3IKDwDPqhOcHkJB/w==
[2025-06-22 01:03:00,932] INFO authentication webauthn_authenticate_begin:558 - Challenge length: 64 bytes
[2025-06-22 01:03:00,932] INFO authentication webauthn_authenticate_begin:569 - Challenge stored with ID: c26e3a54-ddda-40be-ad33-b476c7fb2382
[2025-06-22 01:03:00,932] INFO authentication webauthn_authenticate_begin:570 - Total challenges in memory: 1
[2025-06-22 01:03:00,932] INFO authentication webauthn_authenticate_begin:574 - Allow credential: {'id': '2qONK+7vg1JafPJrfBnFEw==', 'type': 'public-key', 'transports': []}
[2025-06-22 01:03:00,932] INFO authentication webauthn_authenticate_begin:575 - Allow credential id: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-22 01:03:00,932] INFO authentication webauthn_authenticate_begin:576 - Allow credential type: public-key
[2025-06-22 01:03:00,933] INFO authentication webauthn_authenticate_begin:577 - Allow credential transports: []
[2025-06-22 01:03:00,934] INFO authentication webauthn_authenticate_begin:593 - Authentication options converted to dictionary
[2025-06-22 01:03:00,935] INFO authentication webauthn_authenticate_begin:594 - Options dict keys: ['challenge', 'rpId', 'allowCredentials', 'userVerification', 'timeout']
[2025-06-22 01:03:00,935] INFO authentication webauthn_authenticate_begin:595 - Challenge in options: n8Y3J213CVjIrnd2l6rCXyylC5VRNbWOpG2nDQIqJbREviDJPuId2S1dyDEsCwIGBBSOe3IKDwDPqhOcHkJB/w==
[2025-06-22 01:03:00,936] INFO authentication webauthn_authenticate_begin:596 - Allow credentials count in options: 1
[2025-06-22 01:03:00,936] INFO authentication webauthn_authenticate_begin:604 - === WebAuthn Authentication Begin Complete ===
[2025-06-22 01:03:00,936] INFO authentication webauthn_authenticate_begin:605 - Response data: {'options': {'challenge': 'n8Y3J213CVjIrnd2l6rCXyylC5VRNbWOpG2nDQIqJbREviDJPuId2S1dyDEsCwIGBBSOe3IKDwDPqhOcHkJB/w==', 'rpId': 'localhost', 'allowCredentials': [{'type': 'public-key', 'id': '2qONK+7vg1JafPJrfBnFEw==', 'transports': []}], 'userVerification': <UserVerificationRequirement.PREFERRED: 'preferred'>, 'timeout': 60000}, 'challenge_id': 'c26e3a54-ddda-40be-ad33-b476c7fb2382'}
[2025-06-22 01:03:32,226] INFO authentication webauthn_authenticate_complete:614 - === WebAuthn Authentication Complete ===
[2025-06-22 01:03:32,227] INFO authentication webauthn_authenticate_complete:615 - Request data: {'username': 'new10', 'challenge_id': 'c26e3a54-ddda-40be-ad33-b476c7fb2382', 'credential_id': '2qONK+7vg1JafPJrfBnFEw==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoibjhZM0oyMTNDVmpJcm5kMmw2ckNYeXlsQzVWUk5iV09wRzJuRFFJcUpiUkV2aURKUHVJZDJTMWR5REVzQ3dJR0JCU09lM0lLRHdEUHFoT2NIa0pCX3ciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEQCIFL6NGFPYxB75hrTXkn6JYyw5iZVBjVcQa3iRK/ID3nOAiA5dH1j0aDQ9gEq7z/qfLBOcOjlla4gzZaTrjrCyQGpUg=='}
[2025-06-22 01:03:32,228] INFO authentication webauthn_authenticate_complete:625 - Serializer validated successfully
[2025-06-22 01:03:32,228] INFO authentication webauthn_authenticate_complete:626 - Validated data: {'username': 'new10', 'credential_id': '2qONK+7vg1JafPJrfBnFEw==', 'authenticator_data': 'SZYN5YgOjGh0NBcPZHZgW4/krrmihjLHmVzzuoMdl2MdAAAAAA==', 'client_data_json': 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoibjhZM0oyMTNDVmpJcm5kMmw2ckNYeXlsQzVWUk5iV09wRzJuRFFJcUpiUkV2aURKUHVJZDJTMWR5REVzQ3dJR0JCU09lM0lLRHdEUHFoT2NIa0pCX3ciLCJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0OjUxNzMiLCJjcm9zc09yaWdpbiI6ZmFsc2V9', 'signature': 'MEQCIFL6NGFPYxB75hrTXkn6JYyw5iZVBjVcQa3iRK/ID3nOAiA5dH1j0aDQ9gEq7z/qfLBOcOjlla4gzZaTrjrCyQGpUg=='}
[2025-06-22 01:03:32,229] INFO authentication webauthn_authenticate_complete:664 - Challenge ID from request: c26e3a54-ddda-40be-ad33-b476c7fb2382
[2025-06-22 01:03:32,229] INFO authentication webauthn_authenticate_complete:679 - Retrieved stored challenge data:
[2025-06-22 01:03:32,229] INFO authentication webauthn_authenticate_complete:680 -   - Challenge: n8Y3J213CVjIrnd2l6rCXyylC5VRNbWOpG2nDQIqJbREviDJPuId2S1dyDEsCwIGBBSOe3IKDwDPqhOcHkJB/w==
[2025-06-22 01:03:32,229] INFO authentication webauthn_authenticate_complete:681 -   - Username: new10
[2025-06-22 01:03:32,229] INFO authentication webauthn_authenticate_complete:682 -   - Type: authentication
[2025-06-22 01:03:32,233] INFO authentication webauthn_authenticate_complete:687 - User found: new10 (ID: 11)
[2025-06-22 01:03:32,238] INFO authentication webauthn_authenticate_complete:700 - Credential found: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-22 01:03:32,239] INFO authentication webauthn_authenticate_complete:701 - Credential public key length: 77 bytes
[2025-06-22 01:03:32,240] INFO authentication webauthn_authenticate_complete:703 - Credential sign count: 0
[2025-06-22 01:03:32,240] INFO authentication webauthn_authenticate_complete:713 - Starting authentication verification...
[2025-06-22 01:03:32,240] INFO authentication webauthn_authenticate_complete:714 - Challenge: n8Y3J213CVjIrnd2l6rCXyylC5VRNbWOpG2nDQIqJbREviDJPuId2S1dyDEsCwIGBBSOe3IKDwDPqhOcHkJB/w==
[2025-06-22 01:03:32,240] INFO authentication webauthn_authenticate_complete:715 - RP ID: localhost
[2025-06-22 01:03:32,241] INFO authentication webauthn_authenticate_complete:716 - Origin: http://localhost:5173
[2025-06-22 01:03:32,241] INFO authentication webauthn_authenticate_complete:721 - Decoded credential_id length: 16 bytes
[2025-06-22 01:03:32,242] INFO authentication webauthn_authenticate_complete:723 - Decoded credential_id (hex): daa38d2beeef83525a7cf26b7c19c513
[2025-06-22 01:03:32,242] INFO authentication webauthn_authenticate_complete:728 - Re-encoded credential_id: 2qONK+7vg1JafPJrfBnFEw==
[2025-06-22 01:03:32,243] INFO authentication webauthn_authenticate_complete:729 - Original vs re-encoded match: True
[2025-06-22 01:03:32,243] INFO authentication webauthn_authenticate_complete:735 - URL-safe encoded credential_id: 2qONK-7vg1JafPJrfBnFEw
[2025-06-22 01:03:32,244] INFO authentication webauthn_authenticate_complete:736 - Original vs urlsafe match: False
[2025-06-22 01:03:32,244] INFO authentication webauthn_authenticate_complete:742 - Converted credential_id to base64url: 2qONK-7vg1JafPJrfBnFEw
[2025-06-22 01:03:32,244] INFO authentication webauthn_authenticate_complete:753 - AuthenticatorAssertionResponse created successfully
[2025-06-22 01:03:32,244] INFO authentication webauthn_authenticate_complete:761 - AuthenticationCredential created successfully
[2025-06-22 01:03:32,244] INFO authentication webauthn_authenticate_complete:762 - Credential ID type: <class 'str'>
[2025-06-22 01:03:32,245] INFO authentication webauthn_authenticate_complete:763 - Credential ID value: 2qONK-7vg1JafPJrfBnFEw
[2025-06-22 01:03:32,245] INFO authentication webauthn_authenticate_complete:764 - Credential raw_id type: <class 'bytes'>
[2025-06-22 01:03:32,245] INFO authentication webauthn_authenticate_complete:765 - Credential raw_id length: 16 bytes
[2025-06-22 01:03:32,245] INFO authentication webauthn_authenticate_complete:767 - Credential raw_id (hex): daa38d2beeef83525a7cf26b7c19c513
[2025-06-22 01:03:32,246] INFO authentication webauthn_authenticate_complete:768 - Credential type: public-key
[2025-06-22 01:03:32,246] INFO authentication webauthn_authenticate_complete:772 - Base64url encoding of raw_id: 2qONK-7vg1JafPJrfBnFEw
[2025-06-22 01:03:32,246] INFO authentication webauthn_authenticate_complete:773 - ID and base64url(raw_id) match: True
[2025-06-22 01:03:32,247] INFO authentication webauthn_authenticate_complete:774 - ID and raw_id have correct types: True
[2025-06-22 01:03:32,247] INFO authentication webauthn_authenticate_complete:776 - Starting verification with webauthn library...
[2025-06-22 01:03:32,290] INFO authentication webauthn_authenticate_complete:786 - === Authentication Verification Successful ===
[2025-06-22 01:03:32,291] INFO authentication webauthn_authenticate_complete:787 - Verification object: VerifiedAuthentication(credential_id=b'\xda\xa3\x8d+\xee\xef\x83RZ|\xf2k|\x19\xc5\x13', new_sign_count=0, credential_device_type=<CredentialDeviceType.MULTI_DEVICE: 'multi_device'>, credential_backed_up=True, user_verified=True)
[2025-06-22 01:03:32,291] INFO authentication webauthn_authenticate_complete:788 - New sign count: 0
[2025-06-22 01:03:32,292] INFO authentication webauthn_authenticate_complete:789 - Previous sign count: 0
[2025-06-22 01:03:32,313] INFO authentication webauthn_authenticate_complete:795 - Credential updated - new sign count: 0
[2025-06-22 01:03:32,337] INFO authentication webauthn_authenticate_complete:800 - User new10 logged in successfully
[2025-06-22 01:03:32,377] INFO authentication webauthn_authenticate_complete:804 - JWT tokens generated successfully
[2025-06-22 01:03:32,377] INFO authentication webauthn_authenticate_complete:808 - Challenge c26e3a54-ddda-40be-ad33-b476c7fb2382 removed from memory
[2025-06-22 01:03:32,378] INFO authentication webauthn_authenticate_complete:809 - Remaining challenges: 0
[2025-06-22 01:03:32,386] INFO authentication webauthn_authenticate_complete:820 - === WebAuthn Authentication Complete Success ===
[2025-06-22 01:03:32,386] INFO authentication webauthn_authenticate_complete:821 - Response data: {'message': 'Authentication successful', 'user': {'id': 11, 'username': 'new10', 'email': 'new10@gmail.com', 'first_name': 'new', 'last_name': 'new', 'date_joined': '2025-06-20T18:59:04.441424Z'}, 'tokens': {'access': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzUwNTM4MDEyLCJpYXQiOjE3NTA1MzQ0MTIsImp0aSI6ImQxN2RkMWQxYzkxNzRkMmZiNTY5MjA5N2RmYTRjNmNjIiwidXNlcl9pZCI6MTF9.4FAlbZFMca2AQEVaLtu7GcVfjhKa6aCXhaxLH94peOc', 'refresh': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTc1MDYyMDgxMiwiaWF0IjoxNzUwNTM0NDEyLCJqdGkiOiJkMGEzYzQ5NjkxNDc0YzAyOTgyYjZhYWRiMmNkYzI0MCIsInVzZXJfaWQiOjExfQ.Ji7WUdPyR0Nn8ZPR_TsqTMIcyUkcqAAhBUSzCSjEiAM'}}
